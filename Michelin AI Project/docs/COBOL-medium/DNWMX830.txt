000100 IDENTIFICATION DIVISION.                                                 
000200                                                                          
000300 PROGRAM-ID.   DNWMX830.                                                  
000400 AUTHOR.       SUSAN ADAIR.                                               
000500 INSTALLATION. MICHELIN CORPORATION.                                      
000600 DATE-WRITTEN. MAR   1993.                                                
000700 DATE-COMPILED.                                                           
000900*                                                                         
001000*****************************************************************         
001100***                                                           ***         
001200***                 W I C S    R E C V                        ***         
001300***      S H I P M E N T     C O N F I R M A T I O N          ***         
001400***                                                           ***         
001500*****************************************************************         
001700*                                                               *         
001800*                WICS---------->SDS----------------->INVOICING  *         
001900*            +----------+  +-------------+         +---------+  *         
002000*            |CM602SS0  |  |  DNWMX830   |-------->|SABGP380 |  *         
002100*            |          |  |  DC COBOL   |EXTEND   | DC COBOL|  *         
002200*            |   ?      |  | RUN UNIT A  |RUN UNIT |         |  *         
002300*            +----------+  +-------------+  A      +---------+  *         
002400*                 |               |                             *         
002500*                \|/             \|/                            *         
002600*            +----------+  +-------------+                      *         
002700*            |????????  |  |  DNWXP261   |                      *         
002800*            |          |  |             |                      *         
002900*            +----------+  +-------------+                      *         
003000*                  |              /|\                           *         
003100*                  |   +------+    |                            *         
003200*                  +-->| WICS |----+                            *         
003300*                      | TRANS|                                 *         
003400*                      | DB   |                                 *         
003500*                      +------+                                 *         
003600*===============================================================*         
003700* THE MAJOR FUNCTIONS OF THIS PROGRAM ARE:                      *         
003800*   THIS PROGRAM RECEIVES DATA FROM DNWXP261 APPC MODULE WHEN A *         
003900*   SHIPMENT OCCURS ON WICS.                                    *         
004000*                                                               *         
004100* WICS TRANSACTION NAME: "TOSHIP" AND "SOSHIP"                  *         
004200* TRANSACTION SET TYPES:                                        *         
004300*   01 - 1 PER LOGICAL TRANSACTION SET/LOAD                     *         
004400*   02 - N DEPENDING ON THE # OF BOLS/CUSTOMERS ON THE LOAD     *         
004500*   03 - N DEPENDING ON THE # OF INVOICES ON THE LOAD           *         
004600*   04 - N DEPENDING ON THE # OF SHIPMENT-LINES ON THE LOAD     *         
004700*   99 - END OF LOGICAL TRANSACTION.                            *         
004800*                                                               *         
004900*                                                               *         
005000*    - POSSIBLE SEQUENCE EXAMPLES:                              *         
005100*                                                               *         
005200*     1) 1 CUSTOMER              01,02,03,04,04,04,04,99        *         
005300*        1 SALES ORDER                                          *         
005400*        4 PARTS                                                *         
005500*                                                               *         
005600*     2) 1 CUSTOMER              01,02,03,04,03,04,04,04,04,99  *         
005700*        2 SALES ORDER                                          *         
005800*        1 ORDER W/ 1 PART, 1 ORDER W/4 PARTS                   *         
005900*                                                               *         
006000*     3) 2 CUSTOMERS             01,02,03,04,04,02,03,04,04,99  *         
006100*        1 SALES ORDER PER CUST                                 *         
006200*        2 PARTS ON EACH ORDER                                  *         
006300*                                                               *         
006400*---------------------------------------------------------------*         
006500*    CYCLE OF RECORD RECEIVES:                                  *         
006600*       1 - WICSRECV INITIATES THIS PROGRAM FOR SHIPMENT CONFIR-*         
006700*           MATION TRANSACTION SET.                             *         
006800*                                                               *         
006900*       2 - THIS PROGRAM CALLS DNWXP261 TO GET A DETAIL RECORD. *         
007000*           DNWXP261 WILL PASS THE RECORDS IN SERIAL-SEQUENCE   *         
007100*           NUMBER ORDER.  THE TRANS TYPE WILL INDICATE THE     *         
007200*           TYPE OF RECORD (LOAD, BOL, SHIP-HDR OR PART).       *         
007300*           THE END OF A SHIPMENT CONFIRMATION TRANSACTION SET  *         
007400*           IS DETECTED WHEN WRB-END-OF DATA IS TRUE. A FINISH  *         
007500*           SHOULD BE DONE TO COMMIT THE DATABASE WORK THIS PGM *         
007600*           HAS DONE.                                           *         
007700*                                                               *         
007800*       3 - THIS PROGRAM TRIES TO PROCESS THE RECORD RECEIVED.  *         
007900*           THE RECORD TYPE IS DETERMINED AND PROCESSING        *         
008000*           ON THE CORE PROCEEDS BASED ON RECORD TYPE.  IF THE  *         
008100*           PROCESSING IS SUCCESSFUL FOR THE RECORD, REPEAT WITH*         
008200*           STEP 2 WITH THE NEXT RECORD.                        *         
008300*                                                               *         
008400*           IF AN ERROR IS ENCOUNTERED, THIS PROGRAM WILL       *         
008500*           1 - ROLLBACK ITS RUN UNIT                           *         
008600*           2 - POPULATE THE THREE DIGIT ERROR CODE AND 50 BYTE *         
008700*               TEXT IN THE WICSRECV-CONTROL RECORD             *         
008800*           3 - ISSUE A GOBACK.                                 *         
008900*           THE DNWXP261 PROGRAM WILL THEN QUIT PROCESSING THAT *         
009000*           PARTICULAR SERIAL NUMBER TRANSACTION SET AND WILL   *         
009100*           START A NEW TRANSACTION SET.  (REPEAT WITH STEP 1)  *         
009200*                                                               *         
009300*           A TRANSACTION WILL TRY TO PROCESS UP TO 3 TIMES.    *         
009400*           AFTER 3 TRIES AND STILL UNSUCCESSFUL, IT WILL QUIT  *         
009500*           TRYING TO PROCESS.  THIS TRANSACTION WILL BE        *         
009600*           REPORTED ON AT NIGHT IN THE AUDIT PROGRAM DNWMP816. *         
009700*           ONCE THE ERROR HAS BEEN RESOLVED, THE TRANSACTION   *         
009800*           CAN BE REQUEUED FOR RETRY USING A SPECIAL ONLINE    *         
009900*           FUNCTION.                                           *         
010000*****************************************************************         
010100 EJECT                                                                    
010200*****************************************************************         
010300* THE FOLLOWING UPDATES ARE PERFORMED IN THIS PROGRAM:          *         
010400*                                                               *         
010500*  > LOAD                                                       *         
010600*    - WICS DOES NOT HAVE A LOAD NUMBER; THEREFORE, IT WILL BE  *         
010700*      GENERATED BY THIS PROGRAM BEFORE STORING THE LOAD RECORD.*         
010800*    - DATA SUPPLIED FROM CM601TDA-HDR-DATA-01                  *         
010900*   ------------------ --------------------- ------------------ *         
011000*  > ROUTE-DETAILS                                              *         
011100*    - MAY NOT EXIST                                            *         
011200*    - DATA SUPPLIED FROM CM601TDA-HDR-DATA-01                  *         
011300*   ------------------ --------------------- ------------------ *         
011400*  > ROUTE                                                      *         
011500*    - MAY NOT EXIST                                            *         
011600*    - DATA SUPPLIED FROM CM601TDA-HDR-DATA-01                  *         
011700*   ------------------ --------------------- ------------------ *         
011800*  > MASTER-BOL                                                 *         
011900*    - MAY NOT EXIST                                            *         
012000*    - DATA SUPPLIED FROM CM601TDA-HDR-DATA-01                  *         
012100*   ------------------ --------------------- ------------------ *         
012200*  > BILL-OF-LADING                                             *         
012300*    - WICS AND WMS MUST HAVE RANGES THAT DO NOT COINCIDE WITH  *         
012400*      EACH OTHER SINCE BOTH SYSTEM'S BOLS ARE STORED IN THE    *         
012500*      SAME PLACE ON THE CORE.                                  *         
012600*    - ETA DATE FOR THIS RECORD MUST BE CALCULATED.             *         
012700*   ------------------ --------------------- ------------------ *         
012800*  > SHIPMENT-HEADER                                            *         
012900*    - DATA SUPPLIED FROM CM601TDA-BOL-DATA-02 AND              *         
013000*                         CM601TDA-SHIP-HDR-DATA-03             *         
013100*    - THE SHIPMENT NUMBER IN THIS RECORD REPRESENTS A SHIPMENT *         
013200*      OFF OF A SALES ORDER.  THE SET BETWEEN SALES-ORDER AND   *         
013300*      SHIPMENT-HEADER IS SORTED ON THIS NUMBER AND DUPS NOT    *         
013400*      ALLOWED.                                                 *         
013500*      THE SHIPMENT NUMBER IN THIS RECORD MUST BE CALCULATED AND*         
013600*      POPULATED ON THE CORE SINCE WMS AND WICS CAN SHIP OFF THE*         
013700*      SAME SALES ORDER.                                        *         
013800*      SUPPOSE THE SAME SALES ORDER IS DROPPED TO WMS AND TO    *         
013900*      WICS.  WMS CREATES A 001 SHIPMENT-HEADER. THE WICS       *         
014000*      PORTION COMES TO THE CORE FIRST THRU DNWMX830 WHICH      *         
014100*      CREATES AND STORES A 001 SHIPMENT-HEADER.  WHEN THE WMS  *         
014200*      PORTION COMES THRU, ITS 001 SHIPMENT HEADER MUST BE      *         
014300*      MODIFIED TO 002 SHIPMENT-HEADER TO ELIMINATE ABEND.      *         
014400*   ------------------ --------------------- ------------------ *         
014500*   ------------------ --------------------- ------------------ *         
014600*  > AR-INVOICE-HDR                                             *         
014700*    - DATA SUPPLIED FROM CM601TDA-SHIP-HDR-DATA-03             *         
014800*    - SOURCE-ID ON THIS RECORD IS POPULATED WITH THE SHIP-SITE *         
014900*      CODE WHEN A WICS SHIPMENT SO THAT INVOICING CAN          *         
015000*      DIFFERENTIATE BETWEEN A WICS INVOICE AND A WMS INVOICE   *         
015010*   ------------------ --------------------- ------------------ *         
015020*  > SHIP-TRACK-ID                                              *         
015030*    - DATA SUPPLIED FROM CM601TDA-PART-DATA-04                 *         
015100*   ------------------ --------------------- ------------------ *         
015200*  > SALES-ORDER, SO-LINE-SCHEDULE                              *         
015300*    - MODIFIED WITH SHIP QTYS, CANCEL QTYS, AND DATE           *         
015400*    - HOOK LOAD STRUCTURE UP WITH SDS ORDER                    *         
015500*    - DATA SUPPLIED FROM CM601TDA-SHIP-HDR-DATA-03             *         
015600*                         CM601TDA-PART-DATA-04                 *         
015700*   ------------------ --------------------- ------------------ *         
015800*  > SHIPMENT-LINE                                              *         
015900*    - DATA SUPPLIED FROM CM601TDA-SHIP-HDR-DATA-03             *         
016000*                         CM601TDA-PART-DATA-04                 *         
016100*   ------------------ --------------------- ------------------ *         
016200*  > "XBRDNOTIFY" TEXT RECORDS                                  *         
016300*    - STORED FOR OE TO PROCESS AGAINST WHEN IT BUILDS THE      *         
016400*      DEBIT ORDER FOR A CROSS BORDER SHIPMENT                  *         
016500*    - STORED FOR NAIT TO ALSO PROCESS AGAINST AND BUILD        *         
016600*      RESPECTIVE FILE.                                         *         
016700*    - NEED LOAD AND INVOICE NUMBER IN ORDER TO STORE           *         
016800*    IF A LOAD IS CANCELLED AFTER THE BOL PRINTED, THIS ENTRY   *         
016900*    MUST BE ERASED.                                            *         
017000*    NOTE: THE UGMT ENTRY AND THE XBRDNOTIFY ENTRY CANNOT       *         
017001*    EXIST TOGETHER - TO DO SO WOULD CAUSE DOUBLE INVOICING.    *         
017002*   ------------------ --------------------- ------------------ *         
017100*  > PFO-SHIP-OOAK / PFO-SHIP-TRAN                              *         
017200*    - A TRANSACTION BUILT FOR EVERY LINE ITEM/04 RECORD TYPE   *         
017300*      ON A TRANSFER-BORDER TRANSFER ORDER.                     *         
017400*    - DATA SUPPLIED FROM CM601TDA-HDR-DATA-01                  *         
017500*                         CM601TDA-BOL-DATA-02                  *         
017600*                         CM601TDA-SHIP-HDR-DATA-03             *         
017700*                         CM601TDA-PART-DATA-04                 *         
017800*    - INITIATE "PFOSHPMT" TASK                                 *         
017900*   ------------------ --------------------- ------------------ *         
018000*  > LS-INV-TRANS                                               *         
018100*    - A TRANSACTION BUILT FOR EVERY LINE ITEM/04 RECORD TYPE   *         
018200*    - DATA SUPPLIED FROM CM601TDA-HDR-DATA-01                  *         
018300*                         CM601TDA-BOL-DATA-02                  *         
018400*                         CM601TDA-SHIP-HDR-DATA-03             *         
018500*                         CM601TDA-PART-DATA-04                 *         
018600*   ------------------ --------------------- ------------------ *         
018700*  > TRIMSHIP TABLE HDR/DETAIL                                  *         
018700*  > CHANGE KEY TO 'TRIMSHP830'                                 *         
018800*    - A DETAIL LINE BUILT FOR EVERY LOAD PROCESSED THRU SYSTEM *         
018900*      SO THAT TRIMS CAN USE TO PRODUCE THEIR EXTRACT           *         
019000*    IF A LOAD IS CANCELLED AFTER THE BOL PRINTED, THIS ENTRY   *         
019100*    MUST BE ERASED.                                            *         
019200*   ------------------ --------------------- ------------------ *         
019300*  > "UGMT" TABLE-HDR/TABLE-DETAIL                              *         
019400*    STORE ONE ENTRY PER BOL WHERE UG FACILITY SHIPPING TO      *         
019500*    A MICHELIN FACILITY OR VICE VERSA                          *         
019600*                                                               *         
019700*    WHEN A TRANSFER SHIPMENT OCCURS ACCROSS COMPANIES,         *         
019800*    AN INVOICE IS NEEDED DUE TO LEGAL REQUIREMENTS DEALING     *         
019900*    WITH TWO SEPARATE COMPANIES.  A BATCH JOB RUNS AT NIGHT    *         
020000*    TO READ THIS TABLE TO PRODUCE DEBIT (INVOICE ONLY) ORDERS  *         
020100*    WHICH WILL CAUSE INVOICING TO OCCUR.  DNWMP188 WILL READ   *         
020200*    THESE TABLE RECORDS, PRODUCE THE FILE FOR OE, AND THEN     *         
020300*    DELETE THE ENTRY.                                          *         
020400*                                                               *         
020500*    IF A LOAD IS CANCELLED AFTER THE BOL PRINTED, THIS ENTRY   *         
020600*    MUST BE ERASED.                                            *         
020700*    NOTE: THE UGMT ENTRY AND THE XBRDNOTIFY ENTRY CANNOT       *         
020701*    EXIST TOGETHER - TO DO SO WOULD CAUSE DOUBLE INVOICING.    *         
020702*   ------------------ --------------------- ------------------ *         
020800*  > SUBMIT JCL TO THE INTERNAL READER IN ORDER TO SET UP       *         
020900*    INTRANSIT SHIPMENTS ON THE RECEIVING DATABASES.            *         
021000*   ------------------ --------------------- ------------------ *         
021100*  > IF DOMESTIC TRANSFER TO WICS, INITIATE WICSINBD QUEUE;     *         
021200*    CROSS BORDER TRANSFERS TO WICS ARE TAKEN CARE OF IN JCL    *         
021300*    SUBMISSION ABOVE.                                          *         
021400*   ------------------ --------------------- ------------------ *         
021500*  > "OAVI NOTIFY" TEXT                                         *         
021600*     STORED PER BOL FOR SHIPMENTS TO OVERSEAS AFFILIATES.      *         
021700*     THESE RECORDS WILL BE USED TO PRODUCE THE OUTBOUND AVIEXP *         
021800*     FILE FOR CLERMONT.  OVERSEAS AFFILIATE IS IDENTIFIED AS   *         
021900*     FOLLOWS:                                                  *         
022000*             CUSTOMER CATEGORY    = '30'  (N/A)                *         
022100*                      CHANNEL     = '01'  (EXPORT)             *         
022200*                      SUB-CHANNEL = '003' (AFFILIATE)          *         
022300*   ------------------ --------------------- ------------------ *         
022400*  > WICS-LOADS                                                 *         
022500*     STORED PER BOL FOR AUDITING PURPOSES SO THAT WMS KNOWS    *         
022600*     WHICH LOADS ON THE CORE FOR BOL(S) SENT UP FROM WICS      *         
022700*   ------------------ --------------------- ------------------ *         
022800*  > CARRIER                                                    *         
022900*    - A CARRIER CANNOT BE MODIFIED BY CPP IF A LOAD IS CURRENT-*         
023000*      LY ON THE SYSTEM FOR THAT CARRIER.  THIS PROGRAM SETS A  *         
023100*      FLAG ON THE CARRIER RECORD TO 'Y' IF SUCH A LOAD EXISTS. *         
023200*      WHEN ALL LOADS ARE PURGED THAT WERE USING THAT CARRIER,  *         
023300*      THE FLAG IS SET BACK TO 'N' BY THE PURGE PROGRAM.        *         
023400*   ------------------ --------------------- ------------------ *         
023500*  > CUSTOMER                                                   *         
023600*    - WHEN A CONSIGNMENT SHIPMENT OCCURS, THE AMOUNT OF EACH   *         
023700*      LINE (UNIT * PRICE) MUST BE ADDED TO THE BILL-TO'S       *         
023800*      CUSTOMER RECORD.                                         *         
023900*****************************************************************         
024000 EJECT                                                                    
      *----------------------------------------------------------------         
      *                         HISTORY LOG                                     
      *          TASK/                                                          
      *          RELEASE/                                                       
      *          SUMMIT #/                                                      
      *   DATE   TIVOLI #  PGMR  EXPLANATION                                    
      * -------  --------  ----  --------------------------------------         
025400* 23JUN93  38219     DPCL  COMMENT OUT PAPER WHSE PROCESSING              
025500*                          WHICH IS NOT VALID UNTIL JULY WHEN US          
025600*                          FACILITIES ON SDS.                             
025800* 25JUN93            DPCL  START US DC(S) RUNNING PARALLEL WITH           
025900*                          NYA.  UN COMMENT WMS-SHIP-TO ON                
026000*                          SUBMISSION OF JCL WICSXBRD SO THAT             
026100*                          SHIPMENTS TO US DC(S) FROM CANADA WILL         
      *                          GO THRU WICSINBD AND QUEUE UP UNTIL            
026200*                          THE 1ST OF JULY WHEN US DC IS                  
026300*                          OFFICIALLY ON WICS.                            
026500* 01JUL93            DPCL  SWITCH XLA FROM A WMS FACILITY TO A            
026600*                          WICS FACILITY.  ADD CODE NECESSARY TO          
026700*                          SUBMIT INTRANSIT JCL FOR SHIPMENTS             
026800*                          FROM XLA TO THE US.  TURN ON ALL 'US'          
026900*                          FACILITIES AS VALID IN SDS ARENA.              
027100* 01JUL93            DPCL  TURN ON PAPER WHSE PROCESSING NOW THAT         
027200*                          ALL OF N.A. ON SDS                             
027500* 09JUL93  39274     DPCL  DON'T TREAT CANADA SHIPMENTS TO MARC           
027600*                          (CHNL=01, SUBCHNL=029) A PAPER WHSE            
027700*                          SHIPMENT.  DON'T TREAT CU1 SHIPMENTS           
027800*                          TO THE US AS PAPER WHSE SHIPMENTS.             
028100* 14JUL93  41072     DPCL  USE PLANTNWK TO DETERMINE IF                   
028200*                          WMS-SHIP-TO                                    
028400* 25JUL93            DPCL  AN ADDITIONAL CRITERIA FOR PAPER WHSE          
028500*                          PROCESSING WAS ADDED.  IF THE US IS            
028600*                          SHIPPING TO CUSTOMER 1032671, THIS IS          
028700*                          CONSIDERED A DOMESTIC SALE-'4'.                
      *                          HOWEVER, THIS IS IN REALITY A CANADIAN         
028800*                          CUSTOMER WITH A US ADDRESS WHOSE               
028900*                          SHIPMENTS MUST BE INVOICED THRU MTCL           
      *                          CANADA.  FOR THIS REASON, AN AUTOMATIC         
029000*                          INTRANSIT TO C21 MUST BE SET UP WHEN           
029100*                          SHIPPING TO THIS CUSTOMER EVEN THOUGH          
029200*                          ITS ORDER TYPE IS DOMESTIC SALES.              
029220* 03AUG93            DPLD  IN SECTION 1146000-BACK-OUT-HDR,               
029230*                          WHICH PROCESSES A SHIPMENT-HEADER FOR          
029240*                          WHICH NO SHIPMENT-LINE WAS STORED,             
029250*                          CHANGE TO PROCESS DOMESTIC TRANSFERS           
      *                          CORRECTLY (THESE SHIPMENT HEADERS WILL         
029260*                          NOT HAVE AN ASSOCIATED INVOICE).               
029270*                          CHECK TO SEE IF THE SHIPMENT-HEADER            
      *                          IS A MEMBER OF INVHDR-SHIP SET BEFORE          
029280*                          TRYING TO DISCONNECT FROM THAT SET AND         
029290*                          ERASE THE AR-INVOICE-HDR.                      
029292* 17AAUG93           DPCL  WICS STARTED SENDING UP A BLANK INVOICE        
029293*                          IF THE INVOICE WAS 0 SHIPPED (THIS             
029294*                          APPLIES TO SALES ORDERS AS WELL AS             
029295*                          TRANSFER ORDERS).  THEREFORE, NO               
      *                          INVOICE IS EVER STORED FOR A ZERO              
029296*                          SHIPPED INVOICE.  CODE IN 1146000              
029297*                          SHOULD NEVER GET EXECUTED; THE SHIPMENT        
      *                          HEADER WILL NOT BE A MEMBER OF THE SET         
029298*                          INVHDR-SHIP.                                   
029300* 19AUG93            DPCL  IF A CROSS BORDER SHIPMENT AND A CROSS         
029301*                          AFFILIATE SHIPMENT (I.E. C48 --> UUR)          
029302*                          ONLY PUT OUT THE "XBRDNOTIFY" AND SKIP         
029303*                          THE "UGMT" DUE TO THIS CAUSING DOUBLE          
029304*                          INVOICING.                                     
029306* 25AUG93            DPCL  IF A CROSS BORDER TO AND ONE INVOICE           
029307*                          WITH TWO SHIPMENT HEADERS, SUSPEND             
029308*                          INSTEAD OF LETTING THE INVOICE GET             
029309*                          STORED WITH MORE THAN ONE SHIPMENT-            
      *                          HEADER.  THIS CAUSES PARTIAL                   
029310*                          INVOICING TO OCCUR.                            
029312* 01SEP93            DPCL  WICS MADE A CHANGE CONCERNING THE              
029313*                          PRIOR PROBLEM OF 2 SHIPMENT HEADERS            
029314*                          FOR ONE INVOICE.  THEY ARE NOW GOING TO        
029315*                          SEND UP ONE INVOICE "03 REC" AND               
029316*                          MULTIPLE "04" RECS WHICH NOW CONTAINS          
      *                          THE "TO" NUMBER.  EACH "04" MAY HAVE A         
029317*                          DIFFERENT "TO" NUMBER IF WICS GROUPS           
029318*                          MULT TO(S) UNDER ONE INVOICE.                  
029319*                                                                         
029320*                          THE SALES ORDER NUMBERS STILL COME UP          
      *                          ON THE "03" REC.  SALES ORDER MUST COME        
029321*                          UP 1 PER INVOICE - CAN'T HAVE MULTIPLES        
029322*                          LIKE TO(S).                                    
029323*                                                                         
029324*                          THIS CHANGE ALLOWS WICS TO GENERATE 1          
029325*                          INVOICE AND GROUP MULTIPLE TO(S) UNDER         
029326*                          IT AND AT THE SAME TIME MAKE SURE THAT         
029327*                          THE ONE TO ONE RELATIONSHIP ON THE CORE        
029328*                          OF INVOICE TO SHIPMENT-HEADER REMAINS.         
029330* 28OCT93            DPLD  STORE NEW DATABASE RECORD (WICS-LOADS)         
029332*                          INSTEAD OF STORING TABLE-DETAIL RECORDS        
029333*                          UNDER THE "WICSLOADS" TABLE-HDR.               
029335* 10DEC93  SDUUWM-D-014  DPLN  LEGAL ENTITY CHANGES FOR                   
029336*                          01/01/94 - CU1                                 
029337*                          1. BLOCK UGMT TABLE UPDATE FOR CU1             
      *                             SHIPMENTS                                   
029338*                          2. SUBMIT JCL TO THE INTERNAL READER TO        
      *                             SETUP INTRANSIT TO CU1 FROM WICS            
029339*                             FACILITY.                                   
029341* 05JAN94  53571     DPLN  CONTINUE TO EXCLUDE FACILITY SHIPPING          
029342*                          TO A U.S. UG FACILITY FROM SUBMITTING          
029343*                          JCL FOR TRANSFER SHIPMENTS BECAUSE UG          
029344*                          U.S. IS NOT ON SDS.  THIS CODE WILL            
      *                          NEED TO BE REMOVED FOR JULY 1994 UG            
029345*                          IMPLEMENTAION.                                 
029347* 11APR94  SDMUWM-D-029  DPLN  CONICITY MODIFICATIONS                     
029350* 09JAY94  61213     DPLD  REMOVE MISPLACED PERIOD FROM WITHIN            
029351*                          IF STATEMENT                                   
029353* 11JUN94  C00257    CGGT  CALL ROUTINE TO GET DEFAULT SHIP               
029354*                          PLANT FOR CUSTOMER IF SHIPPING FROM            
029355*                          U.S.                                           
029357* 13JUN94  C00257    CGGT  BIND BUSINESS ADDRSS ADDRSS-ID AFTER           
029358*                          CALLING SAORP019                               
029360* 01JUL94  C00574    CGGT  REMOVE BLOCK OF INBOUND RECEIPT LOGIC          
029361*                          IF SHIPPING TO A 'UU' FACILITY                 
029364* 21JUL94            DPLN  DON'T TREAT UG EXPORT SHIPMENTS                
029365*                          (CATEG=30, CHNL=16, SUB-CHNL=004)              
029366*                          AS A PAPER WHSE.                               
029368* 08SEP94  69750     DPLD  WHEN OBTAINING THE LOAD NUMBER FROM            
029369*                          THE NUMBER-MASK, TRY UP TO 100                 
029370*                          SEQUENTIAL NUMBERS, LOOKING FOR A LOAD         
029371*                          NUMBER NOT ALREADY ON THE DATABASE.            
029372* 13SEP94  69750     DPLD  CLARIFYING COMMENTS FOR CHANGE MADE            
029373*                          ON 08SEP94.  DUE TO EMERGENCY NATURE OF        
029374*                          THAT CHANGE, THE COMMENTS WERE KIND OF         
029375*                          SKETCHY.                                       
029377* 13SEP94  68810     DPLN  ADD WRITE TO LOG STATEMENTS TO MONITOR         
029378*                          INTERNAL READER                                
029380* 08OCT94  70878     DPLD  ADD SOLEXT RECORD TO SABGP380 CALL             
029381*                          (REQUIRED FOR A CHANGE IN INVOICING'S          
029382*                          PROCESSING).                                   
029384* 05NOV94  C00918    DPLD  STORE BORDER EXIT POINT PASSED FROM            
029385*                          WICS ON SHIPMENT-HEADER                        
029391* 05NOV94  C00999    DPWE  CREATE PAPER WHSE FOR UGTC EXPORT IF           
029392*                          MTC IS THE BILL-TO  (TAGGED WE94005)           
029395*    MAR95  C01116   CGRS  REPLACE TRANSFER-REQUEST-NUMBER-8376           
029397*                          WITH BATCH-NBR-8376.  (TAGGED C01116)          
029399* 08APR95   C01067   DPLD  ACCEPT IMPORT FILE NUMBER FROM WICS.           
029400*                          STORE IMPORT FILE NBR ON 'WMS IF               
029401*                          (SHIPPERS-BOL-NBR)' TEXT FOR USE BY            
029402*                          DNWMP243.  ALSO STORE IMPORT FILE NBR          
029403*                          ON 'XBRDNOTIFY' TEXT FOR USE BY ORDER          
029403*                          ENTRY.  (TAGGED 000026LD)                      
029408*      95            DPLM  SUBMIT NEW XBRD JCL FOR SHIPMENTS TO           
029409*                          CUSTOMER 1032671 (IMPORT FILE NOT              
029410*                          REQUIRED).  ALLOW 8-BYTE PRINT                 
029411*                          DESTINATION FOR ADD PENDING DOCUMENT.          
029412*                          (TAGGED 000027LM)                              
029414* 10MAY95  C01324    DPLD  CHANGE WICS PROGRAM 'WICSRECV' NAME TO         
029415*                          'DNWXP261'.  (TAGGED 000028LM)                 
029417* 10JUN95  P88386    DPLD  READY MICH-RISIX-AREA  (TAG 000029LM)          
029420* 15JUL95  C01733    DPLD  STORE CARRIER TRACK ID ON NEW                  
029422*            &             SHIP-TRACK-ID RECORD.                          
029423*          C01731          STORE LOAD SEQUENCE NUMBER ON                  
029424*            &             BILL-OF-LADING RECORD (DATA IS NOT             
029425*                          BEING PASSED FROM WICS IN THE FIELD AT         
029426*                          TIME.  WHEN WICS BEGINS PASSING DATA,          
      *                          THIS PROGRAM WILL STORE THE DATA WITH          
029427*                          NO CHANGE REQUIRED).                           
029428*          P88816          SUBMIT 'JCL WMSXBRD' FOR SHIPMENTS TO          
029429*                          CUST 1032671 (IMPORT FILE IS REQUIRED)         
029430*                          (ALL TAGGED 000030LM)                          
029432* 20NOV95  C02119    DPLD  STORE 'OAVI' 'NOTIFY' TEXT IF CUSTOMER         
029433*                          IS FOUND IN "WMSAVIEXP" TABLE.  OLD            
029434*                          CODE STORED TEXT IF CUSTOMER WAS AN            
029435*                          EXPORT AFFILIATE (BASED ON CUSTOMER            
029436*                          CLASSIFICATION).  (TAGGED 000031LM)            
029438* 09DEC95  P84943    DPLD  ADD NEW RECORD AOBGW380 TO SABGP380            
029439*                          TRANSFER STATEMENT.  FOR NOW, THE              
029440*                          RECORD WILL BE USED TO PASS A STATUS           
      *                          CODE BACK FROM INVOICING, INDICATING           
029441*                          ONE OF 3 CONDITIONS:                           
029442*                            00 - NO ERROR                                
029443*                            01 - AVP STATE CODE NOT FOUND                
029444*                            02 - NEGATIVE INVOICE AMOUNT                 
      *                          (TAGGED 000032LM)                              
029446* 13JAN96  C02182    CGDB  PROCESS CROSS-BORDER TRANSFER SHIPMENTS        
029448*                          TO MEXICO CORRECTLY:                           
      *                            (1) DO NOT SUBMIT 'SDP2INTR' JCL             
029449*                            (2) PASS INVOICE NUMBER TO LOGICAL           
      *                                STOCK                                    
      *                          (TAGGED 000033DB                               
029451* 13JAN96  C02176    CGDB  ADD SEARS MH10 CODE TO BILL-OF-LADING          
029452*                          (TAGGED 000034DB)                              
029454* 13APR96  C02238    CGDB  MOVE WSC-PRIORITY TO PRIO-CODE-3516.           
029455*            &                                                            
029456*          C00003    CGDB  READY 2 MORE AREAS AND ADD RECORD              
029457*                          STBDNAR FOR THE TRANSFER TO SABGP380           
029458*                          (BOTH TAGGED 000035DB)                         
029460* 04MAY96  C02438    DPLD  DUE TO THE WICS BOL NUMBER GENERATOR           
029462*                          ROLLING OVER AND A FEW BOL'S REMAINING         
029463*                          ON THE DATABASE FOR 2-3 YEARS, PGM             
029464*                          SOMETIMES GETS A '1205' STORING A              
      *                          BILL-OF-LADING.  CHANGE TO HANDLE AS           
029465*                          FOLLOWS:  CHECK THE ACTUAL SHIP DATE ON        
029466*                          THE LOAD.  IF IT WAS MORE THAT ONE YEAR        
      *                          AGO, APPEND "OLD" TO THE END OF THE OLD        
029467*                          RECORD'S BOL NBR AND MODIFY THE RECORD.        
029468*                          THIS WILL ALLOW THE NEW BOL RECORD TO          
029469*                          BE STORED.  (TAGGED 000036LM)                  
029471* 13AUG96  C02703    DPLN  IF XBRD TRANSFER, CONVERT FREIGHT              
029472*                          AMOUNT USING EXCHANGE RATE IN CURRENCY         
029473*                          TABLE  (TAGGED C02703)                         
029475* 03SEP96  P12763    DPLN  IF XBRD TRANSFER, CONVERT FREIGHT              
029476*                          AMOUNT USING EXCHANGE RATE IN CURRENCY         
029477*                          TABLE FOR SHIPMENTS FROM THE U.S. ONLY         
029479* 09NOV96  C02855    CGLE  ADD WSC-LOAD-TEND-IND TO LOAD RECORD           
029480*                          BEFORE STORING THE NEW RECORD.  ADD            
029482*                          WSC-BOL-COMMODITY-CODE TO BOL-                 
      *                          COMMODITY-CODE-3516 BEFORE STORING             
029483*                          SHIPMENT-LINE RECORD.  STORE AN ENTRY          
029484*                          IN WICSEBOL TABLE IF LOAD-TEND-IND =           
029485*                          'Y'.  ALSO, STORE A TABLE-HDR IF THE           
      *                          WICSEBOL RECORD DID NOT EXIST.                 
029486*                          (TAGGED C02855)                                
029488* 11NOV96  P15598    DPLD  REMOVE MISPLACED "." WITHIN AN "IF"            
029489*                          STATEMENT IN 1140000-PROCESS-LINE.             
029488* 14DEC96  C03058    DPLN  REMOVE C02703 FROM 8/13/96 ABOVE.  IF          
029489*                          XBRD TRANSFER, CONVERT FREIGHT AMOUNT          
029490*                          IN WICS SO THAT XBRD DOCUMENT WILL HAVE        
029490*                          THE CORRECT FREIGHT AMOUNT.                    
      *                          (TAGGED C03058)                                
029488* 14DEC96  C03012    DPRD  WICS HAS ADDED REASON CODE FOR                 
029489*                          CANCELLED ORDER REPORT.  STORE ON THE          
029489*                          LINE-SCHEDULE  (TAGGED C03012)                 
029488* 09JAN97  P14996    DPRD  USE ADDR ID FROM SALES ORDER WHEN              
029489*                          CALLING SAORP018  (TAGGED P14996)              
029490* 17JAN97  C03041    CGCH  TRACK MOVEMENT OF SHIPMENTS THRU WMS           
029491*                          (TAGGED C03041)                                
029490* 24APR97  C03407    DPRD  REVERSE-PO LOGIC  (TAGGED C03407)              
      *   DEC97            IMR   CHANGE FOR YEAR 2000                           
      *                           PROCEDURE DIVISION                            
      *                            IMR1                                         
      *                            PARAGRAPH:                                   
      *                              1136000-CALCULATE-ETA-DATE                 
      *                            VARIABLES:                                   
      *                              SAVE-JULIAN-DATE (CONTAINS                 
      *                              DATE FIELD 'SAVE-JUL-YY')                  
029490* 25JUN98  P37698    DPRD  REPLACE CRAP IMR ETA DATE LOGIC                
029491*                          (TAGGED P37698)                                
029600* 24SEP98  3TR020    IMR   MOVE NEW FIELD EQUIPMENT-TYPE TO               
029600*                          LOAD RECORD AND STORE NEW RECORD               
029600*                          FREEFORM-ITEMS IN CASDML.                      
029600*                          (TAGGED IM980924)                              
      * 09MAR99  2IV060    IMR   STORE PART-SERIAL-NUM                          
      *                          (TAGGED IM990524)                              
      * 24MAY99  3TR020    IMR   MOVE NEW FIELD PORT OF DEPARTURE TO            
      *                          LOAD AND MOVE NEW FIELD PICKUP REC             
      *                          NBR TO SHIP-TRACK-ID RECORD IN CASDML          
      *                          (TAGGED IM990524)                              
      * 29OCT99  2DT010    IMR   ACCOMMODATE 4 DIGIT DOTWEEK FIELD      IM991029
      *                          (TAGGED IM991029)                              
      * 31DEC99  58683     IMR   IN 1136000-CALCULATE-ETA-DATE                  
      *                            IF SAVE-JUL-99 < '93'                        
      *                              MOVE '20' TO SAVE-ETA-CC                   
      *                            ELSE                                         
      *                              MOVE '19' TO SAVE-ETA-CC                   
      *                          (TAGGED IM991229)                              
      * 31MAR00  2XM842    IMR   STORE DISCOUNT-CODE-3503 FROM CL92             
      *                          TEXT HEADER RECORD  (TAGGED IM000331)          
      * 10AUG00  215224    IMR   AVIEXP IS TO BE SENT FOR ALL EXPORT            
      *                          CUSTOMERS IRRESPECTIVE OF THE CUSTOMERS        
      *                          PRESENT IN WMSAVIEXP TABLE.  THIS HAD TO       
      *                          BE DONE AS PART OF SP090 RELEASE AS THIS       
      *                          CHECKING WILL NOW BE DONE ON THE LOGICAL       
      *                          STOCK SIDE.  (TAGGED IM000810)                 
      * 21AUG00  215224    DPLP  FORMAT HISTORY LOG                             
      * 11SEP00  220979    IMR   AVIEXP IS TO BE SENT FOR ALL EXPORT            
      *                          CUSTOMERS IRRESPECTIVE OF THE CUSTOMERS        
      *                          PRESENT IN WMSAVIEXP TABLE.  THIS HAD TO       
      *                          BE DONE AS PART OF SP090 RELEASE AS THIS       
      *                          CHECKING WILL NOW BE DONE ON THE LOGICAL       
      *                          STOCK SIDE. THE CONDITION IS CHECKED AT THE    
      *                          SHP-HEADER.  (TAGGED IM000911)                 
      * 05DEC00  2WM860    IMR   UPDATE THE SO-LINE-SCHEDULE RECORD WITH        
      *                          DATE & TIME WHEN A SALES ORDER LINE WAS        
      *                          DROPPED INTO WICS.  (TAGGED IM001205)          
      * 11DEC00  2WM860    IMR   MOVE ZERO TO PART OF THE TIME PASSED TO        
      *                          SO-LINE-SCHEDULE.  (TAGGED IM001211)           
      *                          ALSO, DELETE COMMENTED-OUT CODE.               
      * 12FEB01  2SP160    IMR   INITIATE A NEW INTERNAL JCL WHENEVER           
      *                          THE SALES ORDER BEING SHIPPED OUT FROM         
      *                          WMS OR WICS IS A CROSS BORDER SHIPMENT         
      *                          (TAGGED IM010212)                              
      * 03JUL01  3LO030    IMR   FOR TMS SHIPMENTS POPULATE                     
      *                          TMS-SHPCAN-HDR/LINE; UPDATE                    
      *                          TRANS-CONS-IND-3504 TO 'R' IF REBILL           
      *                          OCCURS IN DC.                                  
      * 01OCT01  344819    CGI   SEND THE IMPORT FILE NUMBER AS AN              
      *                          INPUT PARAMETER IN THE JCL FOR NEW             
      *                          TYPE OF CROSS BORDER SHIPMENTS                 
      *                          (TAGGED IM011001)                              
      * 03OCT01  344819    DPLP  FORMAT HISTORY LOG                             
      * 11JAN02  2SP500    CGI   PROPERLY DETECT THAT A SHIPMENT IS             
      *                          GOING TO CANADA  (TAGGED CG020111)             
      * 05MAR02  368920    CGI   IF RECV-SHIP-RLSE-DATE = BLANK OR 0'S,         
      *                          SET IT TO THE SYSTEM DATE                      
      *                          (TAGGED CG020305)                              
      * 08MAR02  383124    CGI   PREVENT THE INVOICES FOR TRANSFER              
      *                          ORDERS BEING PREFIXED AS 'XB'                  
      *                          (TAGGED CG020308)                              
      * 20FEB02  2WM310    CGI   TAKE CARE OF BILL-TO COUNTRY WHILE             
      *                          POPULATING INTRANSIT JCL FOR OAKLEY            
      *                          CUSTOMERS.  THIS WILL BE REQUIRED IN           
      *                          ALL CASES WHERE THE SHIP-TO COUNTRY IS         
      *                          SAME AS SHIP-FROM COUNTRY FOR CROSS            
      *                          BORDER SHIPMENTS.  (TAGGED CG020220)           
      * 26MAR02  430008    CGI   INCLUDE COUNTRY-CODE-5004 = '400' FOR          
      *                          U.S.                                           
      * 16APR02  2SP430    CGI   RECEIVE OCEAN FREIGHT CHARGES FROM             
      *                          PROGRAM DNWXP261 AND INVOKE INTERNAL           
      *                          JCL FOR MEXICAN SHIPMENTS.                     
      *                          (TAGGED IM011023)                              
      * 16APR02  2SP430    DPLP  CHANGE ACCEPT TO MOVE FUNCTION FOR             
      *                          TIME                                           
      * 18APR02  2SP430    CGI   INITIALIZE MEXICAN-XBRD-FLAG. THIS WILL        
      *                          ENSURE THAT THE FLAG IS SWITCHED OFF           
      *                          FOR NON-MEXICAN SHIPMENTS IN THE EVENT         
      *                          OF TRANSACTIONS GETTING CLOGGED DUE TO         
      *                          DNWMX800/820 ROLLBACK.                         
      *                          (TAGGED CG020418)                              
      * 20APR02  2SP430    CGI   DON'T MOVE 'M' TO SAVE-SHIP-TO FOR             
      *                          MEXICAN SHIPMENTS WHILE INITIATING THE         
      *                          MEXICAN JCL.  THIS HELPS POPULATE THE          
      *                          CORRECT PLANT-CODE IN LS-INV-TRANS             
      *                          RECORD FOR MEXICAN TRANSFER ORDERS.            
      *                          (TAGGED CG020420)                              
      * 09MAY02  2SP430    CGI   INCLUDE COUNTRY-CODE-5004(1) = 412 FOR         
      *                          MEXICAN SHIPMENTS  (TAGGED CG020509)           
      * 14MAY02  2WM923    CGI   COMMENT OUT THE READYING OF THE AREA           
      *                          MICH-IXCSPO-AREA  (TAGGED CG020514)            
      * 21MAY02  3LO030    CGI   FOR TMS SHIPMENTS POPULATE TMS-FLAG IN         
      *                          SHIPMENT-LINE. THIS WILL BE PASSED TO          
      *                          LOGISTIC DATAMART.                             
      * 14MAY02  2SP350    CGI   CHANGE FOR 'MRTI' SHIPMENTS                    
      *                          (TAGGED CG020514)                              
      * 12AUG02  479722    CGI   PUT FIND CURRENT SHIPMENT-HEADER               
      *                          PRIOR TO CONNECT TO INVHDR-SHIP;               
      *                          ADD AN END-IF WITHOUT A PERIOD                 
      * 13AUG02  479288    CGI   DO NOT POPULATE MRT SHIPMENTS ON               
      *                          TRIMSHIP TO TAKE CARE THAT 'MRT' LOADS         
      *                          ARE NOT EXTRACTED AND SENT TO                  
      *                          METAFREIGHT  (TAGGED CG020813)                 
      * 01OCT02  2SP350    CGI   CHECK ONLY FIRST 3 BYTES OF PLANT              
      *                          DESCRIPTION FOR MRT                            
      * 13DEC02  S513091   CGI   DISABLE MEXICAN CROSS BORDER INVOICE           
      *                          PRINTNING FOR MRTI SHIPMENTS.                  
      *                          (TAGGED CG021213).                             
      * 11DEC02  2SP620    CGI   GENERATE IMPORT FILE NUMBER AND                
      *                          INITIATE INTERNAL JCL FOR NORTH                
      *                          AMERICAN CROSS BORDER SHIPMENTS FROM           
      *                          PLANTS PRESENT IN THE CONTROL TABLE.           
      *                          (TAGGED CG021211)                              
      * 14JAN03  533671    CGI   MAKE NAXBRDPLNT TABLE SETUP MANDATORY          
      *                          FOR THE NORTH AMERICAN SHIPMENTS IF            
      *                          IMPORT FILE NUMBER IS NOT PASSED               
      *                          (TAGGED CG030114)                              
      * 30JAN03  541352    CGI   EXPAND WS-SHIP-TO TO X(2) SO THAT IT           
      *                          DOES NOT TAKE THE WRONG SHIP-TO'S; IT          
      *                          WAS TAKING CANADA AND CHILE AS THE             
      *                          SAME ONE  (TAGGED CG030130)                    
      * 03FEB03  542576    CGI   INITIATE THE XB DOC FOR ALL US-CA AND          
      *                          CA-US SHIPMENTS, EVEN IF IT IS UG-             
      *                          EXPORTS OR MARC-EXP  (TAGGED CG030203)         
      * 12MAR03  544055    CGI   DO NOT INITIATE XB DOC FOR CA-US AND           
      *                          US-CA MRTI SHIPMENTS  (TAGGED CG030312)        
      * 11FEB03  3LO041    CGI   CALL A NEW CURRENCY CONVERSION PGM FOR         
      *                          FOR PKMS SITES; POPULATE THE ENDING            
      *                          BALANCE AND SEQ NUMBERS TO LS                  
      *                          (TAGGED CG030211)                              
      * 03JUN03  593537    CGI   MOVE WSC-PRIMARY-CARRIER, NOT WSC-SCAC,        
      *                          TO SCAC-CODE-9038 SO IT WILL BE VALID          
      *                          ON TRANSFER ORDERS                             
      * 18JUN03  593537    CGI   PREVENT MRT SHIPMENTS FROM US/CA TO MX         
      *                          FROM KICKING OFF MRTIDOM JOBS                  
      *                          (TAGGED CG030618)                              
      * 17JUL03  2XM014    CGI   UPDATE LAST ACTIVITY DATE AND TIME ON          
      *                          SALES-ORDER-LINE REC  (TAGGED CG030717)        
      * 30JUL03  581334    CGI   GENERATE CROSS BORDER DOCUMENT IF A            
      *                          SHIPMENT IS MADE TO 'MX' THROUGH A             
      *                          BROKER  (TAGGED CG030730)                      
      * 15JUL03  2XM035    CGI   RECEIVE BOL SUFFIX AND STORE IN                
      *                          SHIPMENT-HEADER  (TAGGED CG030715)             
      * 13OCT03  2XM006    CGI   UPDATE SHIPMENT CONFIRMATION VAS INFOR-        
      *                          MATION TO CORRESPONDING VAS RECORDS            
      *                          FOR SO-LINE-SCHEDULE  (TAGGED CG031013)        
      * 27OCT03  3LO071    CGI   TRIGGER INTERNAL JCL TO EXECUTE THE            
      *                          PROGRAM TO CREATE EXTRACT FILE WHICH           
      *                          CONTAINS SHIPMENT INFORMATION FOR THE          
      *                          LOAD PASSED  (TAGGED CG031027)                 
      *                          THIS CHANGE IS COMMENTED-OUT UNTIL             
      *                          APRIL, 2004.                                   
      * 17DEC03  2XM047    CGI   ADD TABLE-HDR & TABLE-DETAIL RECORDS           
      *                          BEFORE CALLING SABGP380.                       
      *                          (TAGGED CG031217)                              
      * 30MAR04  705458    CGI   ROLLBACK TO EAIWP IF INVOICE NUMBER            
      *                          ISN'T PASSED BY WICS FOR CROSS BORDER          
      *                          TRANSFER ORDER SHIPMENT                        
      *                          (TAGGED CG040330)                              
      * 20APR04  712878    CGI   IN 1140500-EXPAND-DOTWEEK CHECK                
      *                          WK-DOT-YEAR CHECK FOR EQUAL AS WELL AS         
      *                          LESS THAN  (TAGGED CG040420)                   
      * 01NOV04  775905    CGI   IN 1133100-PROCESS-TEXT CHECK FOR              
      *                          WS-US-SHIP-TO AND WS-CAN-SHIP-TO               
      *                          INSTEAD OF US-SHIP-TO AND CAN-SHIP-TO          
      *                          (TAGGED CG041101)                              
      * 03NOV04  2TF340    CGI   REMOVE THE CODE NOT TO ERASE THE 'MRT'         
      *                          PLANT LOADS FROM TRIMSHP830 TABLE              
      * 18NOV04  780033    CGI   IN 1133100-PROCESS-TEXT CHANGE THE             
      *                          CHARACTER '@' TO '^' TO PREVENT THE            
      *                          CHARACTERS '@@@@@@@@' BEING WRONGLY            
      *                          REPLACED  (TAGGED CG041118)                    
      * 14DEC04  794731    CGI   DON'T SUBMIT SDP2NXB2 MULTIPLE TIMES           
      *                          WHEN A SHIPMENT HAS > 1 INVOICE                
      *                          (TAGGED CG041214)                              
      * 05JAN05  771525    CGI   MAKE ORDER-TYPE '3' (NOT 'C') WHEN IT          
      *                          IS EXPORT-SALES AND UG-EXPORT ORDER            
      * 29JAN05  812059    CGI   CORRECT DOTWEEK CONVERSION LOGIC IN            
      *                          1140500-EXPAND-DOTWEEK.  DUE TO THIS,          
      *                          CHANGES FOR TICKET 712878 ARE REMOVED.         
      *                          (TAGGED CG050129)                              
      * 31JAN05  810275    CGI   REINITIALIZE THE NEW CROSS-BORDER              
      *                          SHIPMENT FLAG FOR EVERY NEW                    
      *                          BILL-OF-LADING RECORD.                         
      *                          (TAGGED CG050131)                              
      * 19JAN05  2XM174    CGI   PASS PRICING RECORDS TO SABGP380               
      *                          (TAGGED CG050119)                              
      * 01FEB07  2NX120    CGI   CALCULATE THE PSD, CDD, AND IRD USING          
      *                            THE NEW DATE RULES;                          
      *                          STORE SCHEDULED FLAG IN BOL RECORD;            
      *                          SEND PSD AND CDD TO LOGICAL STOCK;             
      *                          STORE ORIGINAL PSD AND AL FLAG IN              
      *                            SHIPMENT-LINE RECORD                         
      *                          (TAGGED CG070201)                              
      * 03APR07  2NX120    CGI   ABEND IF ETA TABLE NOT FOUND                   
      *                          (TAGGED CG070403)                              
      * 05APR07  2NX120    CGI   CHANGE FOR IRD AND PSD                         
      *                          (TAGGED CG070405)                              
      * 13APR07  2NX120    CGI   MORE DATE CHANGES  (TAGGED CG070413)           
      * 19APR07  M7630213  CGI   MODIFIED CODE TO POPULATE THE SHIP-DATE        
      *                          TO PLAND-SHIP-DATE-8009.                       
      *                          (TAGGED CG070419)                              
      * 02JUL07  2NX120    CGI   AVOID POPULATING DATE AS 999999 IF             
      *          PHASE4          RDILEADTM AND WHSEETA TABLE NOT FOUND;         
      *                          INSTEAD, GET TRANSIT DAYS FROM NEW             
      *                          TABLE 'MODE'.  ALSO, STORE TO ANOTHER          
      *                          NEW TABLE 'ETANTFND' IF DATE OBTAINED          
      *                          USING 'MODE' TABLE.  (TAGGED CG070702)         
      * 21DEC07  3SP310    CGI   TRIGGER INTERNAL READER JOB FOR                
      *                          SHIPMENT FROM OLIVER  (TAGGED CG071221)        
      * 24NOV08  3SP150    CGI   PROGRAM CHANGED TO HANDLE GEODE CROSS  CG081124
      *                          BORDER DOCUMENT PRINTS                 CG081124
      *                          (TAGGED CG081124)                      CG081124
      * 09FEB09  18424677  CGI   TO HANDLE THE MEXICAN CROSS DOC        CG090209
      *                          (TAGGED CG090209)                      CG090209
      * 06JAN10  6DW070    CGI   TO ELIMINATE WMS AFFILIATE INVOICE     CG100106
      *                          PRINT IF THE SHIPMENT ORIGINATION DC ISCG100106
      *                          PRESENT EXCLUDINV TABLE                CG100106
      * 19FEB10  6IV180    CGI   HARD CODE FREIGHT CHARGE FLAG AS 'A'   CG100219
      *                          FOR SOLOMON SHIPMENTS INCASE OF        CG100219
      *                          ITS CARRYING A FREIGHT AMOUNT.         CG100219
      *                          (TAGGED CG100219)                      CG100219
      * 03JUN10  6DW160    CGI   MODIFIED CODE TO GENERATE 3 COPIES OF  CG100623
      *                          XBRD (CROSS BORDER) INVOICE DOCUMENT   CG100623
      *                          FOR GEODE SHIPMENTS                    CG100623
      *                          (TAGGED CG100623)                      CG100623
      * 30NOV10  28009782  CGI   CODE MODIFIED TO TRIGGER WMSDOM JCL    CG101130
      *                          FOR GEODE SHIPMENTS ALSO. CHANGES ARE  CG101130
      *                          MADE AS A PART OF TICKET #28009782 AND CG101130
      *                          TAGGED AS CG101130.                    CG101130
      * 04JUL11  30475539  CGI   CODE MODIFIED TO TRIGGER WMSDOM JCL    CG110704
      *                          FOR GEODE SHIPMENTS ALSO. CHANGES ARE  CG110704
      *                          MADE AS A PART OF TICKET #30475539 AND CG110704
      *                          TAGGED AS CG110704.                    CG110704
      * 07OCT15  OPE STEP2 CGI   CODE MODIFIED TO REFER THE BOLRANGE    CG151007
      *                          TABLE WITH A NEW ENTRY CODE FOR LOADS  CG151007
      *                          ORIGINATING OUT OF TRW. CHANGES ARE    CG151007
      *                          MADE AS PART OF OPE_AVAL-7718. ALSO,   CG151007
      *                          CHANGES ARE MADE TO STORE AND SEND THE CG151007
      *                          ACTUAL SHIP DATE AND SRD TO LS THAT WASCG151007
      *                          RECEIVED IN THE CONFIRMED DEPARTURE    CG151007
      *                          MESSAGE FROM TRW - OPE_AVAL-6700       CG151007
      *                          TAGGED AS CG151007.                    CG151007
      *  03/25/16        CGI      MODIFIED CODE AS PART OF OPE STEP 2  *CG160325
      * CLARITY ID-P000002860     TO CONSIDER INTRANSIT QTY WITH       *CG160325
      *                           SHIPPED QTY. CHANGES ARE TAGGED AS   *CG160325
      *                           CG160325.                            *CG160325
      * 20MAY16  52345134  CGI   CODE MODIFIED TO STORE                 CG160520
      *                          IMPORT FILE NUMBER FOR XBR+NOTIFY      CG160520
      *                          IN TEXT-LINE .CHANGES WERE MADE AS     CG160520
      *                          PART OF THE TICEKT IN52345134 AND      CG160520
      *                          TAGGED AS CG160520.                    CG160520
      * 26AUG16 INTRAZONE  CGI   CODE MODIFIED TO -                     CG160826
      *         8DW270           1. BYPASS ZERO SHIP LINE FOR SOSHIP    CG160826
      *                             MESSAGES (OPE_AVAL-9267)            CG160826
      *                          2. PRINT INVOICE DOCUMENTS ON DUMMY    CG160826
      *                             PRINTER FOR TRW ORIGINATED ORDERS.  CG160826
      *                             (OPE_AVAL-9137).                    CG160826
      *                          CHANGES TAGGED AS CG160826.            CG160826
      * 03SEP16 CLARITY#   CGI   CODE MODIFIED AS PART OF CARRIER PRO   CG161003
      *         P000008494       NUMBER PROJECT. CHANGES ARE TAGGED TO  CG161003
      *                          THE CHANGE-CODE # CG161003             CG161003
      * 02NOV16 PROD TICKET# CGI CODE FIX MADE TO NOT STORE FREE FORM   CG161102
      *         SR52972766       ITEMS FOR GEODE-SHIP-FROM SITES.       CG161102
      *         IN52751649       CHANGES ARE TAGGED TO - CG161102.      CG161102
      * 04/20/17 NGW-1950    CGI CHANGES BEING MADE TO PASS THE CUSTOMERCG170420
      *                          DUE TIME TO SDS FOR FOURKITES          CG170420
      *                          CHANGES ARE TAGGED TO - CG170420.      CG170420
      * 10/30/18 NGWA-329    CGI CHANGES BEING MADE FOR TRANSFER ORDER  CG181030
      *                          SHIPMENTS TO PASS THE LOAD-ID-SHORT    CG181030
      *                          FOR PUSHTO SITES WITH MOVEMENT-CODE    CG181030
      *                          "TP" ON THE TOSHIP MESSAGE.            CG181030
      *                          CHANGES ARE TAGGED TO - CG181030.      CG181030
      * 05/06/20 EVGN-665    CGI CHANGES BEING MADE FOR THE BLUESKY     CG200506
      *                          PROJECT WHERE IN FOR XB PUSHTO SHIPMENTCG200506
      *                          ORIGINATING FROM CA2-->U60 (ONLY), THE CG200506
      *                          UNIT PRICE AND THE FREIGHT APPLICABLE  CG200506
      *                          ON THE INVOICE WILL BE TAKEN FROM THE  CG200506
      *                          TEMP UNIT PRICE TABLE STORED AT THE    CG200506
      *                          TIME OF XBRDINFO MESSAGE. ALSO AN ENTRYCG200506
      *                          IS STORED ON TRWDELLOD TABLE FOR THE   CG200506
      *                          FREIGHT PAYMENT PROCESS TO USE.        CG200506
      *                          CHANGES ARE PART OF A POC AND ARE ONLY CG200506
      *                          FOR THE CA2-->U60 LANE.                CG200506
      *                          CHANGES ARE TAGGED TO - CG200506.      CG200506
      * 04/05/22 TSSC-7696  CG6C PROGRAM MODIFIED FOR TSSC-7696 GEODE   CG220405
      *                          CSD MISSION REQUEST. FOR CROSS BORDER  CG220405
      *                          TRANSFERS, IF ALL THE LINES UNDER A    CG220405
      *                          DELIVERY ID ARE SHORT SHIPPED THEN THE CG220405
      *                          INV# WILL NOT BE ASSIGNED IN GEODE AND CG220405
      *                          INV# WILL BE BLANK. HOWEVER SDS REJECTSCG220405
      *                          SUCH TRANSACTIONS. SO CODE IS MODIFIED CG220405
      *                          TO DEFAULT INV# FOR CROSS BORDER TO    CG220405
      *                          SHIPMENTS IF THE INV# FROM GEODE IS    CG220405
      *                          BLANK. THIS PROGRAM IS SMART ENOUGH TO CG220405
      *                          ROLLBACK THE SHIPMENT HEADER/ LINES &  CG220405
      *                          INVOICE RECORDS WHEN IT DETECTS ALL    CG220405
      *                          LINES WITH ZERO SHIPPED QTY. TAGGED => CG220405
      * 07/15/22 TSSC-7813 CGI   MODIFIED CODE FOR BLUESKY LOGICAL    * CG220715
      *                          STOCK.TAGGED AS CG220715.            * CG220715
      * 12/05/22 OPEN PRJ   CGDN CODE CHANGES MADE TO STOP INVOICE CREA CG221205
      *          EVGN-2928       -TION IN SDS FOR CUSTOMERS TO BE IN    CG221205
      *                          TARAGET APP FOP.                       CG221205
      *                          CHANGES TAGGED AS CG221205             CG221205
      * 04/24/23 NALD-846   CGAB CHANGES MADE AS PART OF BLUESKY PROJECTCG230424
      *                          TO ALLOW PUSH SHIPMENTS FOR ALL SITES. CG230424
      *                          THIS IS PH-2 OF THE BLUESKY PROJECT ANDCG230424
      *                          GOING FORWARD APART FROM CA2, OTHER    CG230424
      *                          SERVICE-TS WILL ALSO BE DOING PUSH     CG230424
      *                          SHIPMENTS TO THE DC.                   CG230424
      * 07/25/22 OPEN PRJ   CGDN CODE CHANGES MADE TO GENERATE UNIQUE   CG230725
      *                          SHIPMENT NUMBER.                       CG230725
      *                          CHANGES TAGGED AS CG230725             CG230725
      * 03/15/24 BLUESKY    CGS1 CODE CHANGES MADE TO NOT GO THROUGH    CG240315
      *         (TSSC-11160)     PRICING VALIDATION FOR DOMESTIC        CG240315
      *                          PUSH SHIPMENT.                         CG240315
      *                          CHANGES TAGGED AS CG240315.            CG240315
      * 05/16/24 PRODUCTION CGS1 CODE CHANGES MADE TO USE THE RIGHT     CG240516
      *           ISSUES         FIELD FOR IDENTIFYING XB PUSH          CG240516
      *                          SHIPMENT.                              CG240516
      *                          CHANGES TAGGED AS CG240516.            CG240516
      * 05/30/24 OPEN-GTC   CGMM CODE CHANGES MADE TO EXTRACT LOAD      CG240716
      *         (TSSC-11961)     NUMBER FROM GEODE AND STORE IT IN      CG240716
      *                          TEMP TABLE GTMLOADNBR                  CG240716
      *                          CHANGES TAGGED AS CG240716.            CG240716
      *----------------------------------------------------------------         
029500 EJECT                                                                    
029700 ENVIRONMENT DIVISION.                                                    
029800 CONFIGURATION SECTION.                                                   
029900 SOURCE-COMPUTER. IBM-370.                                                
030000 OBJECT-COMPUTER. IBM-370.                                                
030100                                                                          
030200 IDMS-CONTROL SECTION.                                                    
030300 PROTOCOL.      MODE IS IDMS-DC DEBUG                                     
030400                IDMS-RECORDS MANUAL.                                      
       SKIP3                                                                    
030600 DATA DIVISION.                                                           
030700 SCHEMA SECTION.                                                          
030800 DB COES4BAT WITHIN CASSCHEM.                                     IM980924
030900 EJECT                                                                    
031000 WORKING-STORAGE SECTION.                                                 
031100 EJECT                                                                    
031200********************************************************                  
031300*                T A B L E S                           *                  
031400********************************************************                  
031500                                                                          
031600********************************************************                  
031700*    C O U N T E R S   /   A C C U M U L A T O R S     *                  
031800*                 D B K E Y S                          *                  
031900********************************************************                  
032000                                                                          
032100********************************************************                  
032200*             W O R K    E L E M E N T S               *                  
032300********************************************************                  
                                                                                
       01  WS-ITEM-CNT                      PIC 9(2) VALUE ZEROS.       IM980924
       01  WS-VAS-INDEX                     PIC 9(2) COMP-3             CG031013
                                                     VALUE ZEROS.       CG031013
       01  WS-QTY-SHIPPED                   PIC S9(8)V999               CG031013
                                                     VALUE ZEROS.       CG031013
      * IMRNI CHANGE BEGIN                                                      
      *                                                                         
       01  Y2K-WK-CUTOFF-YR-9               PIC 9(2) VALUE 60.                  
      *                                                                         
       01  Y2K-WK-DATE1-9.                                                      
           05  Y2K-WK-DATE1-9-CC            PIC 9(2).                           
           05  Y2K-WK-DATE1-9-YYDDD         PIC 9(5).                           
           05  Y2K-WK-DATE1R-9-YYDDD REDEFINES Y2K-WK-DATE1-9-YYDDD.            
               10  Y2K-WK-DATE1R-9-YY       PIC 9(2).                           
               10  Y2K-WK-DATE1R-9-DDD      PIC 9(3).                           
      *                                                                         
       01  Y2K-WK-DATE1RR-9 REDEFINES Y2K-WK-DATE1-9.                           
           05  Y2K-WK-DATE1RR-9-CCYY        PIC 9(4).                           
           05  Y2K-WK-DATE1RR-9-DDD         PIC 9(3).                           
      *                                                                         
       01  Y2K-WK-DATE1RRR-9 REDEFINES Y2K-WK-DATE1-9 PIC 9(7).                 
      *                                                                         
      * IMRNI CHANGE END                                                        
      *                                                                         
032400                                                                          
032500                                                                          
032600 01  WS-WORK-ELEMENTS.                                                    
032700                                                                          
3LO030     05  TMS-REC-ELEMENTS.                                                
3LO030         10 TMS-REC-01.                                                   
3LO030            15 TMS-MBOL              PIC X(07).                           
3LO030            15 TMS-SCAC              PIC X(04).                           
3LO030            15 TMS-SHIP-DATE         PIC X(08).                           
3LO030            15 TMS-EQUIPMENT-TYPE    PIC X(02).                           
3LO030         10 TMS-REC-02.                                                   
3LO030            15 TMS-BOL               PIC X(07).                           
3LO030            15 TMS-CUSTOMER          PIC X(10).                           
3LO030            15 TMS-BOL-WEIGHT        PIC 9(5).999.                        
3LO030         10 TMS-REC-03.                                                   
3LO030            15 TMS-SOURCE-DC         PIC X(03).                           
3LO030            15 TMS-SDS-ORDER         PIC X(09).                           
3LO030            15 TMS-ORDER-TYPE        PIC X(01) VALUE SPACES.              
3LO030            15 TMS-LS-ORDER-TYPE     PIC X(01) VALUE SPACES.              
3LO030         10 TMS-REC-04.                                                   
3LO030            15 TMS-NAPN              PIC X(07).                           
3LO030            15 TMS-MSPN              PIC X(05).                           
3LO030            15 TMS-SHIP-QTY          PIC 9(08).                           
3LO030            15 TMS-CANCEL-QTY        PIC 9(08).                           
3LO030            15 TMS-SO-LINE-NBR       PIC 9(03).                           
3LO030            15 TMS-SO-LINE-SCHED     PIC 9(02).                           
3LO030            15 TMS-ORDER-NUMBER      PIC X(09).                           
3LO030            15 TMS-PRIORITY          PIC X(02).                           
3LO030            15 TMS-CANCEL-RESN-CODE  PIC X(01).                           
3LO030            15 TMS-FLAG              PIC X(01).                           
3LO030            15 TMS-REBILL-FLAG       PIC X(01).                           
                                                                                
3LO030     05  WS-TRANS-TYPE               PIC X(08) VALUE SPACES.              
3LO030     05  WS-LOOP-1205                PIC 9(02) VALUE ZEROES.              
3LO030     05  WS-REC-COUNTER              PIC 9(04) VALUE ZEROES.              
                                                                                
032800     05  DEBUG-SNAP                  PIC X(134).                          
                                                                                
           05  WS-DIS-CODE-FND             PIC X(01) VALUE 'N'.         IM000331
           05  WS-SUB                      PIC 9(02) COMP VALUE ZEROS.  IM000331
           05  WS-WMS-IMPT-FILE-NBR        PIC X(12) VALUE SPACES.      CG160520
           05  WS-RECV-IMPT-FILE-NBR       PIC X(12) VALUE SPACES.      IM011001
           05  WS-RECV-IMPT-FILE-NBR1   REDEFINES WS-RECV-IMPT-FILE-NBR.CG021211
044706         10  WS-IMPT-FILE-CC         PIC X(02).                   CG021211
044707         10  WS-IMPT-FILE-YY         PIC X(02).                   CG021211
044707         10  WS-IMPT-FILE-TYPE       PIC X(03).                   CG021211
044707         10  WS-IMPT-FILE-SEQ-NBR    PIC X(05).                   CG021211
044707     05  WS-IMPT-FILE-SEQ-NBR1       PIC 9(05).                   CG021211
044703     05  MARC-EXPORT-FLAG            PIC X.                       CG021211
044703         88  MARC-EXPORT             VALUE 'Y'.                   CG021211
044703     05  UG-EXPORT-FLAG              PIC X.                       CG021211
044703         88  UG-EXPORT               VALUE 'Y'.                   CG021211
044703     05  CONTROL-TABLE-FLAG          PIC X   VALUE SPACES.        CG021211
044703     05  FIRST-TIME-FLAG             PIC X   VALUE SPACES.        CG021211
032900                                                                          
033000     05  WORK-OAVI-TEXT.                                                  
033100         10  OAVI-LOAD               PIC X(06).                           
033200         10  OAVI-BOL                PIC X(07).                           
033300         10  FILLER                  PIC X(119).                          
033000     05  WS-SAVE-INVOICE-NBR         PIC X(12).                   CG221205
033000     05  WORK-RAMPUP-TEXT.                                        CG221205
033200         10  RAMPUP-BOL              PIC X(018).                  CG221205
033200         10  RAMPUP-PROCESSED-FLAG   PIC X(001).                  CG221205
033300         10  FILLER                  PIC X(113).                  CG221205
033400                                                                          
044705     05  WS-WORK-CL92-TEXT.                                       IM000331
044706         10  WS-CL92-DIS-CODE        PIC X(10) VALUE SPACES.      IM000331
044707         10  WS-CL92-DIS-VALUE       PIC S9(09)V9999 VALUE ZEROS. IM000331
044800         10  FILLER                  PIC X(109) VALUE SPACES.     IM000331
033400                                                                          
033500     05  WORK-XBRD-TEXT.                                                  
033600         10  XBRD-LOAD               PIC X(06).                           
033700         10  XBRD-INVOICE            PIC X(12).                           
033800         10  XBRD-INDICATOR          PIC X(01).                           
033900             88  XBRD-CROSS-BRDR       VALUE 'X'.                         
034000         10  XBRD-OE-PROCESSED       PIC X(01).                           
034100             88  OE-PROCESSED          VALUE 'Y'.                         
034200         10  XBRD-NAIT-PROCESSED     PIC X(01).                           
034300             88  NAIT-PROCESSED        VALUE 'Y'.                         
034310         10  XBRD-IMPORT-FILE-NBR    PIC X(12).                   000026LD
034400         10  FILLER                  PIC X(99).                   000026LD
034500                                                                          
034600     05  WS-PROGRAM-ID.                                           000023LJ
034700         10  FILLER                  PIC X.                       000023LJ
034800         10  WS-PROG-ID              PIC X(08).                   000023LJ
034900     05  WS-LOAD.                                                 000023LJ
035000         10  FILLER                  PIC X.                       000023LJ
035100         10  WS-LOAD-NUMBER          PIC X(06).                   000023LJ
035101     05  WS-MESSAGE                  PIC X(30).                   000023LJ
034900     05  WS-C-LOAD-NBR               PIC X(07) VALUE SPACES.      CG240716
035102                                                                          
035103     05  WORK-SHIP-LINE              PIC 9(03) VALUE 0.                   
035104                                                                          
035104     05 MEXICAN-XBRD-FLAG             PIC X(01) VALUE SPACES.     IM011023
035104     05  PRE-PRINT-FLAG               PIC X(01) VALUE 'N'.        IM011023
           05  WS-GEODE-PRINTLINE1.                                     CG081124
                   15  WS-LINE1        PIC X(38) VALUE                  CG100623
                       'SYSOUT=1,OUTPUT=*.PRINT,COPIES=3,DEST='.        CG100623
                   15  WS-GEODE-PRINTER                                 CG081124
                                       PIC X(08) VALUE SPACES.          CG081124
           05  WS-GEODE-PRINTLINE      REDEFINES                        CG081124
               WS-GEODE-PRINTLINE1     PIC X(46).                       CG100623
035104     05  WS-SHIP-FROM-DESC            PIC X(03) VALUE SPACES.     CG021001
035104                                                                          
           05  WS-AOWMGDNA.                                             CG081124
                   15  WS-DB-NAME-GDNA      PIC X(08) VALUE SPACES.     CG081124
                   15  WS-BOL-NUMBER-GDNA   PIC X(07) VALUE SPACES.     CG081124
                   15  WS-PRINT-DEST-GEODE  PIC X(48) VALUE SPACES.     CG081124
                   15  WS-PRE-PRINT-GEODE   PIC X(01) VALUE SPACES.     CG081124
                   15  WS-IMPT-FILE-NBR-GDNA                            CG081124
                                            PIC X(12) VALUE SPACES.     CG081124
035105     05  SAVE-TIME.                                                       
035106         10  SAVE-TIME-HMS.                                               
035107             15  SAVE-TIME-HM.                                            
035108                 20  SAVE-TIME-HH     PIC 9(02).                          
035200                 20  SAVE-TIME-MM     PIC 9(02).                          
035300             15  SAVE-TIME-SS         PIC 9(02).                          
035400         10  FILLER                   PIC X(02).                          
035500                                                                          
035600                                                                          
035700     05  SAVE-DATE-W-CC.                                                  
035800         10  SAVE-DATE-CC             PIC X(02).                          
035900         10  SAVE-DATE                PIC X(06).                          
036000         10  SAVE-DATE-N REDEFINES SAVE-DATE.                             
036100             15  SAVE-DATE-YY         PIC 9(02).                          
036200             15  SAVE-DATE-MM         PIC 9(02).                          
036300             15  SAVE-DATE-DD         PIC 9(02).                          
036400                                                                          
036500     05  SAVE-FINISH-TIME.                                                
036600         10  SAVE-FINISH-TIME-HMS.                                        
036700             15  SAVE-FINISH-TIME-HM  PIC 9(04).                          
036800             15  FILLER               PIC 9(02).                          
036900         10  FILLER                   PIC X(02).                          
037000                                                                          
037100     05  SAVE-CURRENT-TABLE           PIC X(10) VALUE SPACES.             
037100     05  SAVE-REV-PO-FLAG             PIC X(01) VALUE SPACES.     C03407  
037100     05  SAVE-REV-PO-NBR.                                         C03407  
037400         10  SAVE-REV-PO-2X           PIC X(02) VALUE SPACES.     C03407  
037400         10  SAVE-REV-PO-4X           PIC X(04) VALUE SPACES.     C03407  
037100     05  SAVE-REV-PO-BOL.                                         C03407  
037400         10  SAVE-REV-BOL-2X          PIC X(02) VALUE SPACES.     C03407  
037400         10  FILLER                   PIC X(01) VALUE SPACES.     C03407  
037400         10  SAVE-REV-BOL-4X          PIC X(04) VALUE SPACES.     C03407  
037200                                                                          
037300     05  WORK-SALES-ORDER.                                                
037400         10  WORK-CSR-ID              PIC X(04) VALUE SPACES.             
037500             88  U24-CSR              VALUE 'S800' THRU 'S824'.           
037600             88  U09-CSR              VALUE 'S825' THRU 'S850'.           
037700         10  FILLER                   PIC X(05) VALUE SPACES.             
038702                                                                          
038703     05  SAVE-LAST-SHIP-HDR           PIC 9(03).                          
038703     05  SAVE-LAST-SHIP-UNIQUE-NBR    PIC 9(03).                  CG230725
038704     05  SAVE-BORDER-EXIT-PT          PIC 9(04).                  000025LD
038705                                                                          
038706     05  SAVE-CUST-CLASS.                                         000021LJ
038707         10  SAVE-CUST-CATEG          PIC XX.                     000021LJ
038708         10  SAVE-CUST-CHNL           PIC XX.                     000021LJ
038709         10  SAVE-CUST-SUB-CHNL       PIC X(3).                   000021LJ
038710                                                                          
038711                                                                          
038712     05  WORK-LOAD-RANGES-X           PIC X(12).                          
038713     05  WORK-LOAD-RANGES-9 REDEFINES WORK-LOAD-RANGES-X.                 
038714         10  LOW-LOAD-RANGE           PIC 9(06).                          
038715         10  HIGH-LOAD-RANGE          PIC 9(06).                          
038716                                                                          
038717     05  WORK-BOL-RANGES.                                                 
038800         10  LOW-BOL-RANGE            PIC X(07).                          
038900         10  FILLER                   PIC X(01).                          
039000         10  HIGH-BOL-RANGE           PIC X(07).                          
039100                                                                          
039200     05  WORK-SHIP-DATE               PIC X(08).                          
039300     05  WORK-SHIP-DATE-N  REDEFINES WORK-SHIP-DATE.                      
039400         10  FILLER                   PIC 9(02).                          
039500         10  SHIP-DATE-YMD            PIC 9(06).                          
039600                                                                          
039700     05  WORK-PEND-DEST               PIC X(08).                  000027LM
039800                                                                          
039900     05  SAVE-JCL-LINE                PIC X(80).                          
040000     05  SAVE-JCL-LINE2.                                          000023LJ
040100         10  FILLER                   PIC XX.                     000023LJ
040200         10  SAVE-JOB-NAME            PIC X(4).                   000023LJ
040300             88  JOB-CARD             VALUE 'SDP2'.               000023LJ
040301         10  FILLER                   PIC X(80).                  000023LJ
040302                                                                          
040303     05  SAVE-JCL-TYPE                PIC X(08).                          
040304                                                                          
040305     05  SAVE-SERIAL-NUMBER           PIC 9(08).                          
040400                                                                          
040500*       *****************************************                         
040600*       *     SHIP FROM ELEMENTS                *                         
040700*       *****************************************                         
040800     05  SAVE-SHIP-FROM.                                                  
040900         10  SAVE-SHIP-FROM-ONE       PIC X(01).                          
041000             88 CAN-SHIP-FROM         VALUE 'C'.                          
041100             88 US-SHIP-FROM          VALUE 'U'.                          
041200             88 XLA-SHIP-FROM         VALUE 'X'.                          
041300         10  SAVE-SHIP-FROM-TWO       PIC X(01).                          
041400         10  FILLER                   PIC X(01).                          
041500                                                                          
041600     05  SAVE-SHIP-FROM-WICS-IND      PIC X(01).                          
041700         88  WICS-SHIP-FROM                 VALUE 'Y'.                    
041800         88  WMS-SHIP-FROM                  VALUE 'Y'.                    
               88  GEODE-SHIP-FROM                VALUE 'G'.            CG081124
                                                                        CG100106
           05  WS-SOLOMON-PLANT             PIC X(01)                   CG100106
                                                  VALUE 'N'.            CG100106
041900                                                                          
042000     05  SAVE-SHIP-FROM-COMPANY       PIC X(01).                          
042100         88  UG-SHIP-FROM                   VALUE 'U'.                    
042200         88  MICHELIN-SHIP-FROM             VALUE 'M'.                    
042300                                                                          
042400     05  SAVE-SERVICING-DC            PIC X(03).                          
042500                                                                          
042600*       *****************************************                         
042700*       *     SHIP TO ELEMENTS                  *                         
042800*       *****************************************                         
042900     05  SAVE-SHIP-TO.                                                    
042910         10  SAVE-SHIP-TO-ONE-TWO.                                000015LJ
043000             15  SAVE-SHIP-TO-ONE         PIC X(01).                      
043100                 88  CAN-SHIP-TO          VALUE 'C'.                      
043110                 88  MX-SHIP-TO           VALUE 'M'.              000033DB
043200                 88  US-SHIP-TO           VALUE 'U'.                      
043300                 88  XLA-SHIP-TO          VALUE 'X'.                      
043400             15  SAVE-SHIP-TO-TWO         PIC X(01).                      
043500         10  FILLER                   PIC X(01).                          
043600                                                                          
043600                                                                  CG030130
043600     05  SAVE-BILL-TO                 PIC X(02).                  CG030130
043600         88  CAN-BILL-TO                    VALUE 'CA'.           CG030130
043600         88  US-BILL-TO                     VALUE 'US'.           CG030130
               88  MX-BILL-TO                     VALUE 'MX'.           CG030730
043600                                                                  CG030130
043600     05  WS-SHIP-TO                  PIC X(02) VALUE SPACES.      CG030203
043600         88  WS-US-SHIP-TO                      VALUE 'US'.       CG030203
043600         88  WS-CAN-SHIP-TO                     VALUE 'CA'.       CG030203
043700                                                                  CG030203
043800     05  SAVE-SHIP-TO-WICS-IND        PIC X(01).                          
043900         88  WICS-SHIP-TO                   VALUE 'Y'.                    
044000                                                                          
044100     05  SAVE-SHIP-TO-WMS-IND         PIC X(01).                          
044200         88  WMS-SHIP-TO                    VALUE 'Y'.                    
044300                                                                          
044400     05  SAVE-SHIP-TO-COMPANY         PIC X(01).                          
044500         88  UG-SHIP-TO                     VALUE 'U'.                    
044600         88  MICHELIN-SHIP-TO               VALUE 'M'.                    
044700                                                                          
044800     05  SAVE-PAPER-WHSE              PIC X(03).                          
044800     05  SAVE-SHIP-FROM-MRTI          PIC X(03).                  CG020514
044800     05  SAVE-MRTI-FLAG               PIC X(01).                  CG020514
           05  SAVE-MRTI-SW                 PIC X(01) VALUE 'N'.        CG021213
               88  MRTI-SHIPMENT                      VALUE 'Y'.        CG021213
044900                                                                          
044910     05  CNT-LOAD-NBRS-TRIED          PIC S9(3) COMP-3.           000022LD
045000                                                                          
           05  WS-WHSE-END-BAL              PIC S9(7) VALUE +0.         CG030211
                                                                                
045100     05  CONSIGNMENT-AMT              PIC S9(13)V99  COMP-3               
045200                                            VALUE +0.                     
042600*       *****************************************                         
042700*       *     SHIP TO ELEMENTS                  *                         
042800*       *****************************************                         
045300 EJECT                                                                    
045400*       ******************************************                        
045500*       *   ELEMENTS NEEDED FOR  DATE CALCULATION*                        
045600*       ******************************************                        
045700     05  WS-JULIAN-DAY-TABLE.                                             
045800         10  FILLER                   PIC X(05) VALUE '01031'.            
045900         10  FILLER                   PIC X(05) VALUE '02059'.            
046000         10  FILLER                   PIC X(05) VALUE '03090'.            
046100         10  FILLER                   PIC X(05) VALUE '04120'.            
046200         10  FILLER                   PIC X(05) VALUE '05151'.            
046300         10  FILLER                   PIC X(05) VALUE '06181'.            
046400         10  FILLER                   PIC X(05) VALUE '07212'.            
046500         10  FILLER                   PIC X(05) VALUE '08243'.            
046600         10  FILLER                   PIC X(05) VALUE '09273'.            
046700         10  FILLER                   PIC X(05) VALUE '10304'.            
046800         10  FILLER                   PIC X(05) VALUE '11334'.            
046900         10  FILLER                   PIC X(05) VALUE '12365'.            
047000                                                                          
047100     05  WS-JULIAN-TBL-R REDEFINES WS-JULIAN-DAY-TABLE                    
047200                                      OCCURS 12 TIMES                     
047300                                      INDEXED BY MTH-INDEX.               
047400         10  WS-MM                    PIC 9(02).                          
047500         10  WS-LAST-JDAY-OF-MM       PIC 9(03).                          
047600                                                                          
047700     05  SAVE-JULIAN-DATE.                                                
047800         10  SAVE-JUL-YY              PIC 9(02)  VALUE 0.                 
047900         10  SAVE-JUL-DDD             PIC 9(03)  VALUE 0.                 
048000                                                                          
048100     05  LEAP                         PIC 9(02) VALUE 0.                  
048200     05  DUMMY                        PIC 9(02) VALUE 0.                  
048300     05  SAVE-ETA-DAYS                PIC X(03)  VALUE SPACES.            
048400     05  SAVE-ETA-DAYS-N REDEFINES SAVE-ETA-DAYS                          
048500                                      PIC 9(03).                          
048600                                                                          
048700     05  SAVE-ETA-DATE                PIC X(08)  VALUE SPACES.            
048800     05  SAVE-ETA-DATE-N REDEFINES SAVE-ETA-DATE.                         
048900         10  SAVE-ETA-CC              PIC 9(02).                          
049000         10  SAVE-ETA-YY              PIC 9(02).                          
049100         10  SAVE-ETA-MM              PIC 9(02).                          
049200         10  SAVE-ETA-DD              PIC 9(02).                          
049210                                                                          
048800     05  WK-DOT                       PIC X(03) VALUE SPACES.     IM991029
048800     05  WK-DOT-WWY      REDEFINES WK-DOT.                        IM991029
048900         10  WK-DOT-WEEK              PIC X(02).                  IM991029
049000         10  WK-DOT-YEAR              PIC X(01).                  IM991029
049210                                                                  IM991029
048800     05  WK-DOT-WWYY.                                             IM991029
048900         10  WK-DOT-WW                PIC X(02).                  IM991029
049000         10  WK-DOT-DECADE            PIC X(01).                  IM991029
049000         10  WK-DOT-Y                 PIC X(01).                  IM991029
049210                                                                  IM991029
           05  WORK-CURR-YEAR               PIC 9(04) VALUE 0.          IM991029
           05  WORK-CURRYEAR  REDEFINES WORK-CURR-YEAR.                 IM991029
               10 WORK-CURR-CC              PIC 9(02).                  IM991029
               10 WORK-CURR-YY.                                         IM991029
                  20 WORK-CURR-DEC          PIC 9(01).                  IM991029
                  20 WORK-CURR-Y            PIC 9(01).                  IM991029
                                                                        IM991029
           05  WORK-HIGH-YEAR               PIC 9(04) VALUE 0.          IM991029
           05  WORK-HIGHYEAR  REDEFINES WORK-HIGH-YEAR.                 IM991029
               10 WORK-HIGH-CC              PIC 9(02).                  IM991029
               10 WORK-HIGH-DEC             PIC 9(01).                  IM991029
               10 WORK-HIGH-Y               PIC 9(01).                  IM991029
                                                                        IM991029
           05  WORK-LOW-YEAR                PIC 9(04) VALUE 0.          IM991029
           05  WORK-LOWYEAR   REDEFINES WORK-LOW-YEAR.                  IM991029
               10 WORK-LOW-CC               PIC 9(02).                  IM991029
               10 WORK-LOW-DEC              PIC 9(01).                  IM991029
               10 WORK-LOW-Y                PIC 9(01).                  IM991029
                                                                        IM991029
           05  WORK-BASE-DOT-YEAR           PIC 9(04) VALUE 0.          IM991029
           05  WORK-BASEDOT-YEAR  REDEFINES WORK-BASE-DOT-YEAR.         IM991029
               10 WORK-BASE-CC              PIC 9(02).                  IM991029
               10 WORK-BASE-DEC             PIC 9(01).                  IM991029
               10 WORK-BASE-YY              PIC 9(01).                  IM991029
                                                                        IM991029
049210                                                                          
049220     05  WS-OLD-DATE.                                             000036LM
049230         10  WS-OLD-CC                PIC 9(02).                  000036LM
049240         10  WS-OLD-YMD.                                          000036LM
049241             15  WS-OLD-YY            PIC 9(02).                  000036LM
049242             15  FILLER               PIC 9(04).                  000036LM
049250     05  WS-TEST-DATE.                                            000036LM
049260         10  WS-TEST-YEAR             PIC 9(04).                  000036LM
049270         10  FILLER                   PIC 9(04).                  000036LM
049290     05  WS-HOLD-LOAD-DBKEY           PIC S9(8) COMP.             000036LM
       01  WS-NDR-ROUTINE.                                              CG070201
           05 WS-DATE-KNOWN             PIC 9(08)  VALUE ZEROES.        CG070201
           05 WS-DATE-UNKNOWN           PIC 9(08)  VALUE ZEROES.        CG070201
           05 WS-DAY-COUNT              PIC S9(05) VALUE ZEROES.        CG070201
           05 WS-CHECK-BYTE             PIC X(01)  VALUE SPACES.        CG070201
           05 WS-RETURN-CODE            PIC S9(04) COMP                 CG070201
                                                   VALUE ZEROES.        CG070201
       01  WS-VARIABLES.                                                CG070201
           05 WS-PSD                    PIC 9(08)  VALUE ZEROES.        CG070201
           05 WS-CDD                    PIC 9(08)  VALUE ZEROES.        CG070201
           05 WS-IRD                    PIC 9(08)  VALUE ZEROES.        CG070201
           05 WS-UNLOAD-TIME            PIC 9(02)  VALUE ZEROES.        CG070201
           05 WS-DATE-NOT-FOUND         PIC X(01)  VALUE SPACES.        CG070702
           05 WS-MODE                   PIC X(01)  VALUE SPACES.        CG070702
           05 WS-SHIP-FROM-SITE         PIC X(03)  VALUE SPACES.        CG200506
           05 WS-BOL-NBR                PIC X(07)  VALUE SPACES.        CG200506
           05 WS-LOAD-ID-SHORT          PIC X(07)  VALUE SPACES.        CG200506
           05 WS-TEMP-UNIT-PRICE        PIC X(11)  VALUE SPACES.        CG200506
           05 WS-TEMP-FREIGHT-CHG       PIC X(13)  VALUE SPACES.        CG200506
           05 WS-FINL-FREIGHT-CHG       PIC 9(11)V99 VALUE ZEROES.      CG200506
           05 WS-FINL-UNIT-PRICE        PIC 9(09)V99 VALUE ZEROES.      CG200506
           05 WS-BLUESKY-DATA         PIC X(01)  VALUE 'N'.             CG220715
           05 WS-BLUESKY-DC.                                            CG220715
              10 WS-SRC-DC            PIC X(03)  VALUE SPACES.          CG220715
              10 WS-DEST-DC           PIC X(03)  VALUE SPACES.          CG220715
049300 EJECT                                                                    
049400********************************************************                  
049500*                S W I T C H E S                       *                  
049600********************************************************                  
049700                                                                          
049800 01  WS-SWITCHES.                                                         
049900     05  SW-MASTER-BOL-EXISTS         PIC X(01) VALUE SPACES.             
050000         88 MASTER-BOL-EXISTS                   VALUE 'Y'.                
050100                                                                          
050200                                                                          
050300     05  SW-EXEC-PFO                  PIC X(01) VALUE SPACES.             
050400         88 EXEC-PFO                            VALUE 'Y'.                
050500                                                                          
050600     05  SW-END-BOLS                  PIC X(01) VALUE SPACES.             
050700         88 END-BOLS                            VALUE 'Y'.                
050800                                                                          
050900     05  SW-END-SHIP-HDRS             PIC X(01) VALUE SPACES.             
051000         88 END-SHIP-HDRS                       VALUE 'Y'.                
051100                                                                          
051200     05  SW-END-SHIP-LINES            PIC X(01) VALUE SPACES.             
051300         88 END-SHIP-LINES                      VALUE 'Y'.                
051400                                                                          
051500     05  SW-ZERO-SHIP-HDR             PIC X(01) VALUE SPACES.             
051600         88 ZERO-SHIP-HDR                       VALUE 'Y'.                
051700                                                                          
051800     05  SW-END-COO-SPLIT             PIC X(01) VALUE SPACES.             
051900         88 END-COO-SPLIT                       VALUE 'Y'.                
052000                                                                          
052100     05  SW-FIRST-TIME                PIC X(01) VALUE 'Y'.                
052200         88 FIRST-TIME                          VALUE 'Y'.                
052400                                                                          
052500     05  SW-TABLE-LOOKUP              PIC X(01) VALUE SPACES.             
052600         88 TABLE-RECORD-FOUND                  VALUE 'Y'.                
052700         88 TABLE-EMPTY                         VALUE 'E'.                
052800                                                                          
052900     05  SW-FIRST-SHIP-HDR            PIC X(01) VALUE SPACES.             
053000         88 FIRST-SHIP-HDR                      VALUE 'Y'.                
053100                                                                          
053200     05  SW-TABLE-DET-LOOKUP          PIC X(01) VALUE 'Y'.                
053300         88 GET-TABLE-DETAIL                    VALUE 'Y'.                
053400                                                                          
053500     05  SW-TEXT-DETAIL               PIC X(01) VALUE SPACES.             
053600         88 END-TEXT-DETAIL                     VALUE 'Y'.                
053700                                                                          
053800     05  SW-PAPER-WHSE                PIC X(01) VALUE SPACES.             
053900         88 PAPER-WHSE-REQD                     VALUE 'Y'.                
053910                                                                          
053920     05  SW-LOAD-REC-STORED           PIC X(01) VALUE SPACES.     000022LD
053930         88 LOAD-REC-STORED                     VALUE 'Y'.        000022LD
053940                                                                          
053950     05  SW-TRACK-ID-FOUND            PIC X(01) VALUE SPACES.     000030LM
053960         88 TRACK-ID-FOUND                      VALUE 'Y'.        000030LM
053970                                                                          
053980     05  SW-END-INV-TRACK-ID          PIC X(01) VALUE SPACES.     000030LM
053990         88 END-INV-TRACK-ID                    VALUE 'Y'.        000030LM
054000                                                                          
054403     05  SW-NEW-XBRD-SHIPMENT         PIC X(01) VALUE 'N'.        IM010212
               88 NEW-XBRD-SHIPMENT                   VALUE 'Y'.        IM010212
                                                                                
           05  SW-MR-XB-SHIPMENT            PIC X(01) VALUE 'N'.        CG020514
               88 MRTI-XBRD-SHIPMENT                  VALUE 'X'.        CG020514
               88 MRTI-DOM-SHIPMENT                   VALUE 'D'.        CG020514
                                                                        CG020514
           05  WS-IFNUM-SWAP-FLAG      PIC X  VALUE SPACE.              CG200506
               88  WS-IFNUM-SWAP-YES          VALUE 'Y'.                CG200506
               88  WS-IFNUM-SWAP-NO           VALUE 'N'.                CG200506
           05  WS-PUSH-LOAD-FLAG       PIC X  VALUE SPACE.              CG200506
               88  WS-PUSH-LOAD-YES           VALUE 'Y'.                CG200506
               88  WS-PUSH-LOAD-NO            VALUE 'N'.                CG200506
           05  WS-INVOICE-TARGET-SYS   PIC X  VALUE 'N'.                CG221205
               88  INVOICE-TARGET-IS-SDS      VALUE 'N'.                CG221205
               88  INVOICE-TARGET-IS-FOP      VALUE 'Y'.                CG221205
           05  WS-SIMULATE-TARGET-SYS  PIC X  VALUE 'N'.                CG221205
               88  SIMULATE-FOP               VALUE 'Y'.                CG221205
           05  WS-ALIAS-FOUND          PIC X  VALUE 'N'.                CG221205
               88  ALIAS-FOUND                VALUE 'Y'.                CG221205
               88  ALIAS-NOT-FOUND            VALUE 'N'.                CG221205
           05  WS-LOGMSG-ON            PIC X  VALUE 'N'.                CG221205
               88  LOGMSG                     VALUE 'Y'.                CG221205
           05  WS-LOGMSG-STATUS        PIC X  VALUE 'N'.                CG221205
               88  LOGMSG-STATUS              VALUE 'Y'.                CG221205
           05 WS-MESSAGE-RECORD.                                        CG221205
              10 WS-MESSAGE-DATA      PIC X(218) VALUE SPACES.          CG221205
              10 WS-MESSAGE-STATUS    PIC X(04)  VALUE SPACES.          CG221205
           05  WS-GET-FREIGHT-FLAG     PIC X  VALUE SPACE.              CG200506
               88  WS-GET-FP-YES              VALUE 'Y'.                CG200506
               88  WS-GET-FP-NO               VALUE 'N'.                CG200506
054404 COPY DNWMC830.                                                           
054600 EJECT                                                                    
054700********************************************************                  
054800*   Q U E U E     R E C O R D S                        *                  
054900********************************************************                  
055000                                                                          
055100 01  WS-QUEUES.                                                           
055200     05  WICSINBD-QUEUE-REC.                                              
055300         10  WICSINBD-DBNAME          PIC X(08) VALUE SPACES.             
055400         10  END-BYTE                 PIC X(01) VALUE SPACES.             
055500                                                                          
      ****************************************************************  CG030211
      *   W O R K   R E C O R D  F O R  C U R R E N C Y   M O D U L E   CG030211
      ****************************************************************  CG030211
                                                                        CG030211
       01  AOWMW007.                                                    CG030211
           05  LOAD-NUMBER                  PIC X(06) VALUE SPACES.     CG030211
           05  FREIGHT-CHARGE-AMT           PIC S9(11)V99  COMP-3       CG030211
                                                      VALUE ZEROES.     CG030211
           05  OCEAN-FREIGHT-AMT            PIC S9(11)V99  COMP-3       CG030211
                                                      VALUE ZEROES.     CG030211
           05  INSURED-AMT                  PIC S9(13)V99  COMP-3       CG030211
                                                      VALUE ZEROES.     CG030211
           05  ORDER-TYPE                   PIC X(01) VALUE SPACES.     CG030211
           05  CUSTOMER-NUMBER              PIC X(07) VALUE SPACES.     CG030211
           05  ERROR-MSG1                   PIC X(40) VALUE SPACES.     CG030211
           05  FILLER                       PIC X(04) VALUE SPACES.     CG030211
                                                                        CG030211
055600********************************************************                  
055700*   I D D      W O R K        R E C O R D S            *                  
055800********************************************************                  
055900                                                                          
056000 COPY IDMS ZIP-DEFAULT-DATA.                                      000018GT
056100 EJECT                                                                    
056101 COPY IDMS COEDUIV0-WORK3-RECORD.                                         
056102 EJECT                                                                    
056103 COPY IDMS AOBGW380.                                              000032LM
056104 EJECT                                                                    
056200 COPY IDMS WICSTRAN-REQUEST-BLOCK.                                        
056300 EJECT                                                                    
056400 COPY IDMS WICSTRAN-FUNCTION-VALUES.                                      
056500                                                                          
056600 EJECT                                                                    
056700********************************************************                  
056800*          D A T A B A S E    R E C O R D S            *                  
056900*             -   USED BY THIS PROGRAM ONLY -          *                  
057000********************************************************                  
057100                                                                          
057200                                                                          
057300 COPY IDMS LOAD.                                                          
057400 EJECT                                                                    
057500 COPY IDMS BILL-OF-LADING.                                                
057600 EJECT                                                                    
057500 COPY IDMS FREEFORM-ITEMS.                                        IM980924
057600 EJECT                                                            IM980924
057700 COPY IDMS SHIPMENT-HEADER.                                               
057800 EJECT                                                                    
057900 COPY IDMS COO-SPLIT.                                                     
058000 EJECT                                                                    
058100 COPY IDMS SHIPMENT-LINE.                                                 
058200 EJECT                                                                    
058100 COPY IDMS PART-SERIAL-NUM.                                               
058200 EJECT                                                                    
058300 COPY IDMS ROUTE.                                                         
058400 EJECT                                                                    
058500 COPY IDMS ROUTE-DETAILS.                                                 
058600 EJECT                                                                    
058700 COPY IDMS MASTER-BOL.                                                    
058800 EJECT                                                                    
058900 COPY IDMS TEXT-HEADER.                                                   
059000 EJECT                                                                    
059100 COPY IDMS TEXT-LINE.                                                     
059200 EJECT                                                                    
059300 COPY IDMS AR-INVOICE-HDR.                                                
059400 EJECT                                                                    
059410 COPY IDMS SHIP-TRACK-ID.                                         000030LM
059420 EJECT                                                                    
059500 COPY IDMS ORDER-HEADER.                                                  
059600 EJECT                                                                    
059700 COPY IDMS SALES-ORDER.                                                   
059800 EJECT                                                                    
059900 COPY IDMS SALES-ORDER-LINE.                                              
060000 EJECT                                                                    
060100 COPY IDMS VAS-LINE-ITEM.                                         CG031013
060200 EJECT                                                            CG031013
060100 COPY IDMS SO-LINE-SCHEDULE.                                              
060200 EJECT                                                                    
060300 COPY IDMS CUSTOMER.                                                      
060400 EJECT                                                                    
060500 COPY IDMS TABLE-HDR.                                                     
060600 EJECT                                                                    
060700 COPY IDMS TABLE-DETAIL.                                                  
060800 EJECT                                                                    
060900 COPY IDMS LS-INV-TRANS.                                                  
061000 EJECT                                                                    
061100 COPY IDMS PFO-SHIP-OOAK.                                                 
061200 EJECT                                                                    
061300 COPY IDMS PFO-SHIP-TRAN.                                                 
061400 EJECT                                                                    
061500 COPY IDMS PLANT-MASTER.                                                  
061600 EJECT                                                                    
061700 COPY IDMS CARRIER.                                                       
061710 EJECT                                                                    
061720 COPY IDMS WICS-LOADS.                                                    
061800 EJECT                                                                    
062003********************************************************                  
062004*          D A T A B A S E    R E C O R D S            *                  
062100*             -   USED BY LINKED TO PROGRAMS -         *                  
062200*             -   BUT BOUND AND AREAS READIED -        *                  
062300*             -   BY THIS PROGRAM.            -        *                  
062400********************************************************                  
062500*                                                                         
062600 COPY IDMS ADDRSS.                                                        
062700 EJECT                                                                    
062800 COPY IDMS ADDRSS-ID.                                                     
062900 EJECT                                                                    
063000 COPY IDMS BUSINESS.                                                      
063100 EJECT                                                                    
063200 COPY IDMS CAS-DEFINITION.                                                
063300 EJECT                                                                    
063400 COPY IDMS COE-DEFINITION.                                                
063500 EJECT                                                                    
063600 COPY IDMS COE-PLT-CONTROL.                                               
063700 EJECT                                                                    
063800 COPY IDMS CUSTOMER-TERMS.                                                
063900 EJECT                                                                    
064000 COPY IDMS DISC-BY-REMISE.                                                
064100 EJECT                                                                    
064200 COPY IDMS MESSAGE-DATA.                                                  
064300 EJECT                                                                    
064400 COPY IDMS MESSAGE-TYPE.                                                  
064500 EJECT                                                                    
064600 COPY IDMS MKT-PART.                                                      
064700 EJECT                                                                    
064800 COPY IDMS MKT-PLANT.                                                     
064900 EJECT                                                                    
065000 COPY IDMS NUMBER-MASK.                                                   
065100 EJECT                                                                    
065200 COPY IDMS PREFIX-MASK.                                                   
065300 EJECT                                                                    
065400 COPY IDMS SOHEXT.                                                        
065500 EJECT                                                                    
065510 COPY IDMS SOLEXT.                                                000024LD
065520 EJECT                                                                    
065521 COPY IDMS STBDNAR                                                000035DB
065522 EJECT                                                                    
065600 COPY IDMS UOM-FACTOR                                                     
065700 EJECT                                                                    
065800 COPY IDMS UOM-OOAK.                                                      
065900 EJECT                                                                    
066000 COPY IDMS VALID-UOM.                                                     
066100 EJECT                                                                    
3LO030 COPY IDMS TMS-SHPCAN-HDR.                                                
3LO030 EJECT                                                                    
3LO030 COPY IDMS TMS-SHPCAN-LINE.                                               
3LO030 EJECT                                                                    
066200 COPY IDMS SUBSCHEMA-CONTROL.                                             
066300 EJECT                                                                    
       COPY IDMS RECORD MKT-PART-PRICE.                                 CG050119
       COPY IDMS RECORD MKT-PART-JOINT.                                 CG050119
       COPY IDMS RECORD MKT-PLANT-PRICE.                                CG050119
       COPY IDMS RECORD MKT-PLANT-JOINT.                                CG050119
       COPY IDMS RECORD PRICE-TABLE.                                    CG050119
       COPY IDMS RECORD PRICE-EFFECTIVE.                                CG050119
       COPY IDMS RECORD PRICE-FACTOR.                                   CG050119
       COPY IDMS RECORD PRICE-DEFINITION.                               CG050119
       COPY IDMS RECORD BASE-PRICE-HSTRY.                               CG050119
       COPY IDMS RECORD CURRENCY-CONV.                                  CG050119
       COPY IDMS RECORD CURRENCY-FACTOR.                                CG050119
       COPY IDMS RECORD CUSTOMER-OPTION.                                CG050119
       COPY IDMS RECORD RAMPUP-TABLE.                                   CG221205
       COPY IDMS RECORD INV-TEXT-HDR.                                   CG221205
       COPY IDMS RECORD INV-TEXT-LINE.                                  CG221205
066400 LINKAGE SECTION.                                                         
066500 COPY IDMS WICSRECV-CONTROL-RECORD.                                       
066600 EJECT                                                                    
066700 PROCEDURE DIVISION USING WICSRECV-CONTROL-RECORD.                        
066800 0000000-MAINLINE.                                                        
066900*        ***********************************************                  
067000*        *          - INITIAL WICS SETUP -             *                  
067100*        *  INITIALIZE THIS PROGRAM WITH VALUES PASSED *                  
067200*        *  FROM DNWXP261 AND SETUP  THE WICS CONTROL  *                  
067300*        *  RECORD WITH PERTINENT DATA.                *                  
067400*        ***********************************************                  
067500                                                                          
067600     MOVE 'DNWMX830' TO WRB-PROGRAM-ID.                                   
067610     MOVE 'DNWMX830' TO WS-PROG-ID.                               000023LJ
067700     MOVE WCR-SOURCE-ID TO WRB-SOURCE-ID, SAVE-SHIP-FROM.                 
067800     MOVE WCR-SERIAL TO WRB-SERIAL.                                       
067900     MOVE LENGTH OF WSC-DATA-RECORD TO WRB-RECORD-LENGTH.                 
068000                                                                          
068100*        *********************************************                    
068200*        * BIND DATABASE.  SINCE THIS PROGRAM CALLS  *                    
068300*        * INVOICING WITH AN EXTENDED RUN UNIT, IT IS*                    
068400*        * BINDING THE RECORDS USED BY THIS PROGRAM  *                    
068500*        * AS WELL AS THOSE USED BY INVOICING.       *                    
068600*        *********************************************                    
068700     PERFORM 1000000-BIND-READY-DB THRU 1000000-EXIT.                     
068800                                                                          
068900*        *********************************************                    
069000*        * OBTAIN DATA ABOUT THE SHIP FROM SUCH AS   *                    
069100*        * WHETHER IT IS MICHELIN, UG, ON WICS, OR ON*                    
069200*        * WMS.                                      *                    
069300*        *********************************************                    
069400     MOVE SAVE-SHIP-FROM TO PLANT-CODE-005.                               
069500     OBTAIN CALC PLANT-MASTER                                             
069600       ON ANY-ERROR-STATUS                                                
069700          MOVE '038' TO WCR-ERROR-CODE                                    
069800          STRING ERROR-STATUS '-SHIP FROM PLANT MASTER '                  
069900            SAVE-SHIP-FROM  DELIMITED BY SIZE                             
070000              INTO WCR-ERROR-TEXT                                         
070100          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
069400     INITIALIZE WS-SHIP-FROM-SITE                                 CG200506
069400     MOVE PLANT-CODE-005 TO WS-SHIP-FROM-SITE                     CG200506
070200     MOVE PLANT-CO-CODE-005 TO SAVE-SHIP-FROM-COMPANY.                    
070300     MOVE WICS-FLAG-005 TO SAVE-SHIP-FROM-WICS-IND.                       
           IF GEODE-FLAG-005  = 'Y'                                     CG081124
              MOVE 'G'        TO SAVE-SHIP-FROM-WICS-IND                CG081124
           END-IF.                                                      CG081124
070300     MOVE PLANT-DESC-005 (1:3) TO WS-SHIP-FROM-DESC.              CG021001
      *        *********************************************            CG100106
      *        * TO CHECK SHIP FROM SITE PRESENCE IN THE   *            CG100106
      *        * EXCLUDINV TABLE.IF PRESNT,WMS INVOICE     *            CG100106
      *        * PRINTING PROCESS WILL BE SKIPPED FOR THE  *            CG100106
      *        * SHIPMENT                                  *            CG100106
      *        *********************************************            CG100106
           MOVE SPACES                 TO TABLE-KEY-8016.               CG100106
           MOVE 'N'                    TO WS-SOLOMON-PLANT.             CG100106
           MOVE 'SOLOMONDC'            TO TABLE-KEY-8016.               CG100106
           OBTAIN CALC TABLE-HDR                                        CG100106
           ON DB-REC-NOT-FOUND                                          CG100106
              CONTINUE                                                  CG100106
           END-IF.                                                      CG100106
           IF DB-STATUS-OK                                              CG100106
              MOVE SAVE-SHIP-FROM      TO ENTRY-CODE-8017               CG100106
              OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                     CG100106
                                       USING ENTRY-CODE-8017            CG100106
              ON DB-REC-NOT-FOUND                                       CG100106
                 NEXT SENTENCE                                          CG100106
              END-IF                                                    CG100106
              IF DB-STATUS-OK                                           CG100106
                 MOVE 'Y'              TO WS-SOLOMON-PLANT              CG100106
              END-IF                                                    CG100106
           END-IF.                                                      CG100106
                                                                        CG100106
070400                                                                          
070500*        *********************************************                    
070600*        * DNWXP261 PASSES ALL RECORDS ASSOCIATED    *                    
070700*        * WITH A SHIPMENT CONFIRMATION TRANSACTION  *                    
070800*        * SET.  WRB-END-OF-DATA SIGNALS THE END OF  *                    
070900*        * THE TRANSACTION SET.                      *                    
071000*        *********************************************                    
071100     PERFORM 1100000-PROCESS THRU 1100000-EXIT                            
071200       UNTIL WRB-END-OF-DATA.                                             
071300                                                                          
071400     FINISH.                                                              
071500     MOVE WFV-FINISHED TO WRB-FUNCTION.                                   
071600     TRANSFER 'DNWXP261' RETURN USING WICSTRAN-REQUEST-BLOCK      000028LM
071700                                      WSC-DATA-RECORD.                    
071800                                                                          
071900                                                                          
072000*        *********************************************                    
072100*        * WE DO NOT WANT OUR PROCESSING ON THE CORE *                    
072200*        * TO BE ABORTED DUE TO SET TIMER FOR PFO.   *                    
072300*        * THUS, COMMIT CORE DATABASE WORK BEFORE    *                    
072400*        * DOING THE SET TIMER.  THIS COMMIT SERVES  *                    
072500*        * A SECOND PURPOSE OF RELEASING LOCK ON     *                    
072600*        * PFO OOAK RECORD SO THE PFO TASK CAN GET IT*                    
072700*        * OK.                                       *                    
072800*        *********************************************                    
                                                                                
                                                                                
072900     IF EXEC-PFO                                                          
073000        SET TIMER START INTERVAL 1 SECONDS                                
073100          TASK CODE 'PFOSHPMT'                                            
073200            DATA FROM WCR-DB-NAME LENGTH 8.                               
073300                                                                          
073400                                                                          
073500                                                                          
073600                                                                          
073700     GOBACK.                                                              
073800 EJECT                                                                    
073900 1000000-BIND-READY-DB.                                                   
074000                                                                          
074100*        *********************************************                    
074200*        * MULTIPLE DATABASES EXIST IN THE DICTIONARY*                    
074300*        * THEREFORE, DNWXP261 MUST PASS TO THIS     *                    
074400*        * PROGRAM WHICH DATABASE IT NEEDS TO BIND.  *                    
074500*        *********************************************                    
074600                                                                          
074700     MOVE 'DNWMX830' TO PROGRAM-NAME.                                     
074800     BIND RUN-UNIT DBNAME WCR-DB-NAME.                                    
074900                                                                          
075000*        *********************************************                    
075100*        * BIND RECORDS USED BY THIS PROGRAM ONLY    *                    
075200*        *********************************************                    
075300*                                                                         
075400     BIND LOAD.                                                           
075500     BIND BILL-OF-LADING.                                                 
075500     BIND FREEFORM-ITEMS.                                         IM980924
075600     BIND SHIPMENT-HEADER.                                                
075700     BIND COO-SPLIT.                                                      
075800     BIND SHIPMENT-LINE.                                                  
075800     BIND PART-SERIAL-NUM.                                                
075900     BIND ROUTE.                                                          
076000     BIND ROUTE-DETAILS.                                                  
076100     BIND MASTER-BOL.                                                     
076200     BIND TEXT-HEADER.                                                    
076300     BIND TEXT-LINE.                                                      
076400     BIND AR-INVOICE-HDR.                                                 
076410     BIND SHIP-TRACK-ID.                                          000030LM
076500     BIND ORDER-HEADER.                                                   
076600     BIND SALES-ORDER.                                                    
076700     BIND SALES-ORDER-LINE.                                               
076800     BIND SO-LINE-SCHEDULE.                                               
076800     BIND VAS-LINE-ITEM.                                          CG031013
076900     BIND LS-INV-TRANS.                                                   
077000     BIND TABLE-HDR.                                                      
077100     BIND TABLE-DETAIL.                                                   
077200     BIND PFO-SHIP-OOAK.                                                  
077300     BIND PFO-SHIP-TRAN.                                                  
077400     BIND PLANT-MASTER.                                                   
077500     BIND CARRIER.                                                        
077510     BIND WICS-LOADS.                                                     
077600                                                                          
077700*        *********************************************                    
077800*        * BIND RECORDS USED BY LOWER LEVEL PROGRAMS *                    
077900*        *********************************************                    
078000     BIND CUSTOMER.                                                       
078100     BIND ADDRSS.                                                         
078200     BIND ADDRSS-ID.                                                      
078300     BIND BUSINESS.                                                       
078400     BIND CAS-DEFINITION.                                                 
078500     BIND COE-DEFINITION.                                                 
078600     BIND COE-PLT-CONTROL.                                                
078700     BIND CUSTOMER-TERMS.                                                 
078800     BIND DISC-BY-REMISE.                                                 
078900     BIND MESSAGE-DATA.                                                   
079000     BIND MESSAGE-TYPE.                                                   
079100     BIND MKT-PART.                                                       
079200     BIND MKT-PLANT.                                                      
079300     BIND NUMBER-MASK.                                                    
079400     BIND PREFIX-MASK.                                                    
079500     BIND SOHEXT.                                                         
079510     BIND SOLEXT.                                                 000024LD
079520     BIND STBDNAR.                                                000035DB
079600     BIND UOM-FACTOR                                                      
079700     BIND UOM-OOAK.                                                       
079800     BIND VALID-UOM.                                                      
3LO030     BIND TMS-SHPCAN-HDR.                                                 
3LO030     BIND TMS-SHPCAN-LINE.                                                
           BIND MKT-PART-PRICE.                                         CG050119
           BIND MKT-PART-JOINT.                                         CG050119
           BIND MKT-PLANT-PRICE.                                        CG050119
           BIND MKT-PLANT-JOINT.                                        CG050119
           BIND PRICE-TABLE.                                            CG050119
           BIND PRICE-EFFECTIVE.                                        CG050119
           BIND PRICE-FACTOR.                                           CG050119
           BIND PRICE-DEFINITION.                                       CG050119
           BIND BASE-PRICE-HSTRY.                                       CG050119
           BIND CURRENCY-CONV.                                          CG050119
           BIND CURRENCY-FACTOR.                                        CG050119
           BIND CUSTOMER-OPTION.                                        CG050119
           BIND RAMPUP-TABLE.                                           CG221205
           BIND INV-TEXT-HDR.                                           CG221205
           BIND INV-TEXT-LINE.                                          CG221205
079900 EJECT                                                                    
080200*        *********************************************                    
080300*        * READY AREAS USED BY THIS PROGRAM ONLY     *                    
080400*        *********************************************                    
080500     READY MTC-ROUTE-AREA USAGE-MODE IS UPDATE.                           
080600     READY MICH-LSINVT-AREA USAGE-MODE IS UPDATE.                         
080700     READY MICH-PFOSHP-AREA USAGE-MODE IS UPDATE.                         
080710     READY MICH-WICSLD-AREA USAGE-MODE IS UPDATE.                         
080800                                                                          
080900*        *********************************************                    
081000*        * READY AREAS USED LOWER LEVEL PROGRAM      *                    
081100*        *********************************************                    
081200*                                                                         
081300     READY CAS-AR-PAY-AREA  USAGE-MODE IS UPDATE.                         
081400     READY CAS-BOM-AREA     USAGE-MODE IS RETRIEVAL.                      
081500     READY CAS-BUS-AREA     USAGE-MODE IS UPDATE.                         
081600     READY CAS-CARAUD-AREA  USAGE-MODE IS UPDATE.                         
081700     READY CAS-COEAUD-AREA  USAGE-MODE IS UPDATE.                         
081800     READY CAS-CPRAUD-AREA  USAGE-MODE IS UPDATE.                         
081900     READY CAS-CUST-AREA    USAGE-MODE IS UPDATE.                         
082000     READY CAS-IXCUST-AREA  USAGE-MODE IS RETRIEVAL.                      
082100     READY CAS-IXMESS-AREA  USAGE-MODE IS UPDATE .                        
082300     READY CAS-IXRI-AREA    USAGE-MODE IS UPDATE.                         
082200     READY CAS-IXSALES-AREA USAGE-MODE IS UPDATE.                         
082400     READY CAS-IXTEXT-AREA  USAGE-MODE IS UPDATE.                         
082500     READY CAS-MRP-AREA     USAGE-MODE IS UPDATE.                         
082600     READY CAS-OE-ORD-AREA  USAGE-MODE IS UPDATE.                         
082700     READY CAS-ORD-AREA     USAGE-MODE IS UPDATE.                         
082800     READY CAS-PLANT-AREA   USAGE-MODE IS RETRIEVAL.                      
082900     READY CAS-PRICE-AREA   USAGE-MODE IS UPDATE.                         
083000     READY CAS-SYS-AREA     USAGE-MODE IS UPDATE.                         
100700     READY CAS-IXNMASK-AREA USAGE-MODE IS UPDATE.                 CG021211
083100     READY CAS-TAX-AREA     USAGE-MODE IS RETRIEVAL.                      
083200     READY CAS-TAX-AUD-AREA USAGE-MODE IS UPDATE.                         
083300     READY CAS-TEXT-AREA    USAGE-MODE IS UPDATE.                         
082610     READY MICH-ARINV-AREA  USAGE-MODE IS UPDATE.                         
083400     READY MICH-CUST-AREA   USAGE-MODE IS RETRIEVAL.                      
083500     READY MICH-INVXRF-AREA USAGE-MODE IS UPDATE.                         
084200     READY MICH-IXCSPL-AREA USAGE-MODE IS UPDATE.                         
083600     READY MICH-IXPLAN-AREA USAGE-MODE IS RETRIEVAL.                      
084200     READY MICH-IXRVPO-AREA USAGE-MODE IS UPDATE.                 C03407  
084422     READY MICH-IXSIZE-AREA USAGE-MODE IS UPDATE.                 000035DB
084300     READY MICH-IXXCUD-AREA USAGE-MODE IS UPDATE.                 INVNDX  
084400     READY MICH-IXXCUT-AREA USAGE-MODE IS UPDATE.                 INVNDX  
083700     READY MICH-OEPRTP-AREA USAGE-MODE IS UPDATE.                         
084420     READY MICH-RISIX-AREA  USAGE-MODE IS UPDATE.                 000029LM
083800     READY MICH-TABLE-AREA  USAGE-MODE IS UPDATE.                         
084421     READY MICH-UPN-AREA    USAGE-MODE IS UPDATE.                 000035DB
084410     READY MICH-ZIPPLT-AREA USAGE-MODE IS RETRIEVAL.              000018GT
084000     READY MTC-PART-AREA    USAGE-MODE IS RETRIEVAL.                      
083900     READY MTC-TABLE-AREA   USAGE-MODE IS UPDATE.                         
3LO030     READY MICH-TMSTRN-AREA USAGE-MODE IS UPDATE.                         
           READY MICH-CUSOPT-AREA USAGE-MODE IS RETRIEVAL.              CG050119
           READY MICH-RAMP-AREA   USAGE-MODE IS RETRIEVAL.              CG221205
           READY MICH-INVTXT-AREA USAGE-MODE IS UPDATE.                 CG221205
                                                                                
           MOVE FUNCTION CURRENT-DATE (1:8) TO SAVE-DATE-W-CC.          IM000331
           MOVE FUNCTION CURRENT-DATE (9:8) TO SAVE-TIME.                       
           MOVE 'LOGMSG'                    TO TABLE-KEY-8016.          CG221205
           MOVE 'N'                         TO WS-LOGMSG-ON.            CG221205
           MOVE 'N'                         TO WS-LOGMSG-STATUS.        CG221205
           OBTAIN CALC TABLE-HDR                                        CG221205
           ON DB-REC-NOT-FOUND                                          CG221205
              GO TO 1000000-EXIT                                        CG221205
           END-IF.                                                      CG221205
           IF DB-STATUS-OK                                              CG221205
              MOVE SPACES                   TO ENTRY-CODE-8017          CG221205
              MOVE 'DNWMX830'               TO ENTRY-CODE-8017          CG221205
              OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                     CG221205
                                  USING ENTRY-CODE-8017                 CG221205
              ON DB-REC-NOT-FOUND                                       CG221205
                 CONTINUE                                               CG221205
              END-IF                                                    CG221205
              IF DB-STATUS-OK                                           CG221205
              AND TABLE-DETAIL-DATA-8017(1:1) = 'Y'                     CG221205
                 MOVE 'Y'                   TO WS-LOGMSG-ON             CG221205
              END-IF                                                    CG221205
              IF DB-STATUS-OK                                           CG221205
              AND TABLE-DETAIL-DATA-8017(2:1) = 'Y'                     CG221205
                 MOVE 'Y'                   TO  WS-LOGMSG-STATUS        CG221205
              END-IF                                                    CG221205
           END-IF.                                                      CG221205
                                                                                
085300 1000000-EXIT. EXIT.                                                      
085500 EJECT                                                                    
085600***************************************************************           
085700*   PROCESS AN ENTIRE TRANSACTION SET; 1 TRANSACTION SET PER  *           
085800*   LOAD.                                                     *           
085900***************************************************************           
086000 1100000-PROCESS.                                                         
086100     INITIALIZE WSC-DATA-RECORD.                                          
086200                                                                          
086300     IF FIRST-TIME                                                        
086400        MOVE 'N' TO SW-FIRST-TIME                                         
086500        MOVE WFV-GET-FIRST-RECORD TO WRB-FUNCTION                         
086600     ELSE                                                                 
086700        MOVE WFV-GET-NEXT-RECORD TO WRB-FUNCTION.                         
086800                                                                          
086900     TRANSFER 'DNWXP261' RETURN USING WICSTRAN-REQUEST-BLOCK      000028LM
087000                                      WSC-DATA-RECORD.                    
087100     IF NOT WRB-END-OF-DATA                                               
087200        PERFORM WICSTRAN-STATUS                                           
087300     ELSE                                                                 
087400        GO TO 1100000-EXIT.                                               
087500                                                                          
087600**              *--------------------------*                              
087700**              *     DEBUG ITEMS          *                              
087800**              *--------------------------*                              
087900**   MOVE '  ***** WRB  RECORD:     ****  ' TO DEBUG-SNAP                 
088000*     SNAP TITLE IS DEBUG-SNAP FROM WICSTRAN-REQUEST-BLOCK                
088100*       LENGTH 100.                                                       
088200*    MOVE '  ***** DATA RECORD:     ****  ' TO DEBUG-SNAP                 
088300*     SNAP TITLE IS DEBUG-SNAP FROM WSC-DATA-RECORD                       
088400*       LENGTH 100.                                                       
2SP160*          STRING " 2SP160 => STAT> ", WRB-TRANS-TYPE                     
2SP160*          DELIMITED BY SIZE INTO DEBUG-SNAP                              
2SP160*          SNAP TITLE IS DEBUG-SNAP FROM WSC-DATA-RECORD                  
2SP160*          LENGTH 100.                                                    
088500                                                                          
088600     EVALUATE WRB-TRANS-TYPE                                              
088700       WHEN '01'                                                          
3LO030          INITIALIZE TMS-REC-ELEMENTS                                     
088800          MOVE WSC-DATA-RECORD TO WSC-LOAD-DATA                           
088900          PERFORM 1110000-PROCESS-LOAD THRU 1110000-EXIT                  
089000       WHEN '02'                                                          
3LO030          INITIALIZE TMS-REC-02 TMS-REC-03 TMS-REC-04                     
089100          MOVE WSC-DATA-RECORD TO WSC-BOL-DATA                            
089200          PERFORM 1120000-PROCESS-BOL THRU 1120000-EXIT                   
089200          SET WS-IFNUM-SWAP-NO TO TRUE                            CG200506
089300       WHEN '03'                                                          
3LO030          INITIALIZE TMS-REC-03 TMS-REC-04                                
089400          MOVE WSC-DATA-RECORD TO WSC-SHIP-HDR-DATA                       
089500          MOVE 'Y' TO SW-ZERO-SHIP-HDR                                    
089600          PERFORM 1130000-PROCESS-SHIP-HDR THRU 1130000-EXIT              
089700          MOVE 000 TO WORK-SHIP-LINE                                      
089800       WHEN '04'                                                          
089900          MOVE WSC-DATA-RECORD TO WSC-PART-DATA                           
090000          PERFORM 1140000-PROCESS-LINE THRU 1140000-EXIT                  
090100       WHEN '99'                                                          
      ******    THE BELOW COMMENT WILL BE REMOVED WHEN 3LO071           CG031027
      ******    GOES INTO PRODUCTION IN APRIL 2004.                     CG031027
      *         PERFORM 1133300-SUBMIT-JCL THRU 1133300-EXIT            CG031027
090200          IF WS-PUSH-LOAD-YES                                     CG200506
                    STRING 'BOL' DELIMITED BY SPACES                    CG200506
                           WS-LOAD-ID-SHORT DELIMITED BY SPACES         CG200506
                           INTO TABLE-KEY-8016                          CG200506
                    END-STRING                                          CG200506
                                                                        CG200506
                    OBTAIN CALC TABLE-HDR                               CG200506
                    ON ANY-ERROR-STATUS                                 CG200506
                       CONTINUE                                         CG200506
                    END-IF                                              CG200506
                                                                        CG200506
                    IF DB-REC-NOT-FOUND                                 CG200506
                       CONTINUE                                         CG200506
                    ELSE                                                CG200506
                       IF DB-STATUS-OK                                  CG200506
                          ERASE TABLE-HDR ALL MEMBERS                   CG200506
                          ON DB-STATUS-OK                               CG200506
                             CONTINUE                                   CG200506
                          END-IF                                        CG200506
                       ELSE                                             CG200506
                           MOVE '119' TO WCR-ERROR-CODE                 CG200506
                           STRING ERROR-STATUS                          CG200506
                                  ' DURING-ER-OF-UNIT-TBL '             CG200506
                                  WSC-BOL DELIMITED BY SPACES           CG200506
                                  INTO WCR-ERROR-TEXT                   CG200506
                           END-STRING                                   CG200506
                           PERFORM 9999999-ABORT THRU 9999999-EXIT      CG200506
                       END-IF                                           CG200506
                    END-IF                                              CG200506
090200          END-IF                                                  CG200506
090200          GO TO 1100000-EXIT                                              
090300       WHEN OTHER                                                         
090400          MOVE '001' TO WCR-ERROR-CODE                                    
090500          STRING 'INVALID TRANS TYPE ENCOUNTERED: '                       
090600            WRB-TRANS-TYPE DELIMITED BY SIZE INTO                         
090700            WCR-ERROR-TEXT                                                
090800          PERFORM 9999999-ABORT THRU 9999999-EXIT                         
090900     END-EVALUATE.                                                        
091000                                                                          
091100 1100000-EXIT. EXIT.                                                      
091200 EJECT                                                                    
091300****************************************************************          
091400*        *********************************************         *          
091500*        *  - SHIPMENT CONFIRMATION TRAN TYPE 01 -   *         *          
091600*        *********************************************         *          
091700****************************************************************          
091800 1110000-PROCESS-LOAD.                                                    
091900                                                                          
092000*        *********************************************                    
092100*        * WICS DOES NOT HAVE LOAD NUMBERS IN ITS    *                    
092200*        * SYSTEM; THEREFORE, IT MUST BE GENERATED   *                    
092300*        *********************************************                    
092400     MOVE 'WICSLD' TO NUMBER-TYPE-4010.                                   
092500                                                                          
092600     OBTAIN KEEP EXCLUSIVE CALC NUMBER-MASK                               
092700       ON ANY-ERROR-STATUS                                                
092800          NEXT SENTENCE.                                                  
092900                                                                          
093000     IF DB-REC-NOT-FOUND                                                  
093100        MOVE '002' TO WCR-ERROR-CODE                                      
093200        MOVE '"WICSLD" NUMBER MASK NOT FOUND'                             
093300          TO WCR-ERROR-TEXT                                               
093400        PERFORM 9999999-ABORT THRU 9999999-EXIT                           
093500     ELSE                                                                 
093600        IF NOT DB-STATUS-OK                                               
093700           MOVE '003' TO WCR-ERROR-CODE                                   
093800           STRING ERROR-STATUS '-OBTAINING "WICSLD" NUMBER MASK'          
093900             DELIMITED BY SIZE INTO WCR-ERROR-TEXT                        
094000           PERFORM 9999999-ABORT THRU 9999999-EXIT.                       
094100                                                                          
094110                                                                          
094200     MOVE MASK-4010 TO WORK-LOAD-RANGES-X.                                
094501     MOVE ZERO TO CNT-LOAD-NBRS-TRIED.                            000022LD
094502     MOVE 'N' TO SW-LOAD-REC-STORED.                              000022LD
094503*        *********************************************                    
094504*        * STORE LOAD USING THE DATA SENT IN THE     *                    
094505*        * "01" TRANS RECORD.                        *                    
094506*        * FOR WICS, THE PRIMARY CARRIER AND SCAC ARE*                    
094507*        * ALWAYS THE SAME.  SECONDARY CARRIER IS    *                    
094508*        * ALWAYS BLANK.                             *                    
094509*        *********************************************                    
094510                                                                          
094511     INITIALIZE LOAD.                                                     
094513     MOVE WSC-PRIMARY-CARRIER TO PRIMARY-CARRIER-8009                     
3LO030                                 TMS-SCAC.                                
094514     MOVE WSC-SEALS TO CARRIER-SEALS-8009.                                
094515     MOVE WSC-LOAD-TEND-IND TO LOAD-TEND-IND-8009.                C02855  
094516     MOVE WSC-SHIP-DATE TO WORK-SHIP-DATE                                 
3LO030                           TMS-SHIP-DATE.                                 
094517     MOVE SHIP-DATE-YMD TO ACTUAL-SHIP-DATE-8009.                         
           IF WSC-SHIP-TIME IS EQUAL TO SPACES                          CG151007
              MOVE '100' TO WCR-ERROR-CODE                              CG151007
              STRING 'SHIP TIME RECEIVED IS SPACES'                     CG151007
              DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                    CG151007
              PERFORM 9999999-ABORT THRU 9999999-EXIT                   CG151007
           ELSE                                                         CG151007
              MOVE WSC-SHIP-TIME TO ACTUAL-SHIP-TIME-8009               CG151007
           END-IF                                                       CG151007
           MOVE WSC-SHIP-DATE          TO PLAND-SHIP-DATE-8009.         CG070419
094522     MOVE 'L' TO LOAD-STATUS-8009.                                        
094522     MOVE WSC-EQUIPMENT-TYPE  TO EQUIPMENT-TYPE-8009              IM980924
3LO030                                 TMS-EQUIPMENT-TYPE.                      
           MOVE SPACES TO PORT-OF-DEPARTURE-8009.                       IM990524
           IF WSC-PORT-OF-DEP NOT EQUAL SPACES AND                      IM990524
              WSC-PORT-OF-DEP NOT EQUAL '0000'                          IM990524
              MOVE 'PORTOFDEP' TO TABLE-KEY-8016                        IM990524
              OBTAIN CALC TABLE-HDR                                     IM990524
              ON DB-REC-NOT-FOUND                                       IM990524
                 MOVE '035' TO WCR-ERROR-CODE                           IM990524
                 MOVE '"PORTOFDEP" TABLE-HDR NOT FOUND'                 IM990524
                     TO WCR-ERROR-TEXT                                  IM990524
                 PERFORM 9999999-ABORT THRU 9999999-EXIT                IM990524
              END-IF                                                    IM990524
              IF DB-STATUS-OK                                           IM990524
                 MOVE WSC-PORT-OF-DEP TO ENTRY-CODE-8017                IM990524
                 OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                  IM990524
                        USING ENTRY-CODE-8017                           IM990524
                 ON DB-REC-NOT-FOUND                                    IM990524
                    MOVE '036' TO WCR-ERROR-CODE                        IM990524
                    MOVE '"PORTOFDEP" TABLE-DETAIL NOT FOUND'           IM990524
                         TO WCR-ERROR-TEXT                              IM990524
                    PERFORM 9999999-ABORT THRU 9999999-EXIT             IM990524
                 END-IF                                                 IM990524
                 IF DB-STATUS-OK                                        IM990524
                    MOVE WSC-PORT-OF-DEP TO PORT-OF-DEPARTURE-8009      IM990524
                 END-IF                                                 IM990524
              END-IF                                                    IM990524
           END-IF                                                       IM990524
094523     MOVE WSC-ROUTE-CODE TO ROUTE-CODE-8009.                              
094524     MOVE WSC-SHIP-MODE TO MODE-8009.                                     
094525     MOVE WSC-ROUTE-OPTION TO ROUTE-OPTIONS-8009.                         
094526     MOVE WSC-SCAC TO STD-CARR-ALPHA-CODE-8009.                           
094527     MOVE WSC-CONTAINER TO CONTAINER-ID-8009.                             
094528     MOVE WSC-SEC-CARRIER TO SECONDARY-CARRIER-8009.                      
094529     PERFORM 1111000-STORE-LOAD THRU 1111000-EXIT                 000022LD
094530         UNTIL LOAD-REC-STORED OR                                 000022LD
094531               CNT-LOAD-NBRS-TRIED > 99.                          000022LD
094532     IF LOAD-REC-STORED                                           000022LD
094533         MOVE LOAD-NUMBER-8009 TO WS-LOAD-NUMBER                  000023LJ
094534         FIND CURRENT NUMBER-MASK                                 000022LD
094535         MODIFY NUMBER-MASK                                       000022LD
094536           ON ANY-ERROR-STATUS                                    000022LD
094537             MOVE '004' TO WCR-ERROR-CODE                         000022LD
094538             STRING ERROR-STATUS                                  000022LD
094539                    '-MODIFYING "WICSLD" NUMBER MASK'             000022LD
094540               DELIMITED BY SIZE INTO WCR-ERROR-TEXT              000022LD
094541             PERFORM 9999999-ABORT THRU 9999999-EXIT.             000022LD
094542     IF CNT-LOAD-NBRS-TRIED > 99                                  000022LD
094550       MOVE '080' TO WCR-ERROR-CODE                               000022LD
094560       STRING 'MORE THAN 100 LOAD NBRS TRIED: '                   000022LD
094570              LAST-NUMBER-GENERATED-4010                          000022LD
094580         DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    000022LD
094590       PERFORM 9999999-ABORT THRU 9999999-EXIT.                   000022LD
094600                                                                          
094610*        *********************************************            000025LD
094620*        * SAVE BORDER EXIT POINT TO STORE ON        *            000025LD
094630*        * SHIPMENT-HEADER RECORDS.                  *            000025LD
094650*        *********************************************            000025LD
094660                                                                          
094700     MOVE WSC-BORDER-EXIT-PT TO SAVE-BORDER-EXIT-PT.              000025LD
095300                                                                          
098400 EJECT                                                                    
098500*        *********************************************                    
098600*        *                                           *                    
098700*        * ROUTE-DETAILS HANGING OFF OF THE LOAD ARE *                    
098800*        * OPTIONAL.                                 *                    
098900*        * THE ROUTE-DETAILS RECORD CONTAINS THE     *                    
099000*        * FOLLOWING DATA FOR INVOICING TO PICK UP.  *                    
099100*        *   - FORWARDING AGENT                      *                    
099200*        *   - PORT OF DISCHARGE                     *                    
099300*        *   - CONTRACT NUMBER                       *                    
099400*        *********************************************                    
099500                                                                          
099600     IF WSC-ROUTE-DETAILS = SPACES                                        
099700        NEXT SENTENCE                                                     
099800     ELSE                                                                 
099900        MOVE WSC-ROUTE-DETAILS TO ROUTE-DETAILS                           
100000        STORE ROUTE-DETAILS                                               
100100          ON ANY-ERROR-STATUS                                             
100200             MOVE '006' TO WCR-ERROR-CODE                                 
100300             STRING ERROR-STATUS '-STORING ROUTE-DETAILS'                 
100400               DELIMITED BY SIZE INTO WCR-ERROR-TEXT                      
100500             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
100600                                                                          
100700                                                                          
100800*        *********************************************                    
100900*        *      WSC-ROUTE-CODE                       *                    
101000*        * WICS DOES NOT USE TRR; THEREFORE, THIS    *                    
101100*        * ROUTE CAN ONLY BE ONE YOU USE TO STORE    *                    
101200*        * "ROUTE" TABLE.                            *                    
101300*        * THE "ROUTE" TABLE RECORD CONTAINS THE     *                    
101400*        * FOLLOWING DATA FOR INVOICING TO PICK UP.  *                    
101500*        *   - ROUTE COMMENTS                        *                    
101600*        *   - BORDER EXIT POINT                     *                    
101700*        *   - CUSTOMS BROKER ID                     *                    
101800*        * WICS DOES NOT HAVE A METHOD YET FOR       *                    
101900*        * CAPTURING THE ROUTE INFORMATION.          *                    
102000*        *********************************************                    
102100                                                                          
102200 EJECT                                                                    
102300*        *********************************************                    
102400*        * STORE MASTER-BOL IF ONE EXISTS            *                    
102500*        * WICS DOES NOT REQUIRE A MBOL EVEN WHEN    *                    
102600*        * THERE IS A MULTI STOP LOAD; THAT IS, WICS *                    
102700*        * MAY HAVE MULTIPLE BOLS ON A LOAD BUT NOT A*                    
102800*        * MASTER-BOL.                               *                    
102900*        *********************************************                    
103000                                                                          
103100     IF WSC-MBOL NOT = SPACES                                             
103200        INITIALIZE MASTER-BOL                                             
103300        MOVE WSC-MBOL TO MASTER-BOL                                       
3LO030                         TMS-MBOL                                         
103400        STORE MASTER-BOL                                                  
103500          ON ANY-ERROR-STATUS                                             
103600             MOVE '007' TO WCR-ERROR-CODE                                 
103700             STRING ERROR-STATUS '-STORING MASTER BOL '                   
103800                    WSC-MBOL                                              
103900               DELIMITED BY SIZE INTO WCR-ERROR-TEXT                      
104000             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
104200 EJECT                                                                    
104300*        *********************************************                    
104400*        * EVERY LOAD PROCESSED THROUGH              *                    
104500*        * THIS PROGRAM MUST BE STORED IN THE        *                    
104600*        * "TRIMSHP830" TBL.  THE TRIMS EXTRACT THAT *                    
104700*        * RUNS NIGHTLY WILL PROCESS THE LOADS IN    *                    
104800*        * THIS TABLE AND THEN DELETE THEM.  IF THE  *                    
104900*        * LOAD IS CANCELLED PRIOR TO THE BATCH RUN, *                    
105000*        * THE ENTRY FOR THE LOAD IN THIS TABLE      *                    
105100*        * SHOULD BE DELETED SO TRIMS DOES NOT GET.  *                    
105200*        *********************************************                    
105300                                                                          
105400     INITIALIZE TABLE-HDR.                                                
105500     MOVE 'TRIMSHP830' TO TABLE-KEY-8016.                                 
105600     FIND KEEP EXCLUSIVE CALC TABLE-HDR                                   
105700       ON ANY-ERROR-STATUS                                                
105800          NEXT SENTENCE.                                                  
105900                                                                          
106000     IF DB-REC-NOT-FOUND                                                  
106100        STORE TABLE-HDR                                                   
106200          ON ANY-ERROR-STATUS                                             
106300             MOVE '052' TO WCR-ERROR-CODE                                 
106400             STRING ERROR-STATUS '-STORE "TRIMSHP830" TABLE HDR '         
106500                LOAD-NUMBER-8009 DELIMITED BY SIZE INTO                   
106600                   WCR-ERROR-TEXT                                         
106700             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
106800                                                                          
106900     IF NOT DB-STATUS-OK                                                  
107000        MOVE '053' TO WCR-ERROR-CODE                                      
107100        STRING ERROR-STATUS '-OBTAIN "TRIMSHP830" TABLE-HDR '             
107200          LOAD-NUMBER-8009 DELIMITED BY SIZE INTO                         
107300             WCR-ERROR-TEXT                                               
107400        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
107500                                                                          
107600     INITIALIZE TABLE-DETAIL.                                             
107700     MOVE LOAD-NUMBER-8009 TO ENTRY-CODE-8017.                            
107800     MOVE SAVE-DATE TO TABLE-DETAIL-DATA-8017.                            
107900     STORE TABLE-DETAIL                                                   
108000       ON ANY-ERROR-STATUS                                                
108100          MOVE '054' TO WCR-ERROR-CODE                                    
108200          STRING ERROR-STATUS '- STORE "TRIMSHP830" TABLE DETAIL '        
108300            LOAD-NUMBER-8009 DELIMITED BY SIZE INTO                       
108400               WCR-ERROR-TEXT                                             
108500          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
108600                                                                          
108700      IF WSC-LOAD-TEND-IND > SPACES                                       
108800         PERFORM 111A000-STORE-WICSEBOL-TABLE                             
108801            THRU 111A000-EXIT.                                            
108802 1110000-EXIT. EXIT.                                                      
108803 111A000-STORE-WICSEBOL-TABLE.                                            
108804     INITIALIZE TABLE-HDR.                                          C02855
108805     MOVE 'WICSEBOL  ' TO TABLE-KEY-8016.                           C02855
108806     FIND KEEP EXCLUSIVE CALC TABLE-HDR                             C02855
108807       ON ANY-ERROR-STATUS                                          C02855
108808          NEXT SENTENCE.                                            C02855
108809                                                                          
108810     IF DB-REC-NOT-FOUND                                                  
108811        STORE TABLE-HDR                                             C02855
108812          ON ANY-ERROR-STATUS                                       C02855
108813             MOVE '052' TO WCR-ERROR-CODE                           C02855
108814             STRING ERROR-STATUS '-STORE "WICSEBOL" TABLE HDR '     C02855
108815                LOAD-NUMBER-8009 DELIMITED BY SIZE INTO             C02855
108816                   WCR-ERROR-TEXT                                   C02855
108817             PERFORM 9999999-ABORT THRU 9999999-EXIT.               C02855
108818                                                                          
108819     IF NOT DB-STATUS-OK                                            C02855
108820        MOVE '053' TO WCR-ERROR-CODE                                C02855
108821        STRING ERROR-STATUS '-OBTAIN "WICSEBOL" TABLE-HDR '         C02855
108822          LOAD-NUMBER-8009 DELIMITED BY SIZE INTO                   C02855
108823             WCR-ERROR-TEXT                                         C02855
108824        PERFORM 9999999-ABORT THRU 9999999-EXIT.                    C02855
108825                                                                          
108826     INITIALIZE TABLE-DETAIL.                                       C02855
108827     MOVE LOAD-NUMBER-8009 TO ENTRY-CODE-8017.                      C02855
108828     MOVE SPACES TO TABLE-DETAIL-DATA-8017.                               
108829     STORE TABLE-DETAIL                                             C02855
108830       ON ANY-ERROR-STATUS                                          C02855
108831          MOVE '054' TO WCR-ERROR-CODE                              C02855
108832          STRING ERROR-STATUS '- STORE "WICSEBOL" TABLE DETAIL '    C02855
108833            LOAD-NUMBER-8009 DELIMITED BY SIZE INTO                 C02855
108834               WCR-ERROR-TEXT                                       C02855
108835          PERFORM 9999999-ABORT THRU 9999999-EXIT.                  C02855
108836 111A000-EXIT. EXIT.                                                      
108837 EJECT                                                                    
108838 1111000-STORE-LOAD.                                              000022LD
108839                                                                          
108840*        *********************************************            000022LD
108841*        * STORE LOAD USING THE CURRENT NUMBER       *            000022LD
108842*        * GENERATED.  IF NO ERROR, OK.  IF A '1205' *            000022LD
108843*        * (DUPLICATE CALC KEY) ERROR OCCURS, TRY THE*            000022LD
108844*        * NEXT SEQUENTIAL NUMBER.  IF SOME OTHER    *            000022LD
108845*        * IDMS ERROR OCCURS, ABEND.  WILL TRY UP TO *            000022LD
108846*        * 100 SEQUENTIAL NUMBERS.  IF THE LOAD STILL*            000022LD
108847*        * IS NOT STORED, ABEND (IN 1110000 SECTION).*            000022LD
108848*        *********************************************            000022LD
108849                                                                          
108850     ADD 1 TO CNT-LOAD-NBRS-TRIED.                                000022LD
108851     IF LAST-NUMBER-GENERATED-4010 = HIGH-LOAD-RANGE              000022LD
108852        MOVE LOW-LOAD-RANGE TO LAST-NUMBER-GENERATED-4010.        000022LD
108853     ADD 1 TO LAST-NUMBER-GENERATED-4010.                         000022LD
108854                                                                          
108855     MOVE LAST-NUMBER-GENERATED-4010 TO LOAD-NUMBER-8009.         000022LD
108856     STORE LOAD                                                   000022LD
108857       ON ANY-ERROR-STATUS                                        000022LD
108858          NEXT SENTENCE.                                          000022LD
108859     IF DB-STATUS-OK                                              000022LD
108860         MOVE 'Y' TO SW-LOAD-REC-STORED                           000022LD
108861     ELSE                                                         000022LD
108862       IF ERROR-STATUS NOT = '1205'                               000022LD
108863         MOVE '005' TO WCR-ERROR-CODE                             000022LD
108864         STRING ERROR-STATUS '-STORE  LOAD REC: '                 000022LD
108865                LAST-NUMBER-GENERATED-4010                        000022LD
108866           DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  000022LD
108867         PERFORM 9999999-ABORT THRU 9999999-EXIT.                 000022LD
108868                                                                  000022LD
108869 1111000-EXIT.  EXIT.                                             000022LD
108880 EJECT                                                                    
108900****************************************************************          
109000*        *********************************************         *          
109100*        *  - SHIPMENT CONFIRMATION TRAN TYPE 02 -   *         *          
109200*        *********************************************         *          
109300****************************************************************          
109400 1120000-PROCESS-BOL.                                                     
109500     MOVE 'Y' TO SW-FIRST-SHIP-HDR.                                       
109600     MOVE SPACES TO SW-PAPER-WHSE.                                        
109600     MOVE 'Y'    TO FIRST-TIME-FLAG.                              CG021211
           MOVE 'N'    TO SW-NEW-XBRD-SHIPMENT.                         CG050131
109700     INITIALIZE BILL-OF-LADING.                                           
109800*        *********************************************                    
109900*        * USING THE CUSTOMER NUMBER PASSED, DETER-  *                    
110000*        * MINE WHAT THE THREE DIGIT PLANT CODE IS   *                    
110100*        *********************************************                    
110200                                                                          
110300     MOVE SPACES TO SAVE-SHIP-TO                                          
110400                    SAVE-SHIP-TO-COMPANY                                  
110500                    SAVE-SHIP-TO-WMS-IND                                  
110500                    MEXICAN-XBRD-FLAG                             CG020418
110500                    WS-SHIP-TO                                    CG030203
110600                    SAVE-SHIP-TO-WICS-IND.                                
110700                                                                          
110800     MOVE 'PLANT     ' TO TABLE-KEY-8016                                  
110900                          SAVE-CURRENT-TABLE.                             
111000     MOVE WSC-CUSTOMER TO ENTRY-CODE-8017                                 
3LO030                          TMS-CUSTOMER.                                   
111100     PERFORM 9000000-TBL-HDR-LOOKUP THRU 9000000-HDR-EXIT.                
111200     IF TABLE-RECORD-FOUND                                                
111300        MOVE TABLE-DETAIL-DATA-8017 TO SAVE-SHIP-TO.                      
111400                                                                          
111400     IF MX-SHIP-TO                                                IM011023
111400        MOVE 'Y'                 TO MEXICAN-XBRD-FLAG.            IM011023
111400                                                                  IM011023
111500*        *********************************************                    
111600*        * OBTAIN DATA ABOUT THE SHIP TO   SUCH AS   *                    
111700*        * WHETHER IT IS MICHELIN, UG, ON WICS, OR ON*                    
111800*        * WMS.                                      *                    
111900*        *********************************************                    
112000     INITIALIZE PLANT-MASTER.                                             
112100     MOVE SAVE-SHIP-TO TO PLANT-CODE-005.                                 
112200     IF SAVE-SHIP-TO NOT = SPACES                                         
112300        OBTAIN CALC PLANT-MASTER                                          
112400          ON ANY-ERROR-STATUS                                             
112500             MOVE '039' TO WCR-ERROR-CODE                                 
112600             STRING ERROR-STATUS '-SHIP TO PLANT MASTER  '                
112700               SAVE-SHIP-TO  DELIMITED BY SIZE                            
112800                 INTO WCR-ERROR-TEXT                                      
112900             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
113000                                                                          
113100     MOVE PLANT-CO-CODE-005 TO SAVE-SHIP-TO-COMPANY.                      
113200     MOVE WICS-FLAG-005 TO SAVE-SHIP-TO-WICS-IND.                         
113300                                                                          
113400*        *********************************************                    
113500*        * IF SHIPPING TO A PLANT/DC, DETERMINE IF   *                    
113600*        * THE PLANT/DC IS A WMS PLANT/DC.           *                    
113700*        *********************************************                    
113800                                                                          
113900                                                                          
114000     IF SAVE-SHIP-TO NOT = SPACES                                         
114100        MOVE 'PLANTNWK  ' TO TABLE-KEY-8016                               
114200                             SAVE-CURRENT-TABLE                           
114300        MOVE WSC-CUSTOMER TO ENTRY-CODE-8017                              
114400        PERFORM 9000000-TBL-HDR-LOOKUP THRU 9000000-HDR-EXIT              
114500        IF TABLE-RECORD-FOUND                                             
114600           MOVE 'Y' TO SAVE-SHIP-TO-WMS-IND.                              
114900 EJECT                                                                    
115000*        *********************************************                    
115100*        * THE PRIMARY SCAC PASSED FROM WICS MUST BE *                    
115200*        * VALIDATED AND THE CARRIER CODE OBTAINED   *                    
115300*        * TO POPULATE IT IN THE BILL-OF-LADING REC. *                    
115400*        *********************************************                    
115500                                                                          
115600     MOVE WSC-PRIMARY-CARRIER TO STD-CARR-ALPHA-CODE-8011.                
115700                                                                          
115800     OBTAIN KEEP EXCLUSIVE CALC CARRIER                                   
115900         ON ANY-ERROR-STATUS                                              
116000            MOVE '011' TO WCR-ERROR-CODE                                  
116100            STRING ERROR-STATUS '-CARRIER NOT FOUND '                     
116200             '"'  WSC-PRIMARY-CARRIER '"' DELIMITED BY SIZE INTO          
116300                  WCR-ERROR-TEXT                                          
116400            PERFORM 9999999-ABORT THRU 9999999-EXIT.                      
116500                                                                          
116600     MOVE CARRIER-CODE-8011 TO CARRIER-CODE-3555.                         
116700                                                                          
116800     MOVE 'Y' TO CONTA-DEL-IND-8011.                                      
116900                                                                          
117000     MODIFY CARRIER                                                       
117100       ON ANY-ERROR-STATUS                                                
117200          MOVE '070' TO WCR-ERROR-CODE                                    
117300          STRING ERROR-STATUS '-MODIFY CARRIER '                          
117400           '"'  WSC-PRIMARY-CARRIER '"' DELIMITED BY SIZE INTO            
117500                WCR-ERROR-TEXT                                            
117600          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
118000 EJECT                                                                    
118100*        *********************************************                    
118200*        * VERIFY THAT BILL OF LADING NUMBER PASSED  *                    
118300*        * FALLS WITHIN THE PROPER RANGE ASSIGNED TO *                    
118400*        * THE LOCATION.                             *                    
118500*        *********************************************                    
118600     MOVE SPACES TO WORK-BOL-RANGES.                                      
118700     MOVE 'BOLRANGES ' TO TABLE-KEY-8016                                  
118800                          SAVE-CURRENT-TABLE.                             
118900     MOVE SPACES TO ENTRY-CODE-8017.                                      
           IF WSC-TRW-FLAG = 'Y'                                        CG151007
              MOVE 'TRW'          TO ENTRY-CODE-8017                    CG151007
           ELSE                                                         CG151007
              IF WS-SHIP-FROM-DESC = 'MRT'                              CG020514
                 MOVE 'MRT'          TO ENTRY-CODE-8017                 CG020514
              ELSE                                                      CG020514
119000           MOVE SAVE-SHIP-FROM TO ENTRY-CODE-8017                 CG020514
              END-IF                                                    CG020514
           END-IF                                                       CG151007
119100     PERFORM 9000000-TBL-HDR-LOOKUP THRU 9000000-HDR-EXIT.                
119200     IF NOT TABLE-RECORD-FOUND                                            
119300        MOVE '066' TO WCR-ERROR-CODE                                      
119400        STRING '"BOLRANGES" TABLE DOES NOT EXIST ' SAVE-SHIP-FROM         
119500          DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                          
119600        PERFORM 9999999-ABORT THRU 9999999-EXIT                           
119700     ELSE                                                                 
119800        MOVE TABLE-DETAIL-DATA-8017 TO WORK-BOL-RANGES                    
119900        IF WSC-BOL < LOW-BOL-RANGE OR                                     
120000           WSC-BOL > HIGH-BOL-RANGE                                       
                 IF WSC-TRW-FLAG = 'Y'                                  CG151007
118600              MOVE SPACES TO WORK-BOL-RANGES                              
118700              MOVE 'BOLRANGES ' TO TABLE-KEY-8016                         
118800                                   SAVE-CURRENT-TABLE                     
119000              MOVE SAVE-SHIP-FROM TO ENTRY-CODE-8017              CG020514
119100              PERFORM 9000000-TBL-HDR-LOOKUP                              
119100                                      THRU 9000000-HDR-EXIT               
119200              IF NOT TABLE-RECORD-FOUND                                   
119300                 MOVE '114' TO WCR-ERROR-CODE                             
119400                 STRING '"BOLRANGES" TABLE DOES NOT EXIST '               
119400                                              SAVE-SHIP-FROM              
119500                 DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                   
119600                 PERFORM 9999999-ABORT THRU 9999999-EXIT                  
119200              ELSE                                                        
119800                 MOVE TABLE-DETAIL-DATA-8017 TO WORK-BOL-RANGES           
119900                 IF WSC-BOL < LOW-BOL-RANGE OR                            
120000                    WSC-BOL > HIGH-BOL-RANGE                              
120100                    MOVE '115' TO WCR-ERROR-CODE                          
120200                    STRING WSC-BOL ' OUT OF RANGE: '                      
120300                    WORK-BOL-RANGES DELIMITED BY SIZE INTO                
120400                    WCR-ERROR-TEXT                                        
120500                    PERFORM 9999999-ABORT THRU 9999999-EXIT               
119900                 END-IF                                                   
              ELSE                                                              
120100             MOVE '067' TO WCR-ERROR-CODE                                 
120200             STRING WSC-BOL ' OUT OF RANGE: '                             
120300               WORK-BOL-RANGES DELIMITED BY SIZE INTO                     
120400                  WCR-ERROR-TEXT                                          
120500             PERFORM 9999999-ABORT THRU 9999999-EXIT                      
119900        END-IF                                                            
120600                                                                          
120700*        *********************************************            000036LM
120800*        * CALC TO THE BILL-OF-LADING TO SEE IF THE  *            000036LM
120900*        * SAME NUMBER IS ALREADY ON THE DATABASE.   *            000036LM
121000*        * IF IT IS AND THE SHIPMENT IS OVER ONE     *            000036LM
121010*        * YEAR OLD, CHANGE THE KEY OF THE OLD BOL   *            000036LM
121020*        * RECORD.  IF IT IS NOT THAT OLD, ABEND     *            000036LM
121030*        * WITH A "DUPLICATE BOL NUMBER" ERROR.      *            000036LM
121100*        *********************************************            000036LM
121110                                                                  000036LM
121120     MOVE WSC-BOL TO BILL-LADING-NUMBER-3555                      000036LM
3LO030                     TMS-BOL                                      CG200506
3LO030                     WS-BOL-NBR.                                  CG200506
121130     OBTAIN CALC BILL-OF-LADING                                   000036LM
121140       ON ANY-ERROR-STATUS                                        000036LM
121150         NEXT SENTENCE.                                           000036LM
121160     IF DB-STATUS-OK                                              000036LM
121170       PERFORM 1121000-CHECK-DATE THRU 1121000-EXIT.              000036LM
121200                                                                          
121210*        *********************************************                    
121220*        * MOVE REMAINING FIELDS TO BOL RECORD.      *                    
121230*        * STORE BILL-OF-LADING AND CONNECT TO LOAD  *                    
121240*        * AND TO MASTER-BOL.                        *                    
121250*        *********************************************                    
121260                                                                          
121300     MOVE WSC-BOL TO BILL-LADING-NUMBER-3555                      CG200506
121300                     WS-BOL-NBR.                                  CG200506
121400     MOVE WSC-BOL-WEIGHT TO FREIGHT-WEIGHT-3555                           
3LO030                            TMS-BOL-WEIGHT.                               
121410     IF WSC-LOAD-SEQUENCE IS NUMERIC                              000030LM
121420         MOVE WSC-LOAD-SEQUENCE TO LOAD-SEQUENCE-3555             000030LM
121430     ELSE                                                         000030LM
121440         MOVE ZERO TO LOAD-SEQUENCE-3555                          000030LM
121450     END-IF.                                                      000030LM
121460     MOVE WSC-MH10-LABEL-NBR TO UCC128-CONTA-SER-NBR-3555.        000034DB
121470     MOVE WORK-SHIP-DATE     TO BOL-PRNT-DATE-3555.               C03041  
           MOVE WSC-SHIP-TIME      TO BOL-PRNT-TIME-3555                CG151007
121480     MOVE WORK-SHIP-DATE     TO SHIP-RLSE-DATE-3555.              C03041  
           IF SHIP-RLSE-DATE-3555 = SPACES OR                           CG020305
              SHIP-RLSE-DATE-3555 = '00000000'                          CG020305
              MOVE SAVE-DATE-W-CC  TO SHIP-RLSE-DATE-3555               CG020305
           END-IF.                                                      CG020305
           MOVE WSC-SHIP-TIME      TO SHIP-RLSE-TIME-3555               CG151007
           MOVE WSC-SCHEDULED-FLAG TO SCHEDULED-FLAG-3555.              CG070201
121500     IF GEODE-SHIP-FROM                                           CG161003
121500        IF WSC-FFID-DESC (1) > SPACES                             CG161003
121500           MOVE WSC-FFID-DESC (1)                                 CG161003
121500                             TO CARR-PRO-NBR-3555                 CG161003
121500        END-IF                                                    CG161003
121500     END-IF                                                       CG161003
121500     STORE BILL-OF-LADING                                                 
121600       ON ANY-ERROR-STATUS                                                
121700          MOVE '012' TO WCR-ERROR-CODE                                    
121800          STRING ERROR-STATUS '-UNABLE TO STORE BOL '                     
121900             WSC-BOL DELIMITED BY SIZE INTO                               
122000                WCR-ERROR-TEXT                                            
122100          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
122200                                                                          
122300     CONNECT BILL-OF-LADING TO LOAD-BOL                                   
122400       ON ANY-ERROR-STATUS                                                
122500          MOVE '013' TO WCR-ERROR-CODE                                    
122600          STRING ERROR-STATUS '-CONNECT BOL TO LOAD: '                    
122700             WSC-BOL DELIMITED BY SIZE INTO                               
122800                WCR-ERROR-TEXT                                            
122900          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
123000                                                                          
123100                                                                          
123200     IF WSC-MBOL NOT = SPACES                                             
123300        CONNECT BILL-OF-LADING TO MBOL-BOL                                
123400          ON ANY-ERROR-STATUS                                             
123500             MOVE '014' TO WCR-ERROR-CODE                                 
123600             STRING ERROR-STATUS '-CONNECT BOL TO MBOL: '                 
123700                WSC-BOL DELIMITED BY SIZE INTO                            
123800                   WCR-ERROR-TEXT                                         
123900             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
124000                                                                          
124300*        *********************************************            IM980924
124400*        * STORE FREEFORM-ITEMS IN SDS CV THAT HAS   *            IM980924
124500*        * BEEN PASSED BY WICS                       *            IM980924
124600*        *********************************************            IM980924
121500     IF GEODE-SHIP-FROM                                           CG161102
124600        CONTINUE                                                  CG161102
121500     ELSE                                                         CG161102
124600        MOVE ZEROES TO WS-ITEM-CNT                                IM980924
124100        FIND CURRENT BILL-OF-LADING                               IM980924
124100        PERFORM 112A000-STORE-FREEFORM THRU 112A000-EXIT          IM980924
124100             VARYING WS-ITEM-CNT FROM 1 BY 1                      IM980924
124100               UNTIL WS-ITEM-CNT > 15                             IM980924
121500     END-IF                                                       CG161102
124200 EJECT                                                                    
124300*        *********************************************                    
124400*        * STORE "UGMT" TABLE RECORD IF SHIPPING FROM*                    
124500*        * ONE COMPANY TO ANOTHER.                   *                    
124501*        *                                           *                    
124502*        * BLOCK "UGMT" UPDATE BECAUSE OF 01/01/94   *            000014LJ
124503*        * LEGAL ENTITY REQUIREMENTS.                *            000014LJ
124600*        *********************************************                    
124700                                                                          
125200*        *********************************************                    
125300*        * STORE "OAVI" TEXT IF THIS BOL WAS FOUND TO*                    
125400*        * BE ASSOCIATED WITH A CUSTOMER THAT IS IN  *            000031LM
125410*        * THE "WMSAVIEXP" TABLE.                    *            000031LM
125500*        *********************************************                    
125600                                                                          
126020*        *********************************************            000026LD
126030*        * STORE "WMS IF" TEXT IF AN IMPORT FILE NBR *            000026LD
126040*        * WAS PASSED IN WSC-LOAD-DATA.  THE NBR WILL*            000026LD
126041*        * BE PASSED FOR CROSS-BORDER SHIPMENTS AND  *            000026LD
126042*        * WILL BE USED BY DNWMP243.                 *            000026LD
126050*        *********************************************                    
126060                                                                          
126200*        *********************************************                    
126300*        * STORE WICS-LOADS RECORD FOR AUDITING      *                    
126400*        * PURPOSES TO ASSOCIATE WICS BOL WITH LOAD  *                    
126500*        * STORED FOR IT ON THE CORE.                *                    
126600*        *********************************************                    
126700     PERFORM 1124000-AUDIT-LOAD THRU 1124000-EXIT.                        
126800                                                                          
           INITIALIZE WS-C-LOAD-NBR.                                    CG240716
           IF WSC-FFID-DESC (2) > SPACES                                CG240716
              MOVE WSC-FFID-DESC (2)                                    CG240716
                                TO WS-C-LOAD-NBR                        CG240716
           END-IF.                                                      CG240716
                                                                                
126900 1120000-EXIT. EXIT.                                                      
127200                                                                          
127200*         ********************************************            IM980924
127200*         * STORE THE FREEFORM-ITEMS RECORD IN SDS   *            IM980924
127200*         ********************************************            IM980924
127200 112A000-STORE-FREEFORM.                                          IM980924
127200                                                                          
127200     INITIALIZE FREEFORM-ITEMS.                                   IM980924
127200     IF WSC-FFID-DESC(WS-ITEM-CNT) EQUAL SPACES                   IM980924
                 MOVE 16 TO WS-ITEM-CNT                                 IM980924
                 GO TO 112A000-EXIT.                                    IM980924
127200                                                                          
                                                                                
127200     MOVE WSC-FFID-QTY(WS-ITEM-CNT)  TO ITEM-QTY-8384             IM980924
127200     MOVE WSC-FFID-DESC(WS-ITEM-CNT) TO ITEM-DESC-8384            IM980924
127200     MOVE WSC-FFID-WGT(WS-ITEM-CNT)  TO ITEM-WGT-LBS-8384         IM980924
                                                                                
127200     STORE FREEFORM-ITEMS                                         IM980924
121600       ON ANY-ERROR-STATUS                                        IM980924
121700       MOVE '012' TO WCR-ERROR-CODE                               IM980924
121800       STRING ERROR-STATUS '-UNABLE TO STORE FREEFORM-ITEM'       IM980924
121900              DELIMITED BY SIZE INTO                              IM980924
122000              WCR-ERROR-TEXT                                      IM980924
122100       PERFORM 9999999-ABORT THRU 9999999-EXIT.                   IM980924
                                                                                
127200     CONNECT FREEFORM-ITEMS TO BOL-FREEFORM                       IM980924
123400       ON ANY-ERROR-STATUS                                        IM980924
123500          MOVE '014' TO WCR-ERROR-CODE                            IM980924
123600          STRING ERROR-STATUS '-CONNECT FREEFORM TO BOL'          IM980924
123700               DELIMITED BY SIZE INTO                             IM980924
123800              WCR-ERROR-TEXT                                      IM980924
123900          PERFORM 9999999-ABORT THRU 9999999-EXIT.                IM980924
127200                                                                          
127200 112A000-EXIT.                                                    IM980924
127200     EXIT.                                                        IM980924
127300 EJECT                                                                    
127400 1121000-CHECK-DATE.                                              000036LM
127500                                                                  000036LM
127600     ACCEPT WS-HOLD-LOAD-DBKEY FROM LOAD CURRENCY.                000036LM
127700     OBTAIN OWNER WITHIN LOAD-BOL                                 000036LM
127800       ON ANY-ERROR-STATUS                                        000036LM
127900         MOVE '095' TO WCR-ERROR-CODE                             000036LM
128000         STRING ERROR-STATUS '-ON LOAD-BOL SET '                  000036LM
128100           WSC-BOL DELIMITED BY SIZE                              000036LM
128200           INTO WCR-ERROR-TEXT                                    000036LM
128300         PERFORM 9999999-ABORT THRU 9999999-EXIT.                 000036LM
128400     MOVE ACTUAL-SHIP-DATE-8009 TO WS-OLD-YMD.                    000036LM
128500     IF WS-OLD-YY > 90                                            000036LM
128600         MOVE 19 TO WS-OLD-CC                                     000036LM
128700     ELSE                                                         000036LM
128800         MOVE 20 TO WS-OLD-CC.                                    000036LM
128900     MOVE WORK-SHIP-DATE-N TO WS-TEST-DATE.                       000036LM
129000     SUBTRACT 1 FROM WS-TEST-YEAR.                                000036LM
129100     IF WS-OLD-DATE < WS-TEST-DATE                                000036LM
129200         PERFORM 1121100-MODIFY-BOL THRU 1121100-EXIT             000036LM
129300     ELSE                                                         000036LM
129310         MOVE '096' TO WCR-ERROR-CODE                             000036LM
129320         STRING 'BOL ALREADY EXISTS ON DB: '                      000036LM
129330           WSC-BOL DELIMITED BY SIZE                              000036LM
129340           INTO WCR-ERROR-TEXT                                    000036LM
129350         PERFORM 9999999-ABORT THRU 9999999-EXIT.                 000036LM
129400                                                                  000036LM
129410     OBTAIN LOAD DB-KEY IS WS-HOLD-LOAD-DBKEY.                    000036LM
129412*        *********************************************            000036LM
129413*        * RE-INITIALIZE THE RECORD AND CARRIER      *            000036LM
129414*        * FIELD SINCE THESE WERE DONE PRIOR TO THE  *            000036LM
129415*        * OLD BILL-OF-LADING BEING OBTAINED.        *            000036LM
129417*        *********************************************            000036LM
129420     INITIALIZE BILL-OF-LADING.                                   000036LM
129430     MOVE CARRIER-CODE-8011 TO CARRIER-CODE-3555.                 000036LM
129500                                                                  000036LM
130600 1121000-EXIT. EXIT.                                              000036LM
130601                                                                          
130602 EJECT                                                                    
130603 1121100-MODIFY-BOL.                                              000036LM
130604                                                                  000036LM
130605     FIND CURRENT BILL-OF-LADING.                                 000036LM
130606     MOVE SPACES TO BILL-LADING-NUMBER-3555.                      000036LM
130607     STRING WSC-BOL                                               000036LM
130608            'OLD'   DELIMITED BY SIZE                             000036LM
130609         INTO BILL-LADING-NUMBER-3555.                            000036LM
130637     MODIFY BILL-OF-LADING                                        000036LM
130638       ON ANY-ERROR-STATUS                                        000036LM
130639         MOVE '097' TO WCR-ERROR-CODE                             000036LM
130640         STRING ERROR-STATUS '-MODIFY OLD BOL '                   000036LM
130641           WSC-BOL DELIMITED BY SIZE                              000036LM
130642           INTO WCR-ERROR-TEXT                                    000036LM
130643         PERFORM 9999999-ABORT THRU 9999999-EXIT.                 000036LM
130644                                                                  000036LM
130648 1121100-EXIT. EXIT.                                              000036LM
130650 EJECT                                                                    
130900 1123000-STORE-OAVI-TEXT.                                                 
131000     INITIALIZE TEXT-HEADER.                                              
131100     MOVE 'OAVI' TO TEXT-TYPE-CODE-951.                                   
131200     MOVE 'NOTIFY' TO TEXT-KEY-951.                                       
131300     FIND KEEP EXCLUSIVE CALC TEXT-HEADER                                 
131400       ON ANY-ERROR-STATUS                                                
131500          NEXT SENTENCE.                                                  
131600                                                                          
131700     IF DB-REC-NOT-FOUND                                                  
131800        STORE TEXT-HEADER                                                 
131900          ON ANY-ERROR-STATUS                                             
132000             MOVE '015' TO WCR-ERROR-CODE                                 
132100             STRING ERROR-STATUS '-STORE "OAVI" TEXT HDR '                
132200                WSC-BOL DELIMITED BY SIZE INTO                            
132300                   WCR-ERROR-TEXT                                         
132400             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
132500     IF NOT DB-STATUS-OK                                                  
132600        MOVE '016' TO WCR-ERROR-CODE                                      
132700        STRING ERROR-STATUS 'OBTAIN "OAVI" TEXT HDR -'                    
132800          WSC-BOL DELIMITED BY SIZE INTO                                  
132900             WCR-ERROR-TEXT                                               
133000        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
133100                                                                          
133200     INITIALIZE TEXT-LINE.                                                
133210     MOVE SPACES TO WORK-OAVI-TEXT.                                       
133300     MOVE LOAD-NUMBER-8009        TO OAVI-LOAD.                           
133400     MOVE BILL-LADING-NUMBER-3555 TO OAVI-BOL.                            
133500     MOVE WORK-OAVI-TEXT TO TEXT-LINE.                                    
133600     STORE TEXT-LINE                                                      
133700       ON ANY-ERROR-STATUS                                                
133800          MOVE '017' TO WCR-ERROR-CODE                                    
133900          STRING ERROR-STATUS 'STORE "OAVI" TEXT LINE '                   
134000            WSC-BOL DELIMITED BY SIZE INTO                                
134100               WCR-ERROR-TEXT                                             
134200          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
134300 1123000-EXIT. EXIT.                                                      
134420 EJECT                                                                    
130900 1123500-STORE-FOP-TEXT.                                          CG221205
131000     INITIALIZE INV-TEXT-HDR.                                     CG221205
131100     MOVE 'FOP'    TO TEXT-TYPE-CODE-2718.                        CG221205
131200     MOVE 'RAMPUP' TO TEXT-KEY-2718.                              CG221205
131200     MOVE 'DNWMX830' TO UPDATE-USER-2718.                         CG221205
131300     FIND KEEP EXCLUSIVE CALC INV-TEXT-HDR                        CG221205
131400     ON ANY-ERROR-STATUS                                          CG221205
131500          NEXT SENTENCE                                           CG221205
131400     END-IF                                                       CG221205
131600                                                                  CG221205
131700     IF DB-REC-NOT-FOUND                                          CG221205
131800        STORE INV-TEXT-HDR                                        CG221205
131900          ON ANY-ERROR-STATUS                                     CG221205
132000             MOVE '015' TO WCR-ERROR-CODE                         CG221205
132100             STRING ERROR-STATUS '-STORE "FOP" TEXT HDR '         CG221205
132200                WSC-BOL DELIMITED BY SIZE INTO                    CG221205
132300                   WCR-ERROR-TEXT                                 CG221205
132400             PERFORM 9999999-ABORT THRU 9999999-EXIT              CG221205
131400     END-IF                                                       CG221205
132500     IF NOT DB-STATUS-OK                                          CG221205
132600        MOVE '016' TO WCR-ERROR-CODE                              CG221205
132700        STRING ERROR-STATUS 'OBTAIN "FOP" TEXT HDR -'             CG221205
132800          WSC-BOL DELIMITED BY SIZE INTO                          CG221205
132900             WCR-ERROR-TEXT                                       CG221205
133000        PERFORM 9999999-ABORT THRU 9999999-EXIT                   CG221205
131400     END-IF.                                                      CG221205
133100                                                                  CG221205
133200     INITIALIZE INV-TEXT-LINE.                                    CG221205
133210     MOVE SPACES TO WORK-RAMPUP-TEXT.                             CG221205
133400     MOVE BILL-LADING-NUMBER-3555 TO RAMPUP-BOL.                  CG221205
133400     MOVE 'N'                     TO RAMPUP-PROCESSED-FLAG.       CG221205
133500     MOVE WORK-RAMPUP-TEXT        TO TEXT-DETAIL-LINE-2719.       CG221205
133600     STORE INV-TEXT-LINE                                          CG221205
133700     ON ANY-ERROR-STATUS                                          CG221205
133800        MOVE '017' TO WCR-ERROR-CODE                              CG221205
133900        STRING ERROR-STATUS 'STORE "FOP" TEXT LINE '              CG221205
134000          WSC-BOL DELIMITED BY SIZE INTO                          CG221205
134100             WCR-ERROR-TEXT                                       CG221205
134200        PERFORM 9999999-ABORT THRU 9999999-EXIT                   CG221205
131400     END-IF.                                                      CG221205
           IF LOGMSG                                                    CG221205
              MOVE SPACES               TO WS-MESSAGE-DATA              CG221205
              STRING                                                    CG221205
                     '"PGM":',                                          CG221205
                     '"DNWMX830",',                                     CG221205
                     '"REC-TYPE":',                                     CG221205
                     '"ACTIVITY",',                                     CG221205
                     '"BOL":',                                          CG221205
                     '"',                                               CG221205
                     WSC-BOL,                                           CG221205
                     '",',                                              CG221205
                     '"BOLFLAG":'                                       CG221205
                     '"',                                               CG221205
                     BOL-RAMPUP-FLAG-3555                               CG221205
                     '",',                                              CG221205
                     '"MSG":',                                          CG221205
                     '"STORED MESSAGE RECORD"'                          CG221205
                 DELIMITED BY SIZE INTO WS-MESSAGE-DATA                 CG221205
              END-STRING                                                CG221205
              PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                   CG221205
           END-IF.                                                      CG221205
134300 1123500-EXIT. EXIT.                                              CG221205
134420 EJECT                                                            CG221205
134500 1124000-AUDIT-LOAD.                                                      
134600     INITIALIZE WICS-LOADS.                                               
134700     MOVE BILL-LADING-NUMBER-3555 TO BILL-LADING-NUMBER-8407.             
134710     MOVE WCR-SERIAL TO SAVE-SERIAL-NUMBER.                               
134800     MOVE SAVE-SERIAL-NUMBER TO WICS-SERIAL-NBR-8407.                     
134900     MOVE LOAD-NUMBER-8009 TO LOAD-NUMBER-8407.                           
           MOVE WORK-SHIP-DATE      TO ACTUAL-SHIP-DATE-8407            CG151007
135100     STORE WICS-LOADS                                                     
135400         ON ANY-ERROR-STATUS                                              
135500             MOVE '062' TO WCR-ERROR-CODE                                 
135600             STRING ERROR-STATUS '-STORE WICS-LOADS '                     
135700                BILL-LADING-NUMBER-3555 DELIMITED BY SIZE INTO            
135800                   WCR-ERROR-TEXT                                         
135900             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
138400 1124000-EXIT. EXIT.                                                      
138410                                                                          
138420 EJECT                                                                    
138430 1125000-STORE-IF-TEXT.                                           000026LD
138440     INITIALIZE TEXT-HEADER.                                      000026LD
138450     MOVE 'WMS ' TO TEXT-TYPE-CODE-951.                           000026LD
138460     STRING 'IF'  WSC-BOL  DELIMITED BY SIZE                      000026LD
138470         INTO TEXT-KEY-951.                                       000026LD
138480     FIND KEEP EXCLUSIVE CALC TEXT-HEADER                         000026LD
138490       ON ANY-ERROR-STATUS                                        000026LD
138491          NEXT SENTENCE.                                          000026LD
138492                                                                          
138493     IF DB-REC-NOT-FOUND                                          000026LD
138494        STORE TEXT-HEADER                                         000026LD
138495          ON ANY-ERROR-STATUS                                     000026LD
138496             MOVE '081' TO WCR-ERROR-CODE                         000026LD
138497             STRING ERROR-STATUS '-STORE "WMS IF" TEXT HDR '      000026LD
138498                WSC-BOL DELIMITED BY SIZE INTO                    000026LD
138499                   WCR-ERROR-TEXT                                 000026LD
138500             PERFORM 9999999-ABORT THRU 9999999-EXIT.             000026LD
138501     IF NOT DB-STATUS-OK                                          000026LD
138502        MOVE '091' TO WCR-ERROR-CODE                              000026LD
138503        STRING ERROR-STATUS 'OBTAIN "WMS IF" TEXT HDR -'          000026LD
138504          WSC-BOL DELIMITED BY SIZE INTO                          000026LD
138505             WCR-ERROR-TEXT                                       000026LD
138506        PERFORM 9999999-ABORT THRU 9999999-EXIT.                  000026LD
138507                                                                          
138508     INITIALIZE TEXT-LINE.                                        000026LD
           MOVE WSC-IMPORT-FILE-NBR TO TEXT-DETAIL-LINE-952             IM011001
                                       WS-RECV-IMPT-FILE-NBR.           IM011001
138510     STORE TEXT-LINE                                              000026LD
138511       ON ANY-ERROR-STATUS                                        000026LD
138512          MOVE '092' TO WCR-ERROR-CODE                            000026LD
138513          STRING ERROR-STATUS 'STORE "WMS IF" TEXT LINE '         000026LD
138514            WSC-BOL DELIMITED BY SIZE INTO                        000026LD
138515               WCR-ERROR-TEXT                                     000026LD
138516          PERFORM 9999999-ABORT THRU 9999999-EXIT.                000026LD
                                                                                
           MOVE 'N'   TO FIRST-TIME-FLAG.                                       
138517 1125000-EXIT. EXIT.                                              000026LD
138520 EJECT                                                                    
138600                                                                          
138700****************************************************************          
138800*        *********************************************         *          
138900*        *  - SHIPMENT CONFIRMATION TRAN TYPE 03 -   *         *          
139000*        *********************************************         *          
139100****************************************************************          
139200 1130000-PROCESS-SHIP-HDR.                                                
139300                                                                          
140010*        *********************************************                    
140020*        * IF SHIPMENT-HEADER PART OF A SALES-ORDER; *                    
140030*        * DETERMINE WHAT THE NEW SHIPMENT-NUMBER    *                    
140040*        * SHOULD BE.                                *                    
140050*        *********************************************                    
           MOVE 'N'         TO SAVE-MRTI-SW.                            CG021213
037100     MOVE SPACES      TO SAVE-REV-PO-FLAG.                         C03407 
140060     MOVE 000         TO SAVE-LAST-SHIP-HDR.                              
140060     MOVE 000         TO SAVE-LAST-SHIP-UNIQUE-NBR.               CG230725
                                                                                
3LO030     MOVE WSC-SOURCE-DC TO TMS-SOURCE-DC.                                 
3LO030     MOVE WSC-SDS-ORDER TO TMS-SDS-ORDER.                                 
3LO030     MOVE WSC-ORDER-TYPE TO TMS-ORDER-TYPE.                               
3LO030     MOVE WSC-LS-ORDER-TYPE TO TMS-LS-ORDER-TYPE.                         
           IF WSC-TRW-FLAG = 'Y'                                        CG151007
              IF WSC-DT-CUST-DUE = SPACES OR LOW-VALUE                  CG151007
                 MOVE '101' TO WCR-ERROR-CODE                           CG151007
                 STRING 'ETA DATE RECEIVED IS SPACES'                   CG151007
                 DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                 CG151007
                 PERFORM 9999999-ABORT THRU 9999999-EXIT                CG151007
              END-IF                                                    CG151007
              IF WSC-TM-CUST-DUE = SPACES OR LOW-VALUE                  CG151007
                 MOVE '101' TO WCR-ERROR-CODE                           CG151007
                 STRING 'ETA TIME RECEIVED IS SPACES'                   CG151007
                 DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                 CG151007
                 PERFORM 9999999-ABORT THRU 9999999-EXIT                CG151007
              END-IF                                                    CG151007
           END-IF.                                                      CG151007
067800     MOVE 'Y'        TO SAVE-MRTI-FLAG.                           CG020514
067800     MOVE 'Y'        TO FIRST-TIME-FLAG.                          CG021211
                                                                                
140070     IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER                        
              IF (WSC-TRW-FLAG = SPACE) OR                              CG160325
                 (WSC-TRW-FLAG = 'N')                                   CG160325
140100           MOVE 'Y' TO SW-EXEC-PFO                                CG160325
              ELSE                                                      CG160325
                 CONTINUE                                               CG160325
              END-IF                                                    CG160325
140200     ELSE                                                                 
140300        PERFORM 1135000-GET-SHIP-NUMBER THRU 1135000-EXIT.                
140400                                                                          
140500*        *********************************************                    
140600*        * STORE A SHIPMENT-HEADER AND CONNECT TO    *                    
140700*        * APPROPRIATE RECORDS.                      *                    
140800*        *********************************************                    
141000     INITIALIZE SHIPMENT-HEADER.                                          
           MOVE SPACES TO REVERSE-PO-NBR-3515.                                  
141100     ADD 1 TO SAVE-LAST-SHIP-HDR.                                         
141100     ADD 1 TO SAVE-LAST-SHIP-UNIQUE-NBR.                          CG230725
141200     MOVE SAVE-LAST-SHIP-HDR TO SHIPMENT-NUMBER-3515.                     
141200     MOVE SAVE-LAST-SHIP-UNIQUE-NBR TO ORDER-LEAD-TIME-3515.      CG230725
141300     MOVE WSC-SOURCE-DC TO SHIP-PLANT-CODE-3515.                          
141400     MOVE WSC-YMD-CUST-DUE TO CUSTOMER-DUE-DATE-3515.                     
141500     MOVE WSC-FREIGHT-CHG-FLAG TO FREIGHT-CHARGE-FLAG-3515.               
      * HARD CODE FREIGHT CHARGE FLAG FOR SOLOMON SHIPMENTS             CG100219
           IF   WSC-FREIGHT-AMT  > ZERO  AND                            CG100219
                WS-SOLOMON-PLANT = 'Y'                                  CG100219
                MOVE 'A'         TO FREIGHT-CHARGE-FLAG-3515            CG100219
           END-IF.                                                      CG100219
141600     MOVE WSC-INSURED-AMT TO INSURED-AMT-3515.                            
143111*                                                                 CG200506
143111        IF WSC-GOVT-CTRCT-NBR(1:2) = 'TP'                         CG200506
                 AND WSC-LS-ORDER-TYPE = 'A'                            CG240516
143111           SET WS-GET-FP-YES TO TRUE                              CG200506
143111           PERFORM 1140010-GET-UNIT-PRICE                         CG200506
143111              THRU 1140010-EXIT                                   CG200506
143102           MOVE WS-FINL-FREIGHT-CHG TO FREIGHT-CHARGE-AMT-3515    CG200506
143111           SET WS-GET-FP-NO  TO TRUE                              CG200506
143111           PERFORM 1133800-STORE-LOAD-ID                          CG200506
143111              THRU 1133800-EXIT                                   CG200506
143111        ELSE                                                      CG200506
143102           MOVE WSC-FREIGHT-AMT TO FREIGHT-CHARGE-AMT-3515        CG200506
143111        END-IF                                                    CG200506
143103                                                                          
143104     MOVE WSC-ORDER-TYPE TO ORDER-TYPE-3515.                              
           MOVE WSC-BOL-SUFFIX TO BOL-SUFFIX-X-3-3515.                  CG030715
143105     MOVE WSC-CUSTOMER TO SHIP-TO-BUSINESS-3515.                          
143106     MOVE SHIP-DATE-YMD TO DATE-SHIPPED-3515.                             
143107     MOVE CARRIER-CODE-8011 TO CARRIER-CODE-3515.                         
143108     MOVE BILL-LADING-NUMBER-3555 TO BILL-LADING-NUMBER-3515.             
143109     MOVE 'DNWMX830' TO ANALYST-3515.                                     
143110     MOVE SAVE-DATE TO DATE-LAST-ACTIVITY-3515.                           
143111     IF DOMESTIC-TRANSFER                                         CG181030
143111        IF WSC-GOVT-CTRCT-NBR(1:2) = 'TP'                         CG181030
143111           CONTINUE                                               CG181030
143111        ELSE                                                      CG181030
143111           MOVE WSC-GOVT-CTRCT-NBR TO GOVT-CTRCT-NBR-3515                 
143111        END-IF                                                    CG181030
143111     ELSE                                                         CG181030
143111        MOVE WSC-GOVT-CTRCT-NBR TO GOVT-CTRCT-NBR-3515                    
143111     END-IF                                                       CG181030
143112     MOVE SAVE-BORDER-EXIT-PT TO BORDER-EXIT-POINT-CODE-3515.     000025LD
143112     MOVE WSC-OCEAN-FRGHT-AMT TO FREIGHT-AMT-3515.                IM011023
143112     MOVE WSC-TM-CUST-DUE     TO CUST-DUE-TIME-3515.              CG170420
                                                                                
037100     IF SAVE-REV-PO-FLAG = 'Y'                                     C03407 
               MOVE BILL-LADING-NUMBER-3515 TO SAVE-REV-PO-BOL           C03407 
               MOVE SAVE-REV-BOL-2X         TO SAVE-REV-PO-2X            C03407 
               MOVE SAVE-REV-BOL-4X         TO SAVE-REV-PO-4X            C03407 
               MOVE SAVE-REV-PO-NBR         TO REVERSE-PO-NBR-3515.      C03407 
                                                                                
           IF EXPORT-SALES                                                      
126000        PERFORM 1123000-STORE-OAVI-TEXT THRU 1123000-EXIT.                
                                                                                
           MOVE SHIP-PLANT-CODE-3515        TO PLANT-CODE-005.          CG030211
           OBTAIN CALC PLANT-MASTER                                     CG030211
           ON DB-REC-NOT-FOUND                                          CG030211
                STRING ERROR-STATUS                                     CG030211
                   'OBTAIN PLANT-MASTER:'                               CG030211
                    PLANT-CODE-005                                      CG030211
                       DELIMITED BY SIZE INTO WCR-ERROR-TEXT            CG030211
                PERFORM 9999999-ABORT THRU 9999999-EXIT                 CG030211
           END-IF.                                                      CG030211
                                                                        CG030211
           IF PKMS-FLAG-005 = 'Y'                                       CG030211
              MOVE WS-LOAD-NUMBER           TO LOAD-NUMBER              CG030211
              MOVE FREIGHT-CHARGE-AMT-3515  TO FREIGHT-CHARGE-AMT       CG030211
              MOVE FREIGHT-AMT-3515         TO OCEAN-FREIGHT-AMT        CG030211
              MOVE INSURED-AMT-3515         TO INSURED-AMT              CG030211
              MOVE WSC-ORDER-TYPE           TO ORDER-TYPE               CG030211
              MOVE WSC-CUSTOMER             TO CUSTOMER-NUMBER          CG030211
              TRANSFER CONTROL TO 'DNWMX007' LINK                       CG030211
                USING  SUBSCHEMA-CTRL                                   CG030211
                       LOAD                                             CG030211
                       BUSINESS                                         CG030211
                       CUSTOMER                                         CG030211
                       AOWMW007                                         CG030211
           END-IF.                                                      CG030211
           IF PKMS-FLAG-005 = 'Y'                                       CG030211
              IF ERROR-MSG1 NOT = SPACES                                CG030211
                 MOVE 'ERROR IN CURRENCY CONVERSION'                    CG030211
                                            TO WCR-ERROR-TEXT           CG030211
                PERFORM 9999999-ABORT       THRU 9999999-EXIT           CG030211
              ELSE                                                      CG030211
                 MOVE INSURED-AMT           TO INSURED-AMT-3515         CG030211
                 MOVE FREIGHT-CHARGE-AMT    TO FREIGHT-CHARGE-AMT-3515  CG030211
                 MOVE OCEAN-FREIGHT-AMT     TO FREIGHT-AMT-3515         CG030211
              END-IF                                                    CG030211
           END-IF.                                                      CG030211
143113     STORE SHIPMENT-HEADER                                                
143114       ON ANY-ERROR-STATUS                                                
143115          MOVE '019' TO WCR-ERROR-CODE                                    
143116          STRING ERROR-STATUS '-STORE SHIP HDR: '                         
143117            WSC-INV-NUMBER DELIMITED BY SIZE INTO                         
143118               WCR-ERROR-TEXT                                             
143200          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
143300                                                                          
143400*        *********************************************             C03407 
143500*        * CONNECT SHIPMENT-HEADER TO REVERSE-PO-NBR *             C03407 
143600*        * INDEX WHEN SHIPMENT IS ONE THAT APPLIES   *             C03407 
143700*        * TO THIS REVERSE PO DETERMINATION LOGIC.   *             C03407 
144000*        *********************************************             C03407 
037100     IF SAVE-REV-PO-FLAG = 'Y'                                     C03407 
               CONNECT SHIPMENT-HEADER TO IX-REVERSE-PO                  C03407 
143114            ON ANY-ERROR-STATUS                                    C03407 
143115            MOVE '068' TO WCR-ERROR-CODE                           C03407 
143116            STRING ERROR-STATUS '-SHP HDR IX-REV: '                C03407 
143117            WSC-INV-NUMBER DELIMITED BY SIZE INTO                  C03407 
143118                   WCR-ERROR-TEXT                                  C03407 
143200            PERFORM 9999999-ABORT THRU 9999999-EXIT.               C03407 
                                                                                
140900     MOVE WSC-SOURCE-DC    TO PLANT-CODE-005.                     CG020813
140900     OBTAIN CALC PLANT-MASTER                                     CG020813
140900     ON DB-REC-NOT-FOUND                                          CG020813
270200        MOVE '068' TO WCR-ERROR-CODE                              CG020813
270300              STRING ERROR-STATUS                                 CG020813
270400              'CALC PLANT-MASTER '                                CG020813
270500               PLANT-CODE-005                                     CG020813
270600               DELIMITED BY SIZE INTO WCR-ERROR-TEXT              CG020813
270700               PERFORM 9999999-ABORT THRU 9999999-EXIT            CG020813
140900     END-IF.                                                      CG020813
140900     IF PLANT-DESC-005(1:3) = 'MRT'                               CG020813
              MOVE 'Y'          TO SAVE-MRTI-SW                         CG021213
153800      END-IF.                                                     CG020813
153800                                                                  CG020813
143400*        *********************************************                    
143500*        * CONNECT SHIPMENT-HEADER TO LOAD-SHIP.     *                    
143600*        * FIND CURRENT LOAD TO GET BACK CURRENT ON  *                    
143700*        * THIS SHIPMENT'S LOAD;  CURRENCY WAS       *                    
143800*        * ALTERED WHEN GETTING THE LAST SHIPMENT-   *                    
143900*        * HEADER FOR THE SALES-ORDER.               *                    
144000*        *********************************************                    
144100     FIND CURRENT LOAD.                                                   
144200     CONNECT SHIPMENT-HEADER TO LOAD-SHIP                                 
144300       ON ANY-ERROR-STATUS                                                
144400          MOVE '020' TO WCR-ERROR-CODE                                    
144500          STRING ERROR-STATUS '-MAKE LOAD-SHIP CONN: '                    
144600            WSC-INV-NUMBER DELIMITED BY SIZE INTO                         
144700               WCR-ERROR-TEXT                                             
144800          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
145000 EJECT                                                                    
145200*        *********************************************                    
145300*        * CONNECT SHIPMENT-HEADER TO BOL-SHIP       *                    
145400*        * FIND CURRENT BOL  TO GET BACK CURRENT ON  *                    
145500*        * THIS SHIPMENT'S BOL ;  CURRENCY WAS       *                    
145600*        * ALTERED WHEN GETTING THE LAST SHIPMENT-   *                    
145700*        * HEADER FOR THE SALES-ORDER.               *                    
145800*        *********************************************                    
145900     FIND CURRENT BILL-OF-LADING.                                         
146000     CONNECT SHIPMENT-HEADER TO BOL-SHIP                                  
146100       ON ANY-ERROR-STATUS                                                
146200          MOVE '021' TO WCR-ERROR-CODE                                    
146300          STRING ERROR-STATUS '-MAKE BOL-SHIP CONN: '                     
146400            WSC-INV-NUMBER DELIMITED BY SIZE INTO                         
146500               WCR-ERROR-TEXT                                             
146600          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
146700                                                                          
146800*        *********************************************                    
146900*        * IF SHIPMENT-HEADER PART OF A SALES-ORDER; *                    
147000*        * CONNECT SHIPMENT-HEADER TO SALES-ORDER.   *                    
147100*        *********************************************                    
147200                                                                          
147600     IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER                        
147700        NEXT SENTENCE                                                     
147800     ELSE                                                                 
147900        CONNECT SHIPMENT-HEADER TO ORDER-SHIPMENTS                        
148000          ON ANY-ERROR-STATUS                                             
148100             MOVE '026' TO WCR-ERROR-CODE                                 
148200             STRING ERROR-STATUS '-MAKE ORDER-SHIPMENTS CONN: '           
148300               WSC-SDS-ORDER DELIMITED BY SIZE INTO                       
148400                  WCR-ERROR-TEXT                                          
148500             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
148800 EJECT                                                                    
148900*        *********************************************                    
149000*        * STORE AR-INVOICE-HDR                      *                    
149100*        * AN INVOICE SHOULD NOT EXIST FOR DOMESTIC  *                    
149200*        * TRANSFERS OR CONSIGNMENT ORDERS.          *                    
149300*        * ADDITIONALLY, A BLANK INVOICE WILL BE SENT*                    
149400*        * UP FOR CROSS BORDERS OR SALES ORDERS IF   *                    
149401*        * IT IS A ZERO SHIPPED INVOICE.             *                    
149402*        *                                           *                    
149403*        * FOR CROSS BORDER TRANSFER, YOU CAN GET    *                    
149500*        * MULTIPLE 03 RECORDS PASSED WITH THE SAME  *                    
149600*        * INVOICE NUMBER; DON'T ABEND IF 1205 OCCURS*                    
149700*        *********************************************                    
                                                                        CG220405
      *       CROSS BORDER SHIPMENTS IF ALL LINES ARE CANCELLED, TOSHIP CG220405
      *       FROM GEODE WILL NOT HAVE INVOICE#. THIS CHANGE IS TO PASS CG220405
      *       THE VALIDATION STEP, SYSTEM WILL NOT STORE INV/SHIPMENTHDRCG220405
      *       OR SHIPMENT LINES AS SHIPPED QTY WILL BE ZEROES - CHECK   CG220405
      *       1140000-PROCESS-LINE PROCESS FOR THE ROLLBACK ACTIONS.    CG220405
                                                                        CG220405
              IF CROSS-BORDER-TRANSFER AND                              CG220405
                 WSC-INV-NUMBER = SPACES                                CG220405
                 MOVE '009999999999'   TO WSC-INV-NUMBER                CG220405
                                          RECEIVABLE-ITEM-NUMBER-2712   CG220405
              END-IF.                                                   CG220405
                                                                                
149800     IF DOMESTIC-TRANSFER OR LS-CONSIGNMENT OR                            
149810        WSC-INV-NUMBER = SPACES                                           
2SP160*          STRING " 2SP160 => SANT> ", WSC-INV-NUMBER                     
2SP160*          DELIMITED BY SIZE INTO DEBUG-SNAP                              
2SP160*          SNAP TITLE IS DEBUG-SNAP FROM WSC-DATA-RECORD                  
2SP160*          LENGTH 100                                                     
149900        NEXT SENTENCE                                                     
150000     ELSE                                                                 
150100        INITIALIZE AR-INVOICE-HDR                                         
150200        MOVE WSC-INV-NUMBER TO RECEIVABLE-ITEM-NUMBER-2712                
2SP160        IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER             CG020308
2SP160          CONTINUE                                                CG020308
2SP160        ELSE                                                      CG020308
2SP160          IF BATCH-ORDER-IND-3510 = 'K'                           IM010212
2SP160             MOVE 'XB'  TO RECEIVABLE-ITEM-NUMBER-2712(1:2)       IM010212
2SP160             SET  NEW-XBRD-SHIPMENT TO TRUE                       IM010212
2SP160          END-IF                                                  IM010212
                IF SAVE-MRTI-FLAG       = 'N'                           CG020514
                   IF BATCH-ORDER-IND-3510 = 'K'                        CG020514
                      MOVE 'N' TO SW-NEW-XBRD-SHIPMENT                  CG020514
                      SET MRTI-XBRD-SHIPMENT TO TRUE                    CG020514
                   ELSE                                                 CG020514
                    IF ORDER-TYPE-3510 = 'S'                            CG020514
                      SET MRTI-DOM-SHIPMENT  TO TRUE                    CG020514
                    END-IF                                              CG020514
                   END-IF                                               CG020514
                                                                                
                   PERFORM 113000A-OBTAIN-SHIPTO-COUNTRY                CG030618
                           THRU 113000A-EXIT                            CG030618
                                                                        CG030618
                   IF COUNTRY-5004  =  'MX' OR                          CG030618
                      COUNTRY-CODE-5004(1) = '052' OR                   CG030618
                      COUNTRY-CODE-5004(1) = '412'                      CG030618
                      MOVE '00'  TO RECEIVABLE-ITEM-NUMBER-2712(1:2)    CG030618
                      MOVE 'N'   TO SW-MR-XB-SHIPMENT                   CG030618
                   ELSE                                                 CG030618
                      MOVE 'MR'  TO RECEIVABLE-ITEM-NUMBER-2712(1:2)    CG020514
                   END-IF                                               CG030618
2SP160          END-IF                                                  CG020514
              END-IF                                                            
150300        MOVE 'DNWMX830' TO UPDATE-USER-2712                               
150400        MOVE SAVE-DATE TO DATE-LAST-ACTIVITY-2712                         
150500        MOVE SAVE-SHIP-FROM TO SOURCE-ID-2712                             
150500        MOVE RECEIVABLE-ITEM-NUMBER-2712                          CG221205
150500                            TO WS-SAVE-INVOICE-NBR                CG221205
150600        STORE AR-INVOICE-HDR                                              
150700          ON ANY-ERROR-STATUS                                             
150800             NEXT SENTENCE.                                               
                                                                                
              IF CROSS-BORDER-TRANSFER AND                              CG040330
                 WSC-INV-NUMBER = SPACES                                CG040330
                 MOVE '022' TO WCR-ERROR-CODE                           CG040330
                 MOVE 'INVOICE NOT FOUND' TO WCR-ERROR-TEXT             CG040330
                 PERFORM 9999999-ABORT THRU 9999999-EXIT                CG040330
              END-IF.                                                   CG040330
                                                                                
151000     IF DOMESTIC-TRANSFER OR LS-CONSIGNMENT OR                            
151010        WSC-INV-NUMBER = SPACES                                           
151100        NEXT SENTENCE                                                     
151200     ELSE                                                                 
151300        IF ERROR-STATUS = '1205' AND CROSS-BORDER-TRANSFER                
151700           MOVE '022' TO WCR-ERROR-CODE                                   
151800           STRING ERROR-STATUS '-MULT SHIPHDR ON INVOICE: '               
151900             WSC-INV-NUMBER DELIMITED BY SIZE INTO                        
152000                WCR-ERROR-TEXT                                            
152100           PERFORM 9999999-ABORT THRU 9999999-EXIT                        
152101        ELSE                                                              
152102           IF ANY-ERROR-STATUS                                            
152103              MOVE '022' TO WCR-ERROR-CODE                                
152104              STRING ERROR-STATUS '-UNABLE TO STORE INVOICE: '            
152105                WSC-INV-NUMBER DELIMITED BY SIZE INTO                     
152106                   WCR-ERROR-TEXT                                         
152107              PERFORM 9999999-ABORT THRU 9999999-EXIT.                    
152200                                                                          
152300                                                                          
152400*        *********************************************                    
152500*        * CONNECT SHIPMENT-HEADER TO AR-INVOICE-HDR *                    
152600*        *********************************************                    
152700     IF DOMESTIC-TRANSFER OR LS-CONSIGNMENT OR                            
152710        WSC-INV-NUMBER = SPACES                                           
152800        NEXT SENTENCE                                                     
152900     ELSE                                                                 
153000        FIND CURRENT SHIPMENT-HEADER                                      
153000        CONNECT SHIPMENT-HEADER TO INVHDR-SHIP                            
153100          ON ANY-ERROR-STATUS                                             
153200             MOVE '023' TO WCR-ERROR-CODE                                 
153300             STRING ERROR-STATUS '-MAKE INVHDR-SHIP CONN: '               
153400               WSC-INV-NUMBER DELIMITED BY SIZE INTO                      
153500                  WCR-ERROR-TEXT                                          
153600             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
153900 EJECT                                                                    
154100*        *********************************************                    
154200*        * PUT TEXT OUT FOR OE IS A CROSS BORDER LOAD*                    
154300*        *********************************************                    
154400                                                                          
154800*        *********************************************                    
154900*        * GET THE CUSTOMER DATA FOR USE IN LATER    *                    
155000*        * MODULES                                   *                    
155100*        *********************************************                    
155200     IF FIRST-SHIP-HDR                                                    
155300        PERFORM 1132000-GET-CUSTOMER THRU 1132000-EXIT.                   
155400                                                                          
      ***   BROKER SHIPMENT MAY NOT BE A NEW CROSS BORDER SHIPMENT *** CG030730 
155400           PERFORM 1132100-GET-BILLTO-ADDR THRU 1132100-EXIT.     CG020220
155400                                                                  CG020220
159100     INITIALIZE TABLE-HDR.                                        CG021211
           INITIALIZE TABLE-DETAIL.                                     CG021211
           MOVE 'N'                  TO CONTROL-TABLE-FLAG              CG021211
159100     MOVE 'NAXBRDPLNT' TO TABLE-KEY-8016.                         CG021211
           OBTAIN CALC TABLE-HDR                                        CG021211
159100     ON DB-REC-NOT-FOUND                                          CG021211
              NEXT SENTENCE                                             CG021211
159100     END-IF                                                       CG021211
159100     IF DB-STATUS-OK                                              CG021211
159100        MOVE 'ALL' TO ENTRY-CODE-8017                             CG021211
              OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL USING               CG021211
159100                                      ENTRY-CODE-8017             CG021211
              ON DB-REC-NOT-FOUND                                       CG021211
159100           MOVE SHIP-PLANT-CODE-3515 TO ENTRY-CODE-8017           CG021211
159100           OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL USING            CG021211
159100                                       ENTRY-CODE-8017            CG021211
159100           ON DB-REC-NOT-FOUND                                    CG021211
159100              NEXT SENTENCE                                       CG021211
159100           END-IF                                                 CG021211
159100        END-IF                                                    CG021211
           IF DB-STATUS-OK                                              CG021211
159100        MOVE 'Y'              TO CONTROL-TABLE-FLAG               CG021211
           END-IF                                                       CG021211
159100     END-IF.                                                      CG021211
159100     IF (CROSS-BORDER-TRANSFER AND NOT MX-SHIP-TO) OR             CG021211
159100        CUSTOMER-NUMBER-3501 = '1032671' OR                       CG021211
159100        (EXPORT-SALES AND                                         CG021211
159100        NOT MARC-EXPORT AND                                       CG021211
159100        NOT UG-EXPORT   AND                                       CG021211
159100        ((US-SHIP-FROM AND CAN-SHIP-TO) OR                        CG021211
159100        (CAN-SHIP-FROM AND US-SHIP-TO)) ) OR                      CG021211
159100        (NEW-XBRD-SHIPMENT AND                                    CG021211
159100        ((US-SHIP-FROM AND CAN-BILL-TO) OR                        CG021211
159100        (CAN-SHIP-FROM AND US-BILL-TO)))                          CG021211
159100         PERFORM 1163500-IMPORT-NUM-MASK THRU 1163500-EXIT        CG021211
159100     END-IF                                                       CG021211
155400                                                                  CG021211
126070     IF FIRST-TIME-FLAG     = 'Y' AND                             CG021211
126070        WSC-IMPORT-FILE-NBR > SPACES AND                          CG160120
              (WSC-TRW-FLAG = 'N' OR WSC-TRW-FLAG = SPACES)             CG160120
126091        PERFORM 1125000-STORE-IF-TEXT THRU 1125000-EXIT           CG021211
126090     END-IF.                                                      CG021211
155400                                                                  CG021211
154500      IF CROSS-BORDER-TRANSFER                                    CG021211
154600        PERFORM 1131000-PROCESS-XBRD-TEXT THRU 1131000-EXIT       CG021211
126090      END-IF                                                      CG021211
155400                                                                  CG021211
155500*        *********************************************                    
155600*        * THE ETA DATE ON THE BOL RECORD MUST BE    *                    
155700*        * CALCULATED IN THIS PROGRAM SINCE WICS DOES*                    
155800*        * NOT HAVE THE ETA TABLE TO DO SO.          *                    
155900*        * THE ETA DATE IS POPULATED ON THE BILL-OF- *                    
156000*        * LADING RECORD NOW INSTEAD OF EARLIER WHEN *                    
156100*        * THE RECORD WAS STORED DUE TO THE FACT THAT*                    
156200*        * ORDER-TYPE IS USED TO DETERMINE CALCULA-  *                    
156300*        * TION OF ETA DATE.  WE DO NOT KNOW ORDER   *                    
156400*        * TYPE UNTIL THE SHIPMENT-HEADER (03) RECORD*                    
156500*        * IS PASSED.                                *                    
156600*        *********************************************                    
156700                                                                          
156800     IF FIRST-SHIP-HDR                                                    
156900        IF CROSS-BORDER-TRANSFER OR DOMESTIC-TRANSFER                     
                IF WSC-TRW-FLAG = 'N' OR                                CG151007
                   WSC-TRW-FLAG = SPACES                                CG151007
157000           MOVE SPACES TO SAVE-ETA-DATE                                   
                 PERFORM 1136000-CALCULATE-IRD-ETA                      CG070201
                                       THRU 1136000-EXIT                CG070201
                END-IF                                                  CG151007
                 IF WS-CDD             = ZEROES AND                     CG151007
                    (WSC-TRW-FLAG = 'N' OR                              CG151007
                     WSC-TRW-FLAG = SPACES)                             CG151007
157300              MOVE '073' TO WCR-ERROR-CODE                                
157400              STRING 'ETA DATE COULD NOT BE CALCULATED:'                  
157500               '"' SAVE-ETA-DATE '"'                                      
157600                DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                    
157700              PERFORM 9999999-ABORT THRU 9999999-EXIT                     
157800           ELSE                                                           
                    FIND CURRENT LOAD                                   CG070201
                    IF WSC-TRW-FLAG = 'Y'                               CG151007
                       MOVE WSC-DT-CUST-DUE TO CUST-DUE-DATE-8009       CG151007
                                               INVENTORY-RECV-DAT-8009  CG151007
                    ELSE                                                CG151007
                       MOVE WS-CDD        TO CUST-DUE-DATE-8009         CG070201
                       MOVE WS-IRD        TO INVENTORY-RECV-DAT-8009    CG070201
                    END-IF                                              CG151007
                    MODIFY LOAD                                         CG070201
157900              FIND CURRENT BILL-OF-LADING                                 
                    IF WSC-TRW-FLAG = 'Y'                               CG151007
                       MOVE WSC-DT-CUST-DUE TO WHSE-ETA-DATE-3555       CG070201
                    ELSE                                                CG151007
                       MOVE WS-CDD        TO WHSE-ETA-DATE-3555         CG070201
                    END-IF                                              CG151007
158100              MODIFY BILL-OF-LADING                                       
158200                ON ANY-ERROR-STATUS                                       
158300                   MOVE '078' TO WCR-ERROR-CODE                           
158400                   STRING ERROR-STATUS '-UPDATE ETA DATE '                
158500                     WSC-BOL DELIMITED BY SIZE INTO                       
158600                       WCR-ERROR-TEXT                                     
158700                   PERFORM 9999999-ABORT THRU 9999999-EXIT.               
158800                                                                          
158900*        *********************************************                    
159000*        * THIS PROCESSING SHOULD BE PER BOL; BUT WE *                    
159100*        * NEED ORDER TYPE AND CUSTOMER DATA TO      *                    
159200*        * PROCESS WHICH IS WHY IT IS DONE IN THIS   *                    
159300*        * MODULE.                                   *                    
159400*        * THEREFORE, A FIRST SHIPMENT-HEADER FLAG   *                    
159500*        * IS USED TO INSURE THAT IT IS DONE ONLY    *                    
159600*        * ONCE PER BOL.                             *                    
159700*        *                                           *                    
159800*        * SUBMIT JCL TO THE INTERNAL READER TO      *                    
159900*        * SET UP INTRANSIT TO RECEIVING FACILITY.   *                    
160000*        * THIS JCL MUST BE SUBMITTED PER BOL DUE TO *                    
160100*        * THE FACT THAT DIFFERENT JCL MUST BE       *                    
160200*        * SUBMITTED DEPENDING ON SHIP TO. THEREFORE,*                    
160300*        * THERE WILL BE AS MANY INTRANSIT LOADS     *                    
160400*        * ON THE RECEIVING DATABASE AS THERE ARE    *                    
160500*        * BOL(S)/STOP(S) ON THE SENDING DATABASE    *                    
160600*        * LOAD.                                     *                    
160700*        *                                           *                    
160800*        * FOR DOMESTIC SHIPMENTS FROM WMS TO WICS   *                    
160900*        * JCL IS NOT SUBMITTED BUT THE TASK         *                    
161000*        * "WICSINBD" MUST BE INITIATED IN ORDER TO  *                    
161100*        * SET UP INTRANSIT ON WICS.                 *                    
161200*        *                                           *                    
161300*        * THE ONLY TRANSFER SHIPMENTS EXCLUDED FROM *                    
161400*        * THIS PROCESS IS:                          *                    
161500*        *  - ANY FACILITY SHIPPING TO UG            *                    
161600*        *    BECAUSE UG NOT ON SDS YET.             *                    
161700*        *  - CANADIAN T/DC SHIPPING TO ANY OTHER    *                    
161800*        *    CANADIAN T/DC NOT ON WICS; THE INTRAN- *                    
161900*        *    SIT IS ESTABLISHED BY PRINTBOL.        *                    
162000*        *  - US T/DC SHIPPING TO ANY OTHER T/DC NOT *                    
162100*        *    ON WICS; THE INTRANSIT IS ESTABLISHED  *                    
162200*        *    BY PRINTBOL.                           *                    
162300*        *                                           *                    
162400*        * EXPORT SHIPMENTS FROM CA TO US CUSTOMER OR*                    
162500*        * US TO CAN CUSTOMER MUST GO THRU A PAPER   *                    
162600*        * WAREHOUSE WHICH MEANS THE LOAD LOOKS LIKE *                    
162700*        * A CROSS BORDER INTRANSIT.                 *                    
162701*        *                                           *                    
162702*        * WE NO LONGER EXCLUDE ANY FACILITY SHIPPING*            000014LJ
162703*        * TO UG BECAUSE OF 01/01/94 LEGAL ENTITY    *            000014LJ
162704*        * REQUIREMENTS.                             *            000014LJ
162705*        *                                           *                    
162706*        * STILL NEED TO EXCLUDE ANY FACILITY SHIP-  *            000015LJ
162707*        * PING TO A U.S. UG FACILITY BECAUSE U.S. UG*            000015LJ
162708*        * IS NOT ON SDS YET.  THIS CODE WILL NEED TO*            000015LJ
162709*        * BE REMOVED FOR THE JULY 1994 UG IMPLEMEN- *            000015LJ
162710*        * TATION.                                   *            000015LJ
162800*        *********************************************                    
163000     IF FIRST-SHIP-HDR                                            000014LJ
163002        MOVE 'N' TO SW-FIRST-SHIP-HDR                                     
163003        IF (NOT MX-SHIP-TO)  AND                                  000033DB
                 (NOT MX-BILL-TO)  AND                                  CG030730
163100           (CROSS-BORDER-TRANSFER  OR                                     
163200            PAPER-WHSE-REQD OR                                            
163300           ((WICS-SHIP-FROM OR GEODE-SHIP-FROM) AND               CG110705
163310             WMS-SHIP-TO  AND DOMESTIC-TRANSFER) OR               CG110705
                   (NEW-XBRD-SHIPMENT)  OR                              CG020514
                   (SAVE-MRTI-FLAG       = 'N'))                        CG020514
163400              PERFORM 1133000-SUBMIT-JCL THRU 1133000-EXIT                
163500        ELSE                                                              
163600           IF WICS-SHIP-TO AND DOMESTIC-TRANSFER                          
163700              PERFORM 1134000-INIT-WICSINBD THRU 1134000-EXIT     CG041214
                 END-IF                                                 CG041214
              END-IF                                                    CG041214
169200        IF (((WS-US-SHIP-TO     AND CAN-SHIP-FROM) OR             CG041214
169200           (WS-CAN-SHIP-TO     AND US-SHIP-FROM)) AND             CG041214
169200           CONTROL-TABLE-FLAG = 'Y') AND                          CG041214
                 (SAVE-MRTI-FLAG NOT = 'N') AND                         CG100106
                   WS-SOLOMON-PLANT = 'N'                               CG100106
169200              PERFORM 1168000-SUBMIT-JCL THRU 1168000-EXIT        CG041214
169200        END-IF                                                    CG041214
169200     END-IF.                                                      CG041214
                                                                                
           IF (MEXICAN-XBRD-FLAG = 'Y' OR MX-BILL-TO) AND               CG030730
163700        SAVE-MRTI-FLAG       NOT = 'N'                            CG020514
163700         PERFORM 1133000-SUBMIT-JCL THRU 1133000-EXIT.            IM011023
163700                                                                  IM011023
169200                                                                  CG021211
           IF WS-C-LOAD-NBR > SPACES                                    CG240716
              PERFORM 1133900-LOAD-NBR-GEODE THRU 1133900-EXIT          CG240716
           END-IF.                                                      CG240716
                                                                        CG240716
163800 1130000-EXIT. EXIT.                                                      
                                                                                
      ******************************************************************CG030618
      *  THIS ROUTINE IS CALLED TO OBTAIN THE SHIP-TO COUNTRY CODE SUCH*CG030618
      *  THAT FOR US/CA TO MX SHIPMENTS DO NOT TRIGER THE MRTIDOM JOB  *CG030618
      *  AND NO 'MR' INVOICES ARE GENERATED.                           *CG030618
      ******************************************************************CG030618
       113000A-OBTAIN-SHIPTO-COUNTRY.                                   CG030618
                                                                        CG030618
           MOVE WSC-CUSTOMER TO BUSINESS-NUMBER-5050.                   CG030618
           FIND CALC BUSINESS                                           CG030618
           ON ANY-ERROR-STATUS                                          CG030618
              MOVE '043' TO WCR-ERROR-CODE                              CG030618
              STRING ERROR-STATUS '-BUSINESS NOT FOUND: '               CG030618
                     WSC-CUSTOMER DELIMITED BY SIZE INTO                CG030618
                     WCR-ERROR-TEXT                                     CG030618
                    PERFORM 9999999-ABORT THRU 9999999-EXIT.            CG030618
                                                                        CG030618
           FIND FIRST ADDRSS-ID WITHIN BUS-ADDRID                       CG030618
           ON ANY-ERROR-STATUS                                          CG030618
              MOVE '046' TO WCR-ERROR-CODE                              CG030618
              STRING ERROR-STATUS '-ADDRSS-ID  NOT FOUND: '             CG030618
                     CUSTOMER-NUMBER-3501 ' '                           CG030618
                     DELIMITED BY SIZE INTO                             CG030618
                     WCR-ERROR-TEXT                                     CG030618
                     PERFORM 9999999-ABORT THRU 9999999-EXIT.           CG030618
                                                                        CG030618
           OBTAIN OWNER WITHIN ADDR-ADDRID                              CG030618
           ON ANY-ERROR-STATUS                                          CG030618
              MOVE '047' TO WCR-ERROR-CODE                              CG030618
              STRING ERROR-STATUS '-ADDRSS NOT FOUND: '                 CG030618
                     CUSTOMER-NUMBER-3501 ' '                           CG030618
                     DELIMITED BY SIZE INTO                             CG030618
                     WCR-ERROR-TEXT                                     CG030618
                     PERFORM 9999999-ABORT THRU 9999999-EXIT.           CG030618
                                                                        CG030618
       113000A-EXIT. EXIT.                                              CG030618
                                                                        CG030618
                                                                                
163900 EJECT                                                                    
164000*****************************************************************         
164100*     THE FOLLOWING TEXT RECORDS ARE BUILT IN ORDER FOR:        *         
164200*      1)  BATCH OE TO KNOW WHICH CROSS BORDER LOADS IT NEEDS TO*         
164300*          BUILD DEBIT  ORDERS FOR;                             *         
164400*      2)  NAIT BATCH JOB TO KNOW WHICH INTRANSITS IT NEEDS TO  *         
164500*          INCLUDE IN ITS FILE; THIS IS OBSOLETE IN JULY WHEN   *         
164600*          NYA GOES AWAY.                                       *         
164700*      3)  SCT BATCH JOB TO KNOW WHICH CANADIAN EXPORTS HAVE    *         
164800*          OCCURRED.  INDICATOR 5 IS NEEDED TO SEPARATE CANADA  *         
164900*          FROM US SHIPMENTS.                                   *         
165000*                                                               *         
165100*      NOTE:  THE SCT BATCH JOB WILL HANDLE DELETION OF THESE   *         
165200*             TEXT RECORDS; IT WILL NOT DELETE UNTIL BATCH OE   *         
165300*             AND NAIT HAVE MARKED THE RECORDS AS BEING PROCES- *         
165400*             SED BY THEM.                                      *         
165500*               TEXT-HEADER CALCKEY = 'XBRDNOTIFY'              *         
165600*               TEXT-LINE = LOAD # X(6)                         *         
165700*                           INVOICE NUMBER      X(12)           *         
165800*                           INDICATOR 1         X(01)           *         
165900*                              "X" - CROSS-BORDER IDENTIFIER    *         
166000*                           INDICATOR 2         X(01)           *         
166100*                              "Y" - PROCESSED BY OE            *         
166200*                           INDICATOR 3         X(01)           *         
166300*                              "Y" - PROCESSED BY NAIT          *         
166310*                           IMPORT FILE NUMBER  X(12)           * 000026LD
166400*****************************************************************         
166500 1131000-PROCESS-XBRD-TEXT.                                               
      *                                                                         
           IF WSC-TRW-FLAG = 'Y'                                        CG160520
              IF WSC-GOVT-CTRCT-NBR(1:2) = 'TP'                         CG200506
                 INITIALIZE WS-LOAD-ID-SHORT                            CG200506
                 INITIALIZE TEXT-HEADER                                 CG200506
                 MOVE WSC-GOVT-CTRCT-NBR(3:7) TO WS-LOAD-ID-SHORT       CG200506
                 MOVE 'WMS '        TO TEXT-TYPE-CODE-951               CG200506
                 STRING 'IF' WS-LOAD-ID-SHORT DELIMITED BY SIZE         CG200506
                                       INTO TEXT-KEY-951                CG200506
                 END-STRING                                             CG200506
                 OBTAIN CALC TEXT-HEADER                                CG200506
                 ON ANY-ERROR-STATUS                                    CG200506
                    CONTINUE                                            CG200506
                 END-IF                                                 CG200506
                 IF DB-STATUS-OK                                        CG200506
                    STRING 'IF'                                         CG200506
                           WSC-BOL DELIMITED BY SPACES                  CG200506
                                       INTO TEXT-KEY-951                CG200506
                    MODIFY TEXT-HEADER                                  CG200506
                    ON ANY-ERROR-STATUS                                 CG200506
                       CONTINUE                                         CG200506
                    END-IF                                              CG200506
                    IF DB-STATUS-OK                                     CG200506
                       SET WS-IFNUM-SWAP-YES TO TRUE                    CG200506
                    ELSE                                                CG200506
                       MOVE '117' TO WCR-ERROR-CODE                     CG200506
                       STRING 'MODIFY-FAILED-FOR-IF# '                  CG200506
                              WSC-GOVT-CTRCT-NBR(3:7) DELIMITED BY SPACECG200506
                              INTO WCR-ERROR-TEXT                       CG200506
                       END-STRING                                       CG200506
                       PERFORM 9999999-ABORT THRU 9999999-EXIT          CG200506
                    END-IF                                              CG200506
                 ELSE                                                   CG200506
                    IF WS-IFNUM-SWAP-YES                                CG200506
                       CONTINUE                                         CG200506
                    ELSE                                                CG200506
                       MOVE '118' TO WCR-ERROR-CODE                     CG200506
                       STRING 'IF#-NOT-FOUND-FOR '                      CG200506
                              WSC-GOVT-CTRCT-NBR(3:7) DELIMITED BY SPACECG200506
                              INTO WCR-ERROR-TEXT                       CG200506
                       END-STRING                                       CG200506
                       PERFORM 9999999-ABORT THRU 9999999-EXIT          CG200506
                    END-IF                                              CG200506
                 END-IF                                                 CG200506
              END-IF                                                    CG200506
              INITIALIZE TEXT-HEADER                                    CG160520
              MOVE 'WMS '              TO TEXT-TYPE-CODE-951            CG160520
              STRING 'IF'  WSC-BOL  DELIMITED BY SIZE                   CG160520
                                       INTO TEXT-KEY-951                CG160520
              OBTAIN CALC TEXT-HEADER                                   CG160520
              ON ANY-ERROR-STATUS                                       CG160520
                 CONTINUE                                               CG160520
              END-IF                                                    CG160520
              OBTAIN FIRST TEXT-LINE WITHIN TEXT-DETAIL                 CG160520
              ON ANY-ERROR-STATUS                                       CG160520
                 CONTINUE                                               CG160520
              END-IF                                                    CG160520
              IF DB-STATUS-OK                                           CG160520
                 MOVE TEXT-DETAIL-LINE-952                              CG160520
                                       TO WS-WMS-IMPT-FILE-NBR          CG160520
              ELSE                                                      CG160520
                 MOVE SPACES           TO WS-WMS-IMPT-FILE-NBR          CG160520
              END-IF                                                    CG160520
           END-IF.                                                      CG160520
      *                                                                         
166600     INITIALIZE TEXT-HEADER.                                              
166700     MOVE 'XBRD' TO TEXT-TYPE-CODE-951.                                   
166800     MOVE 'NOTIFY' TO TEXT-KEY-951.                                       
166900     FIND KEEP EXCLUSIVE CALC TEXT-HEADER                                 
167000       ON ANY-ERROR-STATUS                                                
167100          NEXT SENTENCE.                                                  
167200                                                                          
167300     IF DB-REC-NOT-FOUND                                                  
167400        STORE TEXT-HEADER                                                 
167500          ON ANY-ERROR-STATUS                                             
167600             NEXT SENTENCE.                                               
167700                                                                          
167800     IF NOT DB-STATUS-OK                                                  
167900        MOVE '027' TO WCR-ERROR-CODE                                      
168000        STRING ERROR-STATUS                                               
168100          '-XBRDNOTIFY TEXT HEADER ERROR: ' WSC-INV-NUMBER                
168200             DELIMITED BY SIZE INTO                                       
168300             WCR-ERROR-TEXT                                               
168400        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
168500                                                                          
168600     INITIALIZE TEXT-LINE.                                                
168700     MOVE LOAD-NUMBER-8009        TO XBRD-LOAD.                           
168800     MOVE WSC-INV-NUMBER TO XBRD-INVOICE.                                 
168900     MOVE 'X' TO XBRD-INDICATOR.                                          
           IF WSC-TRW-FLAG = 'Y'                                        CG160520
             MOVE WS-WMS-IMPT-FILE-NBR TO XBRD-IMPORT-FILE-NBR          CG160520
           ELSE                                                         CG160520
168910       MOVE WSC-IMPORT-FILE-NBR  TO XBRD-IMPORT-FILE-NBR          CG160520
           END-IF.                                                      CG160520
169000     MOVE WORK-XBRD-TEXT TO TEXT-LINE.                                    
169100     STORE TEXT-LINE                                                      
169200       ON ANY-ERROR-STATUS                                                
169300          MOVE '028' TO WCR-ERROR-CODE                                    
169400          STRING ERROR-STATUS                                             
169500            '-XBRDNOTIFY TEXT LINE ERROR: '                               
169600               WSC-INV-NUMBER                                             
169700                 DELIMITED BY SIZE INTO                                   
169800                   WCR-ERROR-TEXT                                         
169900          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
170000                                                                          
170001*        *********************************************                    
170002*        * BOTH THE UGMT AND THE XBRDNOTIFY CANNOT BE*                    
170003*        * STORED FOR A LOAD; THEREFORE IF UGMT ENTRY*                    
170004*        * WAS STORED EARLIER IN MODULE 1122000,     *                    
170005*        * BACK IT OUT HERE SO THAT A DOUBLE INVOICE *                    
170006*        * WILL NOT BE PRODUCED.                     *                    
170007*        *                                           *                    
170008*        * UGMT PROCESSING HAS BEEN BLOCKED BECAUSE  *            000014LJ
170009*        * OF 01/01/94 LEGAL ENTITY REQUIREMENTS. NO *            000014LJ
170010*        * NEED TO CHECK FOR TABLE ENTRY OR BACK IT  *            000014LJ
170011*        * OUT.                                      *            000014LJ
170012*        *********************************************                    
170018                                                                          
170100 1131000-EXIT. EXIT.                                                      
170200 EJECT                                                                    
170300*************************************************************             
170400*  THE CUSTOMER RECORD IS OBTAINED TO GET THE SERVICING DC  *             
170500*  FOR LOGICAL STOCK                                        *             
170600*                                                           *             
170700*  COUNTRY CODE IS NEEDED IN ORDER TO DETERMINE IF FOR AN   *             
170800*  EXPORT SALES THE CUSTOMER IS CANADA OR US IN WHICH CASE  *             
170900*  A BEHIND THE SCENES TRANSFER MUST BE CREATED TO A PAPER  *             
171000*  WAREHOUSE FOR THIS SHIPMENT.                             *             
171100*     IF THE SHIPMENT IS TO THE US, THEN THE RECEIVING      *             
171200*     PAPER DEPENDS ON THE CSR THAT SCHEDULED THE ORDER.    *             
171300*     IF THE SHIPMENT IS TO CANADA, THEN THE RECEIVING      *             
171400*     PAPER WHSE IS C21.                                    *             
171500*     IF THE SHIPMENT IS TO 1032671,THEN THE RECEIVING      *             
171600*     PAPER WHSE IS C21.                                    *             
171700*************************************************************             
171800 1132000-GET-CUSTOMER.                                                    
171900     MOVE WSC-CUSTOMER TO BUSINESS-NUMBER-5050.                           
172000     OBTAIN CALC BUSINESS                                                 
172100       ON ANY-ERROR-STATUS                                                
172200          MOVE '043' TO WCR-ERROR-CODE                                    
172300          STRING ERROR-STATUS '-BUSINESS NOT FOUND: '                     
172400            WSC-CUSTOMER DELIMITED BY SIZE INTO                           
172500               WCR-ERROR-TEXT                                             
172600          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
172700                                                                          
172800     OBTAIN NEXT CUSTOMER WITHIN BUS-ROLE                                 
172900       ON ANY-ERROR-STATUS                                                
173000          MOVE '045' TO WCR-ERROR-CODE                                    
173100          STRING ERROR-STATUS '-CUSTOMER NOT FOUND: '                     
173200            WSC-CUSTOMER ' '                                              
173300              DELIMITED BY SIZE INTO                                      
173400               WCR-ERROR-TEXT                                             
173500          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
173600                                                                          
173700     MOVE CUST-CATEG-3501 TO SAVE-CUST-CATEG.                     000021LJ
173800     MOVE CUST-CHNL-3501 TO SAVE-CUST-CHNL.                       000021LJ
173900     MOVE CUST-SUB-CHNL-3501 TO SAVE-CUST-SUB-CHNL.               000021LJ
174000                                                                          
174001     IF US-SHIP-FROM                                              000018GT
140070        IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER             P14996  
140070            MOVE SPACES TO DFLT-ZIP-ADDRS-ID                      P14996  
140070        ELSE                                                      P14996  
140070            MOVE SHIP-TO-ADDR-TYPE-3510 TO DFLT-ZIP-ADDRS-ID      P14996  
140070        END-IF                                                    P14996  
174002        MOVE CUSTOMER-NUMBER-3501 TO DFLT-SHIP-TO-BUSINESS        000018GT
234100        TRANSFER CONTROL TO 'SAORP019' LINK                               
234101                           USING ZIP-DEFAULT-DATA                 000018GT
234102                                 SUBSCHEMA-CTRL                   000018GT
234103        MOVE DFLT-SHIP-PLANT-CODE TO SAVE-SERVICING-DC            000018GT
234104        BIND BUSINESS                                             000019GT
234105        BIND ADDRSS                                               000019GT
234106        BIND ADDRSS-ID                                            000019GT
234107     ELSE                                                         000018GT
234108        MOVE SHIP-PLANT-CODE-3501(1) TO SAVE-SERVICING-DC.                
234109                                                                          
234110     FIND FIRST ADDRSS-ID WITHIN BUS-ADDRID                               
234111       ON ANY-ERROR-STATUS                                                
234112          MOVE '046' TO WCR-ERROR-CODE                                    
234113          STRING ERROR-STATUS '-ADDRSS-ID  NOT FOUND: '                   
234114            CUSTOMER-NUMBER-3501 ' '                                      
234115             DELIMITED BY SIZE INTO                                       
234116               WCR-ERROR-TEXT                                             
234117          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
234118                                                                          
234119     OBTAIN OWNER WITHIN ADDR-ADDRID                                      
234120       ON ANY-ERROR-STATUS                                                
234121          MOVE '047' TO WCR-ERROR-CODE                                    
234122          STRING ERROR-STATUS '-ADDRSS NOT FOUND: '                       
234123            CUSTOMER-NUMBER-3501 ' '                                      
234124             DELIMITED BY SIZE INTO                                       
234125               WCR-ERROR-TEXT                                             
234126          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
234127                                                                          
234127     IF COUNTRY-5004  =  'MX' OR                                  IM011023
234127        COUNTRY-CODE-5004(1) = '052' OR                           IM011023
234127        COUNTRY-CODE-5004(1) = '412'                              CG020509
234127        MOVE 'Y' TO MEXICAN-XBRD-FLAG.                            IM011023
234128                                                                          
234127      MOVE COUNTRY-5004       TO WS-SHIP-TO                       CG030203
234128*                                                                         
234129*        *********************************************                    
234130*        *    SET PAPER WHSE AUTOMATICALLY TO C21    *                    
234131*        *    IF SHIPPING TO CUSTOMER 1032671; THIS  *                    
234132*        *    IS A CANADIAN CUSTOMER WITH A US       *                    
234133*        *    ADDRESS.                               *                    
234134*        *********************************************                    
234135                                                                          
234136                                                                          
234137      IF CUSTOMER-NUMBER-3501 = '1032671'                                 
234138         MOVE 'Y' TO SW-PAPER-WHSE                                        
234139         MOVE 'C21' TO SAVE-SHIP-TO                                       
234140         MOVE 'M' TO SAVE-SHIP-TO-COMPANY                                 
234141         MOVE 'Y' TO SAVE-SHIP-TO-WMS-IND                                 
234142         MOVE ' ' TO SAVE-SHIP-TO-WICS-IND                                
234143         GO TO 1132000-EXIT.                                              
234144*                                                                         
234145*        *********************************************                    
234146*        *    DETERMINE WHICH PAPER WAREHOUSE TO USE *                    
234147*        *    FOR CROSS COUNTRY N.A. SHIPMENTS       *                    
234148*        *********************************************                    
234149                                                                          
234150      IF EXPORT-SALES                                                     
234151         MOVE WSC-SDS-ORDER TO WORK-SALES-ORDER                           
            ELSE                                                                
234150        IF (DOMESTIC-SALES AND  NEW-XBRD-SHIPMENT)                CG020514
234150           OR SAVE-MRTI-FLAG       = 'N'                          CG020514
234150           CONTINUE                                               CG020220
234150        ELSE                                                      CG020220
234153         GO TO 1132000-EXIT.                                              
234154                                                                          
234155                                                                  000001SA
234156*        *********************************************                    
234157*        * IF AN EXPORT FROM (US TO CA) OR (CA TO US)*                    
234158*        * SET UP THE SHIP TO AS BEING A PAPER WHSE. *                    
234159*        * NOTE, HOWEVER, THAT CU1 IS EXCLUDED FROM  *                    
234160*        * THIS CODE.                                *                    
234161*        *                                           *                    
234162*        * CU1 IS NO LONGER EXCLUDED FROM THIS CODE. *            000014LJ
234163*        * PROCESS THRU PAPER WHSE BEGINNING 01/01/94*            000014LJ
234164*        * BECAUSE OF LEGAL ENTITY REQUIREMENTS.     *            000014LJ
234165*        *********************************************                    
234166                                                                          
234170*        ***********************************                              
234171*        * IF CANADA SHIPPING TO THE US    *                              
234172*        * AND THE US CUSTOMER IS MARC,    *                              
234173*        * DON'T PROCESS IT THRU PAPER WHSE*                              
234174*        ***********************************                              
234175     IF CUST-CHNL-3501 = '01' AND                                         
234176        CUST-SUB-CHNL-3501 = '029'                                        
296309        MOVE 'Y' TO MARC-EXPORT-FLAG                              CG021211
234177        GO TO 1132000-EXIT.                                               
234178                                                                          
234179*        ***********************************                      000021LJ
234180*        * IF UG EXPORT (CUST-CATEG=30,    *                      000021LJ
234181*        * CHNL=16, AND SUB=CHNL=004),     *                      000021LJ
234182*        * DON'T PROCESS IT THRU PAPER WHSE UNLESS MTC BILLTO*    WE941105
234183*        *****************************************************    000021LJ
234184     IF CUST-CATEG-3501 = '30' AND                                000021LJ
234185        CUST-CHNL-3501 = '16' AND                                 000021LJ
234186        CUST-SUB-CHNL-3501 = '004'                                000021LJ
296900         MOVE 'Y' TO UG-EXPORT-FLAG                               CG021211
234187         IF BILL-TO-BUSINESS-3501 = '1000042' OR '0120011'        WE941105
234188           NEXT SENTENCE                                          WE941105
234189         ELSE                                                     WE941105
234190        GO TO 1132000-EXIT.                                       WE941105
234191                                                                          
234192      IF COUNTRY-CODE-5004(1) = '999' OR                          CG020111
234192         COUNTRY-CODE-5004(1) = '404'                             CG020111
234193         MOVE 'Y' TO SW-PAPER-WHSE                                000001SA
234194         MOVE 'C21' TO SAVE-SHIP-TO                               000001SA
234195         MOVE 'M' TO SAVE-SHIP-TO-COMPANY                         000001SA
234196         MOVE 'Y' TO SAVE-SHIP-TO-WMS-IND                                 
234197         MOVE ' ' TO SAVE-SHIP-TO-WICS-IND.                       000001SA
234198                                                                  000001SA
234199      IF COUNTRY-CODE-5004(1) = '000' OR                          000001SA
234199         COUNTRY-CODE-5004(1) = '400'                             000001SA
234200         MOVE 'Y' TO SW-PAPER-WHSE                                000001SA
234201         MOVE 'M' TO SAVE-SHIP-TO-COMPANY                         000001SA
234202         MOVE 'Y' TO SAVE-SHIP-TO-WMS-IND                                 
234203         MOVE ' ' TO SAVE-SHIP-TO-WICS-IND                        000001SA
234204         IF U24-CSR                                               000001SA
234205            MOVE 'U24' TO SAVE-SHIP-TO                            000001SA
234206         ELSE                                                     000001SA
234207            IF U09-CSR                                            000001SA
234208               MOVE 'U09' TO SAVE-SHIP-TO                         000001SA
234209            ELSE                                                  000001SA
234210               MOVE 'U74' TO SAVE-SHIP-TO.                        000001SA
234211 1132000-EXIT. EXIT.                                                      
234212 EJECT                                                                    
      ****************************************************************  CG020220
      *THIS PARA GETS THE COUNTRY FOR THE BILL TO CUSTOMER.THIS WILL *  CG020220
      * BE USED INSTEAD OF SHIP TO COUNTRY WHILE BUILDING THE JCL    *  CG020220
      * IN CASE THE SHIP-FROM AND SHIP-TO COUNTRIES ARE SAME.        *  CG020220
      ****************************************************************  CG020220
       1132100-GET-BILLTO-ADDR.                                         CG020220
                                                                        CG020220
           MOVE WSC-CUSTOMER TO BUSINESS-NUMBER-5050.                   CG020220
           OBTAIN CALC BUSINESS                                         CG020220
             ON ANY-ERROR-STATUS                                        CG020220
                MOVE '043' TO WCR-ERROR-CODE                            CG020220
                STRING ERROR-STATUS '-BUSINESS NOT FOUND: '             CG020220
                  WSC-CUSTOMER DELIMITED BY SIZE INTO                   CG020220
                     WCR-ERROR-TEXT                                     CG020220
                PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG020220
                                                                        CG020220
           OBTAIN FIRST CUSTOMER WITHIN BUS-ROLE                        CG020220
             ON ANY-ERROR-STATUS                                        CG020220
                MOVE '045' TO WCR-ERROR-CODE                            CG020220
                STRING ERROR-STATUS '-CUSTOMER NOT FOUND: '             CG020220
                  WSC-CUSTOMER DELIMITED BY SIZE INTO                   CG020220
                     WCR-ERROR-TEXT                                     CG020220
                PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG020220
                                                                        CG020220
           MOVE BILL-TO-BUSINESS-3501 TO BUSINESS-NUMBER-5050.          CG020220
           OBTAIN CALC BUSINESS                                         CG020220
             ON ANY-ERROR-STATUS                                        CG020220
                MOVE '043' TO WCR-ERROR-CODE                            CG020220
                STRING ERROR-STATUS '-CUSTOMER NOT FOUND: '             CG020220
            BILL-TO-BUSINESS-3501 DELIMITED BY SIZE INTO                CG020220
                     WCR-ERROR-TEXT                                     CG020220
                PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG020220
                                                                        CG020220
           FIND FIRST ADDRSS-ID WITHIN BUS-ADDRID                       CG020220
             ON ANY-ERROR-STATUS                                        CG020220
                MOVE '046' TO WCR-ERROR-CODE                            CG020220
                STRING ERROR-STATUS '-ADDRSS-ID  NOT FOUND: '           CG020220
                  CUSTOMER-NUMBER-3501 ' '                              CG020220
                   DELIMITED BY SIZE INTO                               CG020220
                     WCR-ERROR-TEXT                                     CG020220
                PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG020220
                                                                        CG020220
           OBTAIN OWNER WITHIN ADDR-ADDRID                              CG020220
             ON ANY-ERROR-STATUS                                        CG020220
                MOVE '047' TO WCR-ERROR-CODE                            CG020220
                STRING ERROR-STATUS '-ADDRSS NOT FOUND: '               CG020220
                  CUSTOMER-NUMBER-3501 ' '                              CG020220
                   DELIMITED BY SIZE INTO                               CG020220
                     WCR-ERROR-TEXT                                     CG020220
                PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG020220
                                                                        CG020220
           IF COUNTRY-5004         = 'US' OR                            CG020220
              COUNTRY-CODE-5004(1) = '000' OR                           CG020220
              COUNTRY-CODE-5004(1) = '400'                              CG020220
              MOVE 'US' TO SAVE-BILL-TO                                 CG030130
              GO TO 1132100-EXIT.                                       CG020220
                                                                        CG020220
           IF COUNTRY-5004         = 'CA'  OR                           CG020220
              COUNTRY-CODE-5004(1) = '999' OR                           CG020220
              COUNTRY-CODE-5004(1) = '404'                              CG020220
              MOVE 'CA' TO SAVE-BILL-TO.                                CG030130
                                                                        CG020220
           IF COUNTRY-5004         = 'MX'  OR                           CG030730
              COUNTRY-CODE-5004(1) = '052' OR                           CG030730
              COUNTRY-CODE-5004(1) = '412'                              CG030730
              MOVE 'MX' TO SAVE-BILL-TO.                                CG030730
                                                                        CG020220
       1132100-EXIT.                                                    CG020220
               EXIT.                                                    CG020220
                                                                        CG020220
170600 1163500-IMPORT-NUM-MASK.                                         CG021211
170600     INITIALIZE NUMBER-MASK                                       CG021211
                      PREFIX-MASK.                                      CG021211
170600                                                                  CG021211
           IF WSC-TRW-FLAG = 'Y'                                        CG151216
              GO TO 1163500-EXIT                                        CG151216
           END-IF.                                                      CG151216
170600     IF WSC-IMPORT-FILE-NBR >  SPACES                             CG021211
170600        GO TO 1163500-EXIT                                        CG021211
170600     END-IF.                                                      CG021211
170600                                                                  CG021211
170600     IF CONTROL-TABLE-FLAG NOT = 'Y'                              CG030114
294700          STRING '0326'                                           CG030114
294800            'NAXBRDPLNT SET UP NOT FOUND FOR '                    CG030114
294900            SHIP-PLANT-CODE-3515                                  CG030114
295000                DELIMITED BY SIZE INTO WCR-ERROR-TEXT             CG030114
295200          PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG030114
                                                                        CG030114
           MOVE 'IMPTFL'     TO NUMBER-TYPE-4010.                       CG020220
0600       OBTAIN CALC NUMBER-MASK                                      CG021211
0600       ON DB-REC-NOT-FOUND                                          CG021211
              MOVE  50000  TO LAST-NUMBER-GENERATED-4010                CG021211
0600          MOVE  5      TO NUMBER-SIZE-4010                          CG021211
0600          MOVE 1          TO INCREMENTED-BY-4010                    CG021211
0600          STORE NUMBER-MASK                                         CG021211
           END-IF                                                       CG021211
           IF LAST-NUMBER-GENERATED-4010 = 99999                        CG021211
0600          MOVE 50000   TO LAST-NUMBER-GENERATED-4010                CG021211
           END-IF                                                       CG021211
0600       COMPUTE WS-IMPT-FILE-SEQ-NBR1 =                              CG021211
0600               LAST-NUMBER-GENERATED-4010 + INCREMENTED-BY-4010.    CG021211
0600       MOVE WS-IMPT-FILE-SEQ-NBR1 TO WS-IMPT-FILE-SEQ-NBR.          CG021211
0600       MOVE WS-IMPT-FILE-SEQ-NBR TO LAST-NUMBER-GENERATED-4010.     CG021211
0600                                                                    CG021211
           MODIFY NUMBER-MASK.                                          CG021211
           PERFORM 1163600-NUMBER-MASK-CONTINUE THRU 1163600-EXIT.      CG021211
                                                                        CG021211
       1163500-EXIT. EXIT.                                              CG021211
                                                                        CG021211
       1163600-NUMBER-MASK-CONTINUE.                                    CG021211
                                                                        CG021211
           IF GOVT-CTRCT-NBR-3515 > SPACES                              CG021211
              MOVE  'G  '                  TO WS-IMPT-FILE-TYPE         CG021211
           ELSE                                                         CG021211
             IF BY-AIR-FREIGHT-8009                                     CG021211
                MOVE  'A   '               TO WS-IMPT-FILE-TYPE         CG021211
             ELSE                                                       CG021211
                MOVE SHIP-PLANT-CODE-3515  TO WS-IMPT-FILE-TYPE         CG021211
             END-IF                                                     CG021211
           END-IF.                                                      CG021211
           MOVE SAVE-DATE-CC               TO WS-IMPT-FILE-CC.          CG021211
           MOVE SAVE-DATE-YY               TO WS-IMPT-FILE-YY.          CG021211
           MOVE WS-RECV-IMPT-FILE-NBR      TO WSC-IMPORT-FILE-NBR.      CG021211
                                                                        CG021211
       1163600-EXIT. EXIT.                                              CG021211
                                                                        CG021211
       1168000-SUBMIT-JCL.                                              CG021211
           INITIALIZE TEXT-HEADER                                       CG021211
           INITIALIZE TEXT-LINE                                         CG021211
           MOVE 'DNWX'          TO TEXT-TYPE-CODE-951                   CG021211
           MOVE 'NAXBDOC'       TO TEXT-KEY-951                         CG021211
           IF GEODE-SHIP-FROM                                           CG081124
              MOVE 'NAXBDOC2'   TO TEXT-KEY-951                         CG081124
           END-IF.                                                      CG081124
           OBTAIN CALC TEXT-HEADER                                      CG021211
234283       ON ANY-ERROR-STATUS                                        CG021211
234284          MOVE '049' TO WCR-ERROR-CODE                            CG021211
234285          STRING ERROR-STATUS '-OBTAIN TEXT HEADER: '             CG021211
234286             TEXT-KEY-951 DELIMITED BY SIZE INTO                  CG021211
234287                WCR-ERROR-TEXT                                    CG021211
234288          PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG021211
087900     MOVE 'N'                      TO SW-TEXT-DETAIL                      
           IF GEODE-SHIP-FROM                                           CG081124
              INITIALIZE TABLE-HDR                                      CG081124
              INITIALIZE TABLE-DETAIL                                   CG081124
              MOVE 'PRINTERS'            TO TABLE-KEY-8016              CG081124
              OBTAIN CALC TABLE-HDR                                     CG081124
              ON DB-REC-NOT-FOUND                                       CG081124
                 CONTINUE                                               CG081124
              END-IF                                                    CG081124
              IF DB-STATUS-OK                                           CG081124
                 IF WSC-TRW-FLAG = 'Y'                                  CG160826
                    MOVE 'OPEXB'       TO ENTRY-CODE-8017               CG160826
                 ELSE                                                   CG160826
                    STRING SAVE-SHIP-FROM                               CG160826
                    DELIMITED BY SIZE                                   CG160826
                    'XB' DELIMITED BY SIZE                              CG160826
                    INTO ENTRY-CODE-8017                                CG160826
                 END-IF                                                 CG160826
              END-IF                                                    CG081124
              OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                     CG081124
              USING ENTRY-CODE-8017                                     CG081124
              ON DB-REC-NOT-FOUND                                       CG081124
                 CONTINUE                                               CG081124
              END-IF                                                    CG081124
              IF DB-STATUS-OK                                           CG081124
                 INITIALIZE WS-PRINT-DEST-GEODE                         CG081124
                 MOVE TABLE-DETAIL-DATA-8017(1:8)                       CG081124
                                        TO WS-GEODE-PRINTER             CG081124
                 MOVE TABLE-DETAIL-DATA-8017(9:1)                       CG081124
                                        TO PRE-PRINT-FLAG               CG081124
              END-IF                                                    CG081124
              IF CAN-SHIP-FROM                                          CG081124
                 MOVE 'CANDATA '                                        CG081124
                                        TO WS-DB-NAME-GDNA              CG081124
              END-IF                                                    CG081124
              IF US-SHIP-FROM                                           CG081124
                 MOVE 'USADATA '                                        CG081124
                                        TO WS-DB-NAME-GDNA              CG081124
              END-IF                                                    CG081124
              MOVE BILL-LADING-NUMBER-3555                              CG081124
                                        TO WS-BOL-NUMBER-GDNA           CG081124
              MOVE WSC-INV-NUMBER                                       CG081124
                                        TO WS-IMPT-FILE-NBR-GDNA        CG081124
              PERFORM 1133100-GEODENA-PROCESS-TEXT                      CG081124
                                        THRU 1133100-GEODENA-EXIT       CG081124
              UNTIL END-TEXT-DETAIL                                     CG081124
              GO TO 1168000-EXIT                                        CG081124
           END-IF.                                                      CG081124
           PERFORM 1133100-PROCESS-TEXT  THRU 1133100-EXIT              CG021211
           UNTIL END-TEXT-DETAIL.                                       CG021211
       1168000-EXIT. EXIT.                                              CG021211
                                                                                
234213**************************************************************            
234214* JCL IS WRITTEN TO THE INTERNAL READER TO EXTRACT DATA FROM *            
234215* THE SENDING DATABASE WHICH WILL BE USED TO BUILD ADD       *            
234216* PENDING RECORDS, ADD IMPORT RECORDS AND FINISH PRINTBOL    *            
234217* UPDATES.                                                   *            
234218**************************************************************            
234219 1133000-SUBMIT-JCL.                                                      
234220*        *******************************************                      
234221*        *  GET THE PRINTER DESTINATION THAT MUST  *                      
234222*        *  BE SUPPLIED IN THE JCL  TO CREATE ADD  *                      
234223*        *  PENDING DOCUMENT.                      *                      
234224*        *******************************************                      
                                                                                
234225     MOVE 'PRINTERS  ' TO TABLE-KEY-8016                                  
234226                          SAVE-CURRENT-TABLE.                             
234227     IF WMS-SHIP-TO                                                       
234228        MOVE SAVE-SHIP-TO TO ENTRY-CODE-8017                              
234229        PERFORM 9000000-TBL-HDR-LOOKUP THRU 9000000-HDR-EXIT              
234230        IF TABLE-RECORD-FOUND                                             
234231           MOVE TABLE-DETAIL-DATA-8017 TO WORK-PEND-DEST                  
234239        ELSE                                                              
234240             MOVE '048' TO WCR-ERROR-CODE                                 
234241             STRING ERROR-STATUS '- OBTAIN PRINTER FOR ADDPR: '           
234242                SAVE-SHIP-TO DELIMITED BY SIZE INTO                       
234243                   WCR-ERROR-TEXT                                         
234244             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
234245                                                                          
234246*        *******************************************                      
234247*        *  GET THE APPROPRIATE SET OF JCL TO SUB- *                      
234248*        *  MIT TO THE INTERNAL READER:            *                      
234249*        *    'JCL WICSXBRD' - IF CROSS BORDER AND *                      
234250*        *                     WICS SHIP TO.       *                      
234251*        *    'JCL WMSXBRD'  - IF CROSS BORDER AND *                      
234252*        *                     WMS SHIP TO     OR  *                      
234253*        *                     EXPORT SALES TO CAN *                      
234254*        *                     OR US               *                      
234255*        *    'JCL WMSDOM  ' - IF DOMESTIC SHIPMENT*                      
234256*        *                     FROM WICS TO WMS    *                      
234257*        *******************************************                      
234258     INITIALIZE TEXT-HEADER.                                              
234259     IF CROSS-BORDER-TRANSFER                                             
234260        IF WMS-SHIP-TO                                                    
234261           MOVE 'JCL ' TO TEXT-TYPE-CODE-951                              
234262           MOVE 'WMSXBRD' TO TEXT-KEY-951, SAVE-JCL-TYPE                  
234263        END-IF                                                            
234264        IF WICS-SHIP-TO                                                   
234265           MOVE 'JCL ' TO TEXT-TYPE-CODE-951                              
234266           MOVE 'WICSXBRD' TO TEXT-KEY-951, SAVE-JCL-TYPE                 
234267        END-IF.                                                           
234268                                                                          
234269     IF DOMESTIC-TRANSFER AND (WICS-SHIP-FROM OR GEODE-SHIP-FROM) CG101130
            AND WMS-SHIP-TO                                             CG101130
234270        MOVE 'JCL ' TO TEXT-TYPE-CODE-951                                 
234271        MOVE 'WMSDOM ' TO TEXT-KEY-951, SAVE-JCL-TYPE.                    
234272                                                                          
234273     IF (EXPORT-SALES OR                                                  
234274        WSC-CUSTOMER =  '1032671')                                000030LM
               AND NOT (SAVE-MRTI-FLAG     = 'N')                       CG020514
234275        MOVE 'JCL ' TO TEXT-TYPE-CODE-951                                 
234276        MOVE 'WMSXBRD' TO TEXT-KEY-951, SAVE-JCL-TYPE.                    
234277                                                                          
           IF NEW-XBRD-SHIPMENT                                         IM010212
               MOVE 'JCL ' TO TEXT-TYPE-CODE-951                        IM010212
               MOVE 'NWMSXBRD' TO TEXT-KEY-951, SAVE-JCL-TYPE.          IM010212
                                                                                
234264     IF MX-SHIP-TO                                                IM011023
           OR MEXICAN-XBRD-FLAG = 'Y'                                   CG020420
           OR MX-BILL-TO                                                CG090209
              IF NOT GEODE-SHIP-FROM                                    CG090209
                 MOVE SPACES           TO TEXT-CALC-KEY-951             CG090209
                 MOVE 'DNWX'           TO TEXT-TYPE-CODE-951            CG090209
                 MOVE 'MXXBDOC'        TO TEXT-KEY-951, SAVE-JCL-TYPE   CG090209
              END-IF                                                    CG090209
           END-IF.                                                      CG090209
           IF MX-SHIP-TO                                                CG081124
           OR MEXICAN-XBRD-FLAG = 'Y'                                   CG081124
           OR MX-BILL-TO                                                CG090209
              IF GEODE-SHIP-FROM                                        CG090209
                 MOVE SPACES           TO TEXT-CALC-KEY-951             CG090209
                                TEXT-KEY-951, SAVE-JCL-TYPE             CG090209
                 MOVE 'DNWX'           TO TEXT-TYPE-CODE-951            CG090209
                 MOVE 'MXXBDOC2'                                        CG090209
                                       TO TEXT-KEY-951, SAVE-JCL-TYPE   CG090209
              END-IF                                                    CG090209
           END-IF.                                                      CG090209
           IF MRTI-XBRD-SHIPMENT                                        CG020514
              MOVE 'JCL '     TO TEXT-TYPE-CODE-951                     CG020514
              MOVE 'MRTIXBRD' TO TEXT-KEY-951, SAVE-JCL-TYPE.           CG020514
                                                                        CG020514
                                                                        CG020514
           IF MRTI-DOM-SHIPMENT                                         CG020514
              MOVE 'JCL '    TO TEXT-TYPE-CODE-951                      CG020514
              MOVE 'MRTIDOM' TO TEXT-KEY-951, SAVE-JCL-TYPE.            CG020514
                                                                        CG020514
234282     OBTAIN CALC TEXT-HEADER                                              
234283       ON ANY-ERROR-STATUS                                                
234284          MOVE '049' TO WCR-ERROR-CODE                                    
234285          STRING ERROR-STATUS '-OBTAIN TEXT HEADER: '                     
234286             TEXT-KEY-951 DELIMITED BY SIZE INTO                          
234287                WCR-ERROR-TEXT                                            
234288          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
234289                                                                          
234290     IF TEXT-DETAIL NOT EMPTY                                             
234291        MOVE 'N' TO SW-TEXT-DETAIL                                        
317600        IF MX-SHIP-TO                                             IM011023
              OR MX-BILL-TO                                             CG030730
              OR MEXICAN-XBRD-FLAG = 'Y'                                CG020420
317600           MOVE 'PRINTERS'         TO TABLE-KEY-8016              IM011023
317600           OBTAIN CALC TABLE-HDR                                  IM011023
317600           ON DB-REC-NOT-FOUND                                    IM011023
317600              CONTINUE                                            IM011023
317600           END-IF                                                 IM011023
317600           IF DB-STATUS-OK                                        IM011023
                    IF WSC-TRW-FLAG = 'Y'                               CG160826
                       MOVE 'OPEXB'    TO ENTRY-CODE-8017               CG160826
                    ELSE                                                CG160826
                       STRING SAVE-SHIP-FROM 'XB' DELIMITED BY SIZE     CG160826
                       INTO  ENTRY-CODE-8017                            CG160826
                    END-IF                                              CG160826
317600              OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL               IM011023
317600              USING ENTRY-CODE-8017                               IM011023
317600              ON DB-REC-NOT-FOUND                                 IM011023
317600                 CONTINUE                                         IM011023
317600              END-IF                                              IM011023
317600              IF DB-STATUS-OK                                     IM011023
317600                 MOVE TABLE-DETAIL-DATA-8017 (9:1)                CG081124
317600                                   TO PRE-PRINT-FLAG              IM011023
                       MOVE TABLE-DETAIL-DATA-8017 (1:8)                CG081124
                                         TO WS-GEODE-PRINTER            CG081124
317600              END-IF                                              IM011023
317600           END-IF                                                 IM011023
317600        END-IF                                                    IM011023
234292        PERFORM 1133100-PROCESS-TEXT THRU 1133100-EXIT                    
234293            UNTIL END-TEXT-DETAIL                                         
234294     ELSE                                                                 
234295          MOVE '050' TO WCR-ERROR-CODE                                    
234296          STRING 'NO TEXT DETAILS EXIST FOR: '                            
234297             TEXT-KEY-951 DELIMITED BY SIZE INTO                          
234298                WCR-ERROR-TEXT                                            
234299          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
234300                                                                          
234301     PERFORM 1133200-AUDIT-SUBMIT THRU 1133200-EXIT.                      
234302                                                                          
234303 1133000-EXIT. EXIT.                                                      
234304 EJECT                                                                    
234305**************************************************************            
234306*    SOME LINES MUST BE FILLED IN WITH ADDITIONAL DATA       *            
234307*    BEFORE WRITING TO THE INTERNAL READER.                  *            
234308**************************************************************            
234309 1133100-PROCESS-TEXT.                                                    
234310     OBTAIN NEXT TEXT-LINE WITHIN TEXT-DETAIL                             
234311       ON DB-END-OF-SET                                                   
234312          MOVE 'Y' TO SW-TEXT-DETAIL                                      
234313          GO TO 1133100-EXIT.                                             
234315                                                                          
234316     MOVE TEXT-LINE TO SAVE-JCL-LINE.                                     
234317     MOVE TEXT-LINE TO SAVE-JCL-LINE2.                            000023LJ
           IF GEODE-SHIP-FROM                                           CG081124
            IF PRE-PRINT-FLAG NOT = 'T'                                 CG081124
               INSPECT SAVE-JCL-LINE REPLACING ALL                      CG081124
               '))))))))'  BY 'DNWMP827'                                CG081124
            ELSE                                                        CG081124
               INSPECT SAVE-JCL-LINE REPLACING ALL                      CG081124
               '))))))))'  BY 'DNWMP828'                                CG081124
               INSPECT SAVE-JCL-LINE REPLACING ALL                      CG081124
               '//*UTFILE' BY '//OUTFILE'                               CG081124
            END-IF                                                      CG081124
            INSPECT SAVE-JCL-LINE   REPLACING ALL                       CG081124
              '||||||||'  BY WS-GEODE-PRINTER                           CG081124
           END-IF                                                       CG081124
234318                                                                          
234319     INSPECT SAVE-JCL-LINE REPLACING ALL                                  
234320       'LLLLLL' BY LOAD-NUMBER-8009.                                      
234321     INSPECT SAVE-JCL-LINE REPLACING ALL                                  
234322       'DDDDDDDD' BY WORK-PEND-DEST.                              000027LM
234323     INSPECT SAVE-JCL-LINE REPLACING ALL                                  
234324       'BBBBBBB' BY WSC-BOL.                                              
234325                                                                          
234326     IF EXPORT-SALES OR WSC-CUSTOMER =  '1032671'                         
234327        MOVE SAVE-SHIP-TO TO SAVE-PAPER-WHSE                              
234328        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234329          'WWW' BY SAVE-PAPER-WHSE.                                       
234330                                                                          
234326                                                                          
           IF ((WS-US-SHIP-TO AND CAN-SHIP-FROM) OR                     CG041101
               (WS-CAN-SHIP-TO AND US-SHIP-FROM)) AND                   CG041101
169200         CONTROL-TABLE-FLAG = 'Y'                                 CG021211
              INSPECT SAVE-JCL-LINE REPLACING ALL                       CG021211
                '????????????' BY WS-RECV-IMPT-FILE-NBR                 CG021211
              INSPECT SAVE-JCL-LINE REPLACING ALL                       CG021211
                '^' BY 'Y'                                              CG041118
234327        MOVE SAVE-SHIP-FROM TO SAVE-PAPER-WHSE                    CG021212
234328        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG021212
234329          '$$$' BY SAVE-PAPER-WHSE                                CG021212
           END-IF                                                       CG021211
                                                                        CG021211
           IF NEW-XBRD-SHIPMENT                                         IM010212
              OR MX-SHIP-TO                                             IM011023
              OR MX-BILL-TO                                             CG030730
              OR MEXICAN-XBRD-FLAG = 'Y'                                CG020420
234327        MOVE SAVE-SHIP-FROM TO SAVE-PAPER-WHSE                    IM010212
              INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011001
                'IIIIIIIIIIII' BY WS-RECV-IMPT-FILE-NBR                 IM011001
234328        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM010212
234329          '$$$' BY SAVE-PAPER-WHSE.                               IM010212
234330                                                                          
                                                                        CG020514
           IF SAVE-MRTI-FLAG       = 'N'                                CG020514
234327        MOVE SAVE-SHIP-FROM TO SAVE-SHIP-FROM-MRTI                CG020514
234328        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG020514
234329          '$$$' BY SAVE-SHIP-FROM-MRTI.                           CG020514
                                                                        CG020514
234331     IF CAN-SHIP-FROM                                                     
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234333          '########' BY 'CANDATA '.                                       
234334                                                                          
234335     IF US-SHIP-FROM                                                      
234336        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234337          '########' BY 'USADATA '.                                       
234338                                                                          
234339     IF XLA-SHIP-FROM                                                     
234340        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234341          '########' BY 'XLADATA '.                                       
234342                                                                          
234342     IF NEW-XBRD-SHIPMENT                                         CG020220
234343       IF SAVE-SHIP-FROM-ONE = SAVE-SHIP-TO-ONE                   CG020220
234343        IF US-BILL-TO                                             CG020220
234351           INSPECT SAVE-JCL-LINE REPLACING ALL                    CG020220
234352             'PPPPPPPP' BY 'USADATA '                             CG020220
234353           INSPECT SAVE-JCL-LINE REPLACING ALL                    CG020220
234354             '@@@@@@@@' BY 'TWUDATA '                             CG020220
234343        END-IF                                                    CG020220
234343                                                                  CG020220
234343        IF CAN-BILL-TO                                            CG020220
234351           INSPECT SAVE-JCL-LINE REPLACING ALL                    CG020220
234352             'PPPPPPPP' BY 'CANDATA '                             CG020220
234353           INSPECT SAVE-JCL-LINE REPLACING ALL                    CG020220
234354             '@@@@@@@@' BY 'TWCDATA '                             CG020220
234343        END-IF                                                    CG020220
234343     END-IF                                                       CG020220
234343     END-IF.                                                      CG020220
234343                                                                          
234344     IF CAN-SHIP-TO                                                       
234345        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234346          'PPPPPPPP' BY 'CANDATA '                                        
234347        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234348          '@@@@@@@@' BY 'TWCDATA '.                                       
234351        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011023
234352          '%%%%%%'   BY '      '                                  IM011023
234353        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011023
234354          '!!!!!!!!!!!!' BY '            '.                       IM011023
234349                                                                          
234350     IF US-SHIP-TO                                                        
234351        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234352          'PPPPPPPP' BY 'USADATA '                                        
234353        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234354          '@@@@@@@@' BY 'TWUDATA '.                                       
234351        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011023
234352          '%%%%%%'   BY '      '                                  IM011023
234353        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011023
234354          '!!!!!!!!!!!!' BY '            '.                       IM011023
234355                                                                          
234350     IF MX-SHIP-TO                                                IM011023
              OR MX-BILL-TO                                             CG030730
              OR MEXICAN-XBRD-FLAG = 'Y'                                CG020420
234351        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011023
234352          '%%%%%%'   BY '      '                                  IM011023
234353        INSPECT SAVE-JCL-LINE REPLACING ALL                       IM011023
234354          '!!!!!!!!!!!!' BY '            '.                       IM011023
234356     IF XLA-SHIP-TO                                                       
234357        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234358          'PPPPPPPP' BY 'XLADATA '                                        
234359        INSPECT SAVE-JCL-LINE REPLACING ALL                               
234360          '@@@@@@@@' BY 'TWXDATA '.                                       
234361                                                                          
234362     IF JOB-CARD                                                  000023LJ
234363         MOVE ' BEFORE WRITING JCL TO INTRDR' TO                  000023LJ
234364             WS-MESSAGE                                           000023LJ
234365         WRITE LOG MESSAGE ID 9060030                             000023LJ
234366             PARMS FROM WS-PROGRAM-ID LENGTH 9                    000023LJ
234370                   FROM WS-LOAD       LENGTH 7                    000023LJ
234380                   FROM WS-MESSAGE    LENGTH 30                   000023LJ
234390             ON ANY-ERROR-STATUS                                  000023LJ
234400                STRING ERROR-STATUS 'ERROR WRITING TO LOG'        000023LJ
234500                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT          000023LJ
234501                PERFORM 9999999-ABORT THRU 9999999-EXIT.          000023LJ
234502                                                                          
234503     WRITE PRINTER FROM SAVE-JCL-LINE                                     
234504        LENGTH 80                                                         
234505          REPORT ID 1                                                     
234506          CLASS 50                                                        
234507            ON ANY-ERROR-STATUS                                           
234508               MOVE '051' TO WCR-ERROR-CODE                               
234509               STRING ERROR-STATUS '-WRITING TO INTERNAL READER'          
234510                 DELIMITED BY SIZE                                        
234511                   INTO  WCR-ERROR-TEXT                                   
234512               PERFORM 9999999-ABORT THRU 9999999-EXIT.                   
234513                                                                          
234514     IF JOB-CARD                                                  000023LJ
234515         MOVE ' AFTER  WRITING JCL TO INTRDR' TO                  000023LJ
234516             WS-MESSAGE                                           000023LJ
234517         WRITE LOG MESSAGE ID 9060040                             000023LJ
234518             PARMS FROM WS-PROGRAM-ID LENGTH 9                    000023LJ
234519                   FROM WS-LOAD       LENGTH 7                    000023LJ
234520                   FROM WS-MESSAGE    LENGTH 30                   000023LJ
234530             ON ANY-ERROR-STATUS                                  000023LJ
234540                STRING ERROR-STATUS 'ERROR WRITING TO LOG'        000023LJ
234550                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT          000023LJ
234551                PERFORM 9999999-ABORT THRU 9999999-EXIT.          000023LJ
234552 1133100-EXIT. EXIT.                                                      
234553 EJECT                                                                    
      **************************************************************    CG081124
      * SOME LINES OF GEODE NORTH AMERICAN CROSS BORDER INTERNAL   *    CG081124
      * JCL MUST BE MODIFIED BEFORE SUBMITTING THE JOB             *    CG081124
      **************************************************************    CG081124
       1133100-GEODENA-PROCESS-TEXT.                                    CG081124
           OBTAIN NEXT TEXT-LINE WITHIN TEXT-DETAIL                     CG081124
           ON DB-END-OF-SET                                             CG081124
              MOVE 'Y'    TO SW-TEXT-DETAIL                             CG081124
              GO TO 1133100-EXIT                                        CG081124
           END-IF.                                                      CG081124
           MOVE TEXT-LINE TO SAVE-JCL-LINE.                             CG081124
           MOVE TEXT-LINE TO SAVE-JCL-LINE2.                            CG081124
           INSPECT SAVE-JCL-LINE REPLACING ALL                          CG081124
                '%%%%%%'  BY LOAD-NUMBER-8009.                          CG081124
           INSPECT SAVE-JCL-LINE REPLACING ALL                          CG081124
               'BBBBBBB'  BY WS-BOL-NUMBER-GDNA.                        CG081124
           INSPECT SAVE-JCL-LINE REPLACING ALL                          CG081124
           '!!!!!!!!!!!!' BY WS-IMPT-FILE-NBR-GDNA.                     CG081124
           INSPECT SAVE-JCL-LINE REPLACING ALL                          CG081124
           '????????????' BY '            '.                            CG081124
           INSPECT SAVE-JCL-LINE REPLACING ALL                          CG081124
               '########' BY WS-DB-NAME-GDNA.                           CG081124
           IF PRE-PRINT-FLAG = 'T'                                      CG081124
              EVALUATE SAVE-JCL-LINE(3:7)                               CG081124
              WHEN 'OUTFIL1'                                            CG081124
                   INSPECT SAVE-JCL-LINE REPLACING ALL                  CG081124
                   'DUMMY                                         '     CG100623
                          BY WS-GEODE-PRINTLINE                         CG081124
              END-EVALUATE                                              CG081124
           END-IF.                                                      CG081124
           IF PRE-PRINT-FLAG NOT EQUAL TO 'T'                           CG081124
              MOVE WS-GEODE-PRINTER                                     CG081124
                          TO WS-PRINT-DEST-GEODE(1:8)                   CG081124
           END-IF.                                                      CG081124
           INSPECT SAVE-JCL-LINE REPLACING ALL                          CG081124
               '111111111111111111111111111111111111111111111111'       CG081124
                          BY WS-PRINT-DEST-GEODE.                       CG081124
           WRITE PRINTER FROM SAVE-JCL-LINE                             CG081124
              LENGTH 80                                                 CG081124
                REPORT ID 1                                             CG081124
                CLASS 50                                                CG081124
                  ON ANY-ERROR-STATUS                                   CG081124
                    MOVE '051' TO WCR-ERROR-CODE                        CG081124
                    STRING ERROR-STATUS                                 CG081124
                    '-WRITING TO INTERNAL READER'                       CG081124
                    DELIMITED BY SIZE                                   CG081124
                         INTO  WCR-ERROR-TEXT                           CG081124
                     PERFORM 9999999-ABORT THRU 9999999-EXIT.           CG081124
           IF JOB-CARD                                                  CG081124
               MOVE ' AFTER  WRITING JCL TO INTRDR' TO                  CG081124
                   WS-MESSAGE                                           CG081124
               WRITE LOG MESSAGE ID 9060040                             CG081124
                   PARMS FROM WS-PROGRAM-ID LENGTH 9                    CG081124
                         FROM WS-LOAD       LENGTH 7                    CG081124
                         FROM WS-MESSAGE    LENGTH 30                   CG081124
                   ON ANY-ERROR-STATUS                                  CG081124
                      STRING ERROR-STATUS 'ERROR WRITING TO LOG'        CG081124
                         DELIMITED BY SIZE INTO WCR-ERROR-TEXT          CG081124
                      PERFORM 9999999-ABORT THRU 9999999-EXIT.          CG081124
       1133100-GEODENA-EXIT. EXIT.                                      CG081124
234554**************************************************************            
234555*   THE JCL IS SUBMITTED TO THE INTERNAL READER AND MAY FAIL;*            
234556*   THEREFORE, WE NEED SOME TYPE OF AUDIT EACH NIGHT TO      *            
234557*   VERIFY THAT JCL SUBMITTED PROCESSED OK.  THE LOAD,BOL,   *            
234558*   TYPE OF JCL, AND DATE/TIME WILL BE STORED ON TEXT RECORDS*            
234559*   THAT WILL BE READ AND VALIDATED AGAINST USERTASK RECORDS *            
234560*   THAT ARE STORED WHEN THE JCL IS PROCESSED.               *            
234561**************************************************************            
234562 1133200-AUDIT-SUBMIT.                                                    
234563     INITIALIZE TEXT-HEADER.                                              
234564     MOVE 'AUDT' TO TEXT-TYPE-CODE-951.                                   
234565     MOVE 'XBRDJCL' TO TEXT-KEY-951.                                      
234566     FIND KEEP EXCLUSIVE CALC TEXT-HEADER                                 
234567       ON ANY-ERROR-STATUS                                                
234568          NEXT SENTENCE.                                                  
234569                                                                          
234570     IF DB-REC-NOT-FOUND                                                  
234571        STORE TEXT-HEADER                                                 
234572          ON ANY-ERROR-STATUS                                             
234573             MOVE '075' TO WCR-ERROR-CODE                                 
234574             STRING ERROR-STATUS '-STORE "AUDT" TEXT HDR '                
234575                WSC-BOL DELIMITED BY SIZE INTO                            
234576                   WCR-ERROR-TEXT                                         
234577             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
234578     IF NOT DB-STATUS-OK                                                  
234579        MOVE '076' TO WCR-ERROR-CODE                                      
234580        STRING ERROR-STATUS 'OBTAIN "AUDT" TEXT HDR -'                    
234581          WSC-BOL DELIMITED BY SIZE INTO                                  
234582             WCR-ERROR-TEXT                                               
234583        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
234584                                                                          
234585     INITIALIZE TEXT-LINE.                                                
234586     STRING SAVE-JCL-TYPE ' '                                             
234587            LOAD-NUMBER-8009 ' '                                          
234588            BILL-LADING-NUMBER-3555 (1:7) ' '                             
234589            SAVE-DATE ' '                                                 
234590            SAVE-TIME ' '                                                 
234591              DELIMITED BY SIZE                                           
234592                 INTO TEXT-LINE.                                          
234593                                                                          
234594     STORE TEXT-LINE                                                      
234595       ON ANY-ERROR-STATUS                                                
234596          MOVE '077' TO WCR-ERROR-CODE                                    
234597          STRING ERROR-STATUS 'STORE "AUDT" TEXT LINE-'                   
234598            WSC-BOL DELIMITED BY SIZE INTO                                
234599               WCR-ERROR-TEXT                                             
234600        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
234601                                                                          
234602 1133200-EXIT. EXIT.                                                      
234603 EJECT                                                                    
234604**************************************************************            
234605*    WHEN A SHIPMENT IS A DOMESTIC TRANSFER FROM WMS TO WICS *            
234606*    (CA1 --> CA7, US1 --> U01) OR WICS TO WICS (U01 --> U02)*            
234607*    THE LOAD MUST BE SET UP AS AN INTRANSIT TO WICS.  A NEW *            
234608*    TASK "WICSINBD" WILL BE INITIATED TO PASS    LOAD DATA  *            
234609*    FROM THE CORE CV TO WICS.   THE WICSINBD PROGRAM  WILL  *            
234610*    PROCESS LOADS PLACED IN THE THE WICSINBD TEXT RECORDS   *            
234611*    AND ERASE THEM WHEN FINISHED.                           *            
234612**************************************************************            
234613 1134000-INIT-WICSINBD.                                                   
234614*   *********************************************                         
234615*   * STORE BOL  IN WICSINBD TEXT.              *                         
234616*   *********************************************                         
234617     INITIALIZE TEXT-HEADER.                                              
234618     MOVE 'WICS' TO TEXT-TYPE-CODE-951.                                   
234619     MOVE 'INBD' TO TEXT-KEY-951.                                         
234620     FIND KEEP EXCLUSIVE CALC TEXT-HEADER                                 
234621       ON ANY-ERROR-STATUS                                                
234622          NEXT SENTENCE.                                                  
234623                                                                          
234624     IF DB-REC-NOT-FOUND                                                  
234625        STORE TEXT-HEADER                                                 
234626          ON ANY-ERROR-STATUS                                             
234627             MOVE '056' TO WCR-ERROR-CODE                                 
234628             STRING ERROR-STATUS '-STORE "WICSINBD" TEXT HDR-'            
234629                WSC-BOL DELIMITED BY SIZE INTO                            
234630                   WCR-ERROR-TEXT                                         
234631             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
234632     IF NOT DB-STATUS-OK                                                  
234633        MOVE '057' TO WCR-ERROR-CODE                                      
234634        STRING ERROR-STATUS '-OBTAIN "WICSINBD" TEXT HDR-'                
234635          WSC-BOL DELIMITED BY SIZE INTO                                  
234636             WCR-ERROR-TEXT                                               
234637        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
234638                                                                          
234639     INITIALIZE TEXT-LINE.                                                
234640     MOVE BILL-LADING-NUMBER-3555 TO TEXT-LINE.                           
234641     STORE TEXT-LINE                                                      
234642       ON ANY-ERROR-STATUS                                                
234643          MOVE '058' TO WCR-ERROR-CODE                                    
234644          STRING ERROR-STATUS '-STORE "WICSINBD" TEXT LNE-'               
234645            WSC-BOL DELIMITED BY SIZE INTO                                
234646               WCR-ERROR-TEXT                                             
234647          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
234648                                                                          
234649*   *********************************************                         
234650*   * INITIATE WICSINBD TASK.                   *                         
234651*   *********************************************                         
234652                                                                          
234653     MOVE WCR-DB-NAME TO WICSINBD-DBNAME.                                 
234654     PUT QUEUE ID 'WICSINBD-QUEUE'                                        
234655       FROM WICSINBD-QUEUE-REC LENGTH 9                                   
234656         ON ANY-ERROR-STATUS                                              
234657            MOVE '055' TO WCR-ERROR-CODE                                  
234658            STRING ERROR-STATUS '-STORE WICSINBD QUEUE:'                  
234659              WSC-BOL DELIMITED BY SIZE INTO                              
234660                WCR-ERROR-TEXT                                            
234661            PERFORM 9999999-ABORT THRU 9999999-EXIT.                      
234662 1134000-EXIT. EXIT.                                                      
234663 EJECT                                                                    
234664 1135000-GET-SHIP-NUMBER.                                                 
234665*****************************************************************         
234666*      THE SHIPMENT NUMBER IN SHIPMENT-HEADER IS POPULATED IN   *         
234667*      PCV4;HOWEVER, WITH THE ADDITION OF WICS TO SDS, IT MUST  *         
234668*      BE RECALCULATED BEFORE STORING ON THE CORE.  FOR EXAMPLE,*         
234669*      SUPPOSE THE SAME SALES ORDER IS DROPPED TO WMS AND TO    *         
234670*      WICS.  WMS CREATES A 001 SHIPMENT-HEADER. THE WICS       *         
234671*      PORTION COMES TO THE CORE FIRST THRU DNWMX830 WHICH      *         
234672*      CREATES AND STORES A 001 SHIPMENT-HEADER.  WHEN THE WMS  *         
234673*      PORTION COMES THRU, ITS 001 SHIPMENT HEADER MUST BE      *         
234674*      MODIFIED TO 002 SHIPMENT-HEADER TO ELIMINATE ABEND.      *         
234675*****************************************************************         
140800*        **************************************************************   
140800*        BELOW PIECE OF LOGIC ADDED TO GENERATE UNIQUE SHIPMENT NUMBER    
140800*        UNDER BOL RECORD. UNIQUE SHIPMENT NUMBER IS STORED IN FIELD      
140800*        ORDER-LEAD-TIME-3515.                                            
140800*        NOTE:- PLEASE DO NOT GO BY FIELD NAME ORDER-LEAD-TIME-3515 AS    
140800*               IT IS REUSED TO CAPTURE UNIQUE SHIPMENT NUMBER.           
140800*        **************************************************************   
141000     OBTAIN CURRENT BILL-OF-LADING.                               CG230725
141000     OBTAIN FIRST SHIPMENT-HEADER WITHIN BOL-SHIP                 CG230725
234311     ON DB-END-OF-SET                                             CG230725
141100        CONTINUE                                                  CG230725
234311     END-IF.                                                      CG230725
234311     IF DB-STATUS-OK                                              CG230725
141100        MOVE ORDER-LEAD-TIME-3515                                 CG230725
141100                                 TO SAVE-LAST-SHIP-UNIQUE-NBR     CG230725
234311     END-IF.                                                      CG230725
234676     MOVE WSC-SDS-ORDER TO ORDER-NUMBER-367                               
234677     FIND CALC ORDER-HEADER                                               
234678       ON ANY-ERROR-STATUS                                                
234679          MOVE '024' TO WCR-ERROR-CODE                                    
234680          STRING ERROR-STATUS '-SDS ORDER NOT FOUND '                     
234681            WSC-SDS-ORDER DELIMITED BY SIZE INTO                          
234682               WCR-ERROR-TEXT                                             
234683          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
234684                                                                          
234685     OBTAIN NEXT SALES-ORDER WITHIN ORDER-HDR-TYPE                        
234686       ON ANY-ERROR-STATUS                                                
234687          MOVE '025' TO WCR-ERROR-CODE                                    
234688          STRING ERROR-STATUS '-SDS ORDER NOT FOUND '                     
234689             WSC-SDS-ORDER DELIMITED BY SIZE INTO                         
234690                WCR-ERROR-TEXT                                            
234691           PERFORM 9999999-ABORT THRU 9999999-EXIT.                       
234692                                                                          
      **** THIS FLAG INDICATES THIS ORDER APPLIES THE REVERSE PO LOGIC          
      **** WHICH MEANS THE PO NBR IS DETERMINED BY REMOVING THE 3RD             
      **** DIGIT FROM LEFT FROM THE BOL NBR.  THIS CALC IS PASSED UP            
      **** FROM WICS THOUGH.                                                    
           IF REVERSE-PO-FLAG-3510 = 'Y'                                 C03407 
037100         MOVE 'Y'     TO SAVE-REV-PO-FLAG.                         C03407 
                                                                                
           IF MRTI-ORDER-FLAG-3510 = 'N'                                CG020514
037100         MOVE 'N'     TO SAVE-MRTI-FLAG                           CG020514
           ELSE                                                         CG020514
               MOVE 'Y'     TO SAVE-MRTI-FLAG                           CG020514
           END-IF.                                                      CG020514
                                                                                
234693     IF ORDER-SHIPMENTS EMPTY                                             
234694        NEXT SENTENCE                                                     
234695     ELSE                                                                 
234696        IF ERROR-STATUS = '1601'                                          
234697           OBTAIN LAST SHIPMENT-HEADER WITHIN ORDER-SHIPMENTS             
234698             ON ANY-ERROR-STATUS                                          
234699                MOVE '072' TO WCR-ERROR-CODE                              
234700                STRING ERROR-STATUS '-LAST SHIP HDR ERROR '               
234701                  WSC-SDS-ORDER DELIMITED BY SIZE INTO                    
234702                     WCR-ERROR-TEXT                                       
234703                PERFORM 9999999-ABORT THRU 9999999-EXIT.                  
234704                                                                          
234705     MOVE SHIPMENT-NUMBER-3515 TO SAVE-LAST-SHIP-HDR.                     
234706                                                                          
           INITIALIZE RAMPUP-TABLE.                                     CG221205
           MOVE 'N'                      TO WS-INVOICE-TARGET-SYS.      CG221205
           MOVE 'N'                      TO WS-SIMULATE-TARGET-SYS.     CG221205
           MOVE SHIP-TO-BUSINESS-3510    TO CUSTOMER-NO-8046.           CG221205
           MOVE 'N'                      TO WS-ALIAS-FOUND.             CG221205
           IF BATCH-ORDER-IND-3510 = 'K'                                CG221205
              MOVE ALIAS-SHIP-TO-3510  TO CUSTOMER-NO-8046              CG221205
           END-IF                                                       CG221205
           MOVE 'INVOICE'                TO TRANSACTION-TYPE-8046.      CG221205
           OBTAIN CALC RAMPUP-TABLE                                     CG221205
           ON DB-REC-NOT-FOUND                                          CG221205
              IF BATCH-ORDER-IND-3510 = 'K'                             CG221205
                 MOVE ALT-BILL-TO-CUST-3510 TO CUSTOMER-NO-8046         CG221205
              ELSE                                                      CG221205
                 MOVE BILL-TO-BUSINESS-3510 TO CUSTOMER-NO-8046         CG221205
              END-IF                                                    CG221205
                                                                        CG221205
              MOVE 'INVOICE'             TO TRANSACTION-TYPE-8046       CG221205
              OBTAIN CALC RAMPUP-TABLE                                  CG221205
              ON DB-REC-NOT-FOUND                                       CG221205
                 IF LOGMSG                                              CG221205
                    MOVE SPACES         TO WS-MESSAGE-DATA              CG221205
                    STRING                                              CG221205
                           '"PGM":',                                    CG221205
                           '"DNWMX830",',                               CG221205
                           '"REC-TYPE":',                               CG221205
                           '"ACTIVITY",',                               CG221205
                           '"BOL":',                                    CG221205
                           '"',                                         CG221205
                           WSC-BOL,                                     CG221205
                           '",',                                        CG221205
                           '"BT":',                                     CG221205
                           '"',                                         CG221205
                           CUSTOMER-NO-8046                             CG221205
                           '",',                                        CG221205
                           '"MSG":',                                    CG221205
                           '"RAMP UP TABLE NOT FOUND"'                  CG221205
                       DELIMITED BY SIZE INTO WS-MESSAGE-DATA           CG221205
                    END-STRING                                          CG221205
                    PERFORM 4600-CALL-LOGGER THRU 4600-EXIT             CG221205
                 END-IF                                                 CG221205
                 GO TO 1135000-EXIT                                     CG221205
              END-IF                                                    CG221205
           END-IF.                                                      CG221205
           IF LOGMSG                                                    CG221205
              MOVE SPACES               TO WS-MESSAGE-DATA              CG221205
              STRING                                                    CG221205
                     '"PGM":',                                          CG221205
                     '"DNWMX830",',                                     CG221205
                     '"REC-TYPE":',                                     CG221205
                     '"ACTIVITY",',                                     CG221205
                     '"BOL":',                                          CG221205
                     '"',                                               CG221205
                     WSC-BOL,                                           CG221205
                     '",',                                              CG221205
                     '"MSG":',                                          CG221205
                     '"RAMP UP TABLE FOUND FOR CUSTOMER '               CG221205
                     CUSTOMER-NO-8046,                                  CG221205
                     '"'                                                CG221205
                 DELIMITED BY SIZE INTO WS-MESSAGE-DATA                 CG221205
              END-STRING                                                CG221205
              PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                   CG221205
           END-IF                                                       CG221205
           IF SHIP-RLSE-DATE-3555 < EFFECTIVE-DATE-8046                 CG221205
           OR ( SHIP-RLSE-TIME-3555 < EFFECTIVE-TIME-8046               CG221205
            AND SHIP-RLSE-DATE-3555 = EFFECTIVE-DATE-8046)              CG221205
              IF LOGMSG                                                 CG221205
                 MOVE SPACES            TO WS-MESSAGE-DATA              CG221205
                 STRING                                                 CG221205
                        '"PGM":',                                       CG221205
                        '"DNWMX830",',                                  CG221205
                        '"REC-TYPE":',                                  CG221205
                        '"ACTIVITY",',                                  CG221205
                        '"BOL":',                                       CG221205
                        '"',                                            CG221205
                        WSC-BOL,                                        CG221205
                        '",',                                           CG221205
                        '"ST":',                                        CG221205
                        '"',                                            CG221205
                        SHIP-TO-BUSINESS-3510                           CG221205
                        '",',                                           CG221205
                        '"EFFECTIVEDATE":',                             CG221205
                        '"',                                            CG221205
                        EFFECTIVE-DATE-8046(1:4)                        CG221205
                        '-',                                            CG221205
                        EFFECTIVE-DATE-8046(5:2)                        CG221205
                        '-',                                            CG221205
                        EFFECTIVE-DATE-8046(7:2)                        CG221205
                        '",',                                           CG221205
                        '"MSG":',                                       CG221205
                        '"SHIPMENT  PRIOR TO RAMP UP EFFECTIVE DATE '   CG221205
                        SHIP-RLSE-DATE-3555,                            CG221205
                        '"'                                             CG221205
                    DELIMITED BY SIZE INTO WS-MESSAGE-DATA              CG221205
                 END-STRING                                             CG221205
                 PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                CG221205
              END-IF                                                    CG221205
              GO TO 1135000-EXIT                                        CG221205
           END-IF.                                                      CG221205
           IF RAMPUP-FLAG-8046 = 'Y'                                    CG221205
              IF CONTINUE-PROCESS-IN-SDS-8046 = 'Y'                     CG221205
                 MOVE 'Y'                TO WS-SIMULATE-TARGET-SYS      CG221205
              ELSE                                                      CG221205
                 MOVE 'Y'                TO WS-INVOICE-TARGET-SYS       CG221205
              END-IF                                                    CG221205
           ELSE                                                         CG221205
              IF LOGMSG                                                 CG221205
                 MOVE SPACES            TO WS-MESSAGE-DATA              CG221205
                 STRING                                                 CG221205
                        '"PGM":',                                       CG221205
                        '"DNWMX830",',                                  CG221205
                        '"REC-TYPE":',                                  CG221205
                        '"ACTIVITY",',                                  CG221205
                        '"BOL":',                                       CG221205
                        '"',                                            CG221205
                        WSC-BOL,                                        CG221205
                        '",',                                           CG221205
                        '"RAMPUP":'                                     CG221205
                        '"',                                            CG221205
                        RAMPUP-FLAG-8046                                CG221205
                        '",',                                           CG221205
                        '"SIMULATION":'                                 CG221205
                        '"',                                            CG221205
                        WS-SIMULATE-TARGET-SYS                          CG221205
                        '",',                                           CG221205
                        '"MSG":',                                       CG221205
                        '"RAMPUP SET TO N"'                             CG221205
                    DELIMITED BY SIZE INTO WS-MESSAGE-DATA              CG221205
                 END-STRING                                             CG221205
                 PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                CG221205
              END-IF                                                    CG221205
           END-IF.                                                      CG221205
           IF LOGMSG                                                    CG221205
              MOVE SPACES               TO WS-MESSAGE-DATA              CG221205
              STRING                                                    CG221205
                     '"PGM":',                                          CG221205
                     '"DNWMX830",',                                     CG221205
                     '"REC-TYPE":',                                     CG221205
                     '"ACTIVITY",',                                     CG221205
                     '"BOL":',                                          CG221205
                     '"',                                               CG221205
                     WSC-BOL,                                           CG221205
                     '",',                                              CG221205
                     '"RAMPUP":'                                        CG221205
                     '"',                                               CG221205
                     RAMPUP-FLAG-8046                                   CG221205
                     '",',                                              CG221205
                     '"SIMULATION":'                                    CG221205
                     '"',                                               CG221205
                     WS-SIMULATE-TARGET-SYS                             CG221205
                     '",',                                              CG221205
                     '"MSG":',                                          CG221205
                     '"FLAG MARKED FOR FOP"'                            CG221205
                 DELIMITED BY SIZE INTO WS-MESSAGE-DATA                 CG221205
              END-STRING                                                CG221205
              PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                   CG221205
           END-IF.                                                      CG221205
234707 1135000-EXIT. EXIT.                                                      
234708 EJECT                                                                    
       1136000-CALCULATE-IRD-ETA.                                       CG070201
      ******************************************************************CG070201
      * CALCULATE ETA AND IRD DATE TO STORE ON LOAD AND BOL RECORD FOR *CG070201
      * ALL INTRANSIT SHIPMENTS (DOMESTIC AND CROSS BORDER).           *CG070201
      ******************************************************************CG070201
                                                                        CG070201
           MOVE 'N'                    TO WS-DATE-NOT-FOUND.            CG070702
           MOVE WSC-SHIP-DATE          TO WS-PSD.                       CG070419
           MOVE 0                      TO SAVE-ETA-DAYS-N.              CG070201
                                                                        CG070201
           MOVE SPACES                 TO TABLE-KEY-8016                CG070201
                                          ENTRY-CODE-8017.              CG070201
           MOVE 'RDILEADTM'            TO TABLE-KEY-8016.               CG070201
           STRING SAVE-SHIP-FROM                                        CG070201
                  SAVE-SHIP-TO                                          CG070201
                  MODE-8009                                             CG070201
                  DELIMITED BY SPACE   INTO ENTRY-CODE-8017.            CG070201
           PERFORM 9000000-TBL-HDR-LOOKUP                               CG070201
                                       THRU 9000000-HDR-EXIT.           CG070201
           IF TABLE-RECORD-FOUND                                        CG070201
              MOVE TABLE-DETAIL-DATA-8017(4:3)                          CG070201
                                       TO SAVE-ETA-DAYS-N               CG070201
              MOVE 'UNLOADTIME'        TO TABLE-KEY-8016                CG070201
              MOVE SAVE-SHIP-TO        TO ENTRY-CODE-8017               CG070201
              PERFORM 9000000-TBL-HDR-LOOKUP                            CG070201
                                       THRU 9000000-HDR-EXIT            CG070201
              IF TABLE-RECORD-FOUND                                     CG070201
                 MOVE TABLE-DETAIL-DATA-8017(1:3)                       CG070201
                                       TO WS-UNLOAD-TIME                CG070201
              ELSE                                                      CG070201
                 MOVE 2                TO WS-UNLOAD-TIME                CG070201
              END-IF                                                    CG070201
           ELSE                                                         CG070201
              MOVE SPACES              TO TABLE-KEY-8016                CG070201
                                          ENTRY-CODE-8017               CG070201
              STRING 'WHSEETA'                                          CG070201
                      MODE-8009                                         CG070201
                     '  ' DELIMITED BY SIZE                             CG070201
                                       INTO TABLE-KEY-8016              CG070201
              STRING SAVE-SHIP-FROM                                     CG070201
                     SAVE-SHIP-TO                                       CG070201
                     DELIMITED BY SIZE                                  CG070201
                                       INTO ENTRY-CODE-8017             CG070201
              PERFORM 9000000-TBL-HDR-LOOKUP                            CG070201
                                       THRU 9000000-HDR-EXIT            CG070201
              IF TABLE-RECORD-FOUND                                     CG070201
                 MOVE TABLE-DETAIL-DATA-8017(1:3)                       CG070201
                                       TO SAVE-ETA-DAYS-N               CG070201
              ELSE                                                      CG070201
                  MOVE 'Y'             TO WS-DATE-NOT-FOUND             CG070702
              END-IF                                                    CG070201
              MOVE ZEROES              TO WS-UNLOAD-TIME                CG070201
           END-IF.                                                      CG070201
           IF WS-DATE-NOT-FOUND = 'Y'                                   CG070702
              PERFORM 1136100-GET-ETA-DAYS                              CG070702
                                       THRU 1136100-EXIT                CG070702
              PERFORM 1136300-STORE-ETA                                 CG070702
                                       THRU 1136300-EXIT                CG070702
           END-IF.                                                      CG070702
                                                                        CG070702
      *** USE NDR ROUTINE TO CALCULATE WS-CDD AND WS-IRD **             CG070201
           MOVE WSC-SHIP-DATE          TO WS-DATE-KNOWN.                CG070413
           MOVE ZEROES                 TO WS-DAY-COUNT.                 CG070201
           COMPUTE WS-DAY-COUNT        =                                CG070201
                                       SAVE-ETA-DAYS-N - WS-UNLOAD-TIME.CG070201
           IF WS-DAY-COUNT >  0                                         CG070702
              PERFORM 1137000-CALL-NDR-ROUTINE                          CG070201
                                       THRU 1137000-EXIT                CG070201
           ELSE                                                         CG070201
              GO TO 1136000-EXIT                                        CG070201
           END-IF.                                                      CG070201
           MOVE WS-DATE-UNKNOWN        TO WS-CDD CUST-DUE-DATE-8009.    CG070201
           MOVE WS-CDD                 TO WS-DATE-KNOWN.                CG070201
           MOVE 'UNLOADTIME'           TO TABLE-KEY-8016.               CG070201
           MOVE SAVE-SHIP-TO           TO ENTRY-CODE-8017.              CG070201
           PERFORM 9000000-TBL-HDR-LOOKUP                               CG070201
                                       THRU 9000000-HDR-EXIT.           CG070201
           IF TABLE-RECORD-FOUND                                        CG070201
              MOVE TABLE-DETAIL-DATA-8017(1:3)                          CG070201
                                       TO WS-UNLOAD-TIME                CG070201
           ELSE                                                         CG070201
              MOVE 2                   TO WS-UNLOAD-TIME                CG070201
           END-IF.                                                      CG070201
           MOVE WS-UNLOAD-TIME         TO WS-DAY-COUNT.                 CG070201
           PERFORM 1137000-CALL-NDR-ROUTINE                             CG070201
                                       THRU 1137000-EXIT.               CG070201
           MOVE WS-DATE-UNKNOWN        TO                               CG070201
                                       WS-IRD INVENTORY-RECV-DAT-8009.  CG070201
234780                                                                          
234781 1136000-EXIT. EXIT.                                                      
      ******************************************************************CG070702
      * GET THE ALTERNATE MODE FROM THE MODE TABLE                     *CG070702
      ******************************************************************CG070702
       1136100-GET-ETA-DAYS.                                            CG070702
                                                                        CG070702
           MOVE SPACES          TO TABLE-KEY-8016 ENTRY-CODE-8017.      CG070702
           MOVE 'MODE     '     TO TABLE-KEY-8016.                      CG070702
           MOVE MODE-8009       TO ENTRY-CODE-8017.                     CG070702
           PERFORM 9000000-TBL-HDR-LOOKUP                               CG070702
                                       THRU 9000000-HDR-EXIT.           CG070702
           IF TABLE-RECORD-FOUND                                        CG070702
              IF TABLE-DETAIL-DATA-8017(1:1) = SPACES                   CG070702
                  MOVE TABLE-DETAIL-DATA-8017(3:3)                      CG070702
                                TO SAVE-ETA-DAYS-N                      CG070702
                  GO TO 1136100-EXIT                                    CG070702
              ELSE                                                      CG070702
                  MOVE TABLE-DETAIL-DATA-8017(1:1)                      CG070702
                                TO WS-MODE                              CG070702
                  PERFORM 1136200-GET-ETA-DAYS                          CG070702
                                       THRU 1136200-EXIT                CG070702
              END-IF                                                    CG070702
           END-IF.                                                      CG070702
                                                                        CG070702
       1136100-EXIT.                                                    CG070702
           EXIT.                                                        CG070702
      ******************************************************************CG070702
      * GET THE ETA INFORMATION FROM THE ALTERNATE MODE                *CG070702
      ******************************************************************CG070702
       1136200-GET-ETA-DAYS.                                            CG070702
                                                                        CG070702
           MOVE SPACES                 TO TABLE-KEY-8016                CG070702
                                          ENTRY-CODE-8017.              CG070702
           MOVE 'RDILEADTM'            TO TABLE-KEY-8016.               CG070702
           STRING SAVE-SHIP-FROM                                        CG070702
                  SAVE-SHIP-TO                                          CG070702
                  WS-MODE                                               CG070702
                    DELIMITED BY SPACE                                  CG070702
                                       INTO ENTRY-CODE-8017.            CG070702
           PERFORM 9000000-TBL-HDR-LOOKUP                               CG070702
                                       THRU 9000000-HDR-EXIT.           CG070702
           IF TABLE-RECORD-FOUND                                        CG070702
              MOVE TABLE-DETAIL-DATA-8017(4:3)                          CG070702
                                       TO SAVE-ETA-DAYS-N               CG070702
              MOVE 'UNLOADTIME'                                         CG070702
                                       TO TABLE-KEY-8016                CG070702
              MOVE  SAVE-SHIP-TO                                        CG070702
                                       TO ENTRY-CODE-8017               CG070702
              PERFORM 9000000-TBL-HDR-LOOKUP                            CG070702
                                       THRU 9000000-HDR-EXIT            CG070702
              IF TABLE-RECORD-FOUND                                     CG070702
                 MOVE TABLE-DETAIL-DATA-8017(1:3)                       CG070702
                                       TO WS-UNLOAD-TIME                CG070702
              ELSE                                                      CG070702
                 MOVE 2                TO WS-UNLOAD-TIME                CG070702
              END-IF                                                    CG070702
           ELSE                                                         CG070702
              MOVE SPACES              TO TABLE-KEY-8016                CG070702
                                          ENTRY-CODE-8017               CG070702
              STRING 'WHSEETA'                                          CG070702
                      WS-MODE                                           CG070702
                     '  ' DELIMITED BY SIZE                             CG070702
                                       INTO TABLE-KEY-8016              CG070702
              STRING SAVE-SHIP-FROM                                     CG070702
                     SAVE-SHIP-TO                                       CG070702
                     DELIMITED BY SPACE                                 CG070702
                                       INTO ENTRY-CODE-8017             CG070702
              PERFORM 9000000-TBL-HDR-LOOKUP                            CG070702
                                       THRU 9000000-HDR-EXIT            CG070702
              IF TABLE-RECORD-FOUND                                     CG070702
                 MOVE TABLE-DETAIL-DATA-8017(1:3)                       CG070702
                                       TO SAVE-ETA-DAYS-N               CG070702
              ELSE                                                      CG070702
                 MOVE SPACES TO TABLE-KEY-8016 ENTRY-CODE-8017          CG070702
                 MOVE 'MODE     '      TO TABLE-KEY-8016                CG070702
                 MOVE WS-MODE          TO ENTRY-CODE-8017               CG070702
                 PERFORM 9000000-TBL-HDR-LOOKUP                         CG070702
                                       THRU 9000000-HDR-EXIT            CG070702
                 IF TABLE-RECORD-FOUND                                  CG070702
                    IF TABLE-DETAIL-DATA-8017(1:1) = SPACES             CG070702
                       MOVE TABLE-DETAIL-DATA-8017(3:3)                 CG070702
                                       TO SAVE-ETA-DAYS-N               CG070702
                       GO TO 1136200-EXIT                               CG070702
                    END-IF                                              CG070702
                 END-IF                                                 CG070702
              END-IF                                                    CG070702
              MOVE ZEROES              TO WS-UNLOAD-TIME                CG070702
           END-IF.                                                      CG070702
                                                                        CG070702
       1136200-EXIT.                                                    CG070702
           EXIT.                                                        CG070702
      **************************************************************    CG070702
      *STORE SHIP-FROM/SHIP-TO/MODE INFORMATION IN ETANTFND TABLE  *    CG070702
      **************************************************************    CG070702
       1136300-STORE-ETA.                                               CG070702
                                                                        CG070702
           INITIALIZE TABLE-HDR.                                        CG070702
           MOVE 'ETANTFND'             TO TABLE-KEY-8016.               CG070702
           OBTAIN CALC TABLE-HDR                                        CG070702
           ON DB-REC-NOT-FOUND                                          CG070702
              STORE TABLE-HDR                                           CG070702
              ON ANY-ERROR-STATUS                                       CG070702
                 MOVE '072'            TO WCR-ERROR-CODE                CG070702
                 STRING 'UNABLE TO STORE ETANTFND TABLE HEADER:'        CG070702
                     DELIMITED BY SIZE                                  CG070702
                     INTO WCR-ERROR-TEXT                                CG070702
                     PERFORM 9999999-ABORT                              CG070702
                                       THRU 9999999-EXIT                CG070702
              END-IF                                                    CG070702
           END-IF.                                                      CG070702
           IF DB-STATUS-OK                                              CG070702
              INITIALIZE TABLE-DETAIL                                   CG070702
              MOVE BILL-LADING-NUMBER-3555                              CG070702
                                       TO ENTRY-CODE-8017               CG070702
              STRING SAVE-SHIP-FROM                                     CG070702
                     SAVE-SHIP-TO                                       CG070702
                     MODE-8009                                          CG070702
                    DELIMITED BY SPACE                                  CG070702
                                       INTO TABLE-DETAIL-DATA-8017      CG070702
                                                                        CG070702
              MOVE SAVE-DATE-W-CC                                       CG070702
                                       TO TABLE-DETAIL-DATA-8017(8:8)   CG070702
              OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                     CG070702
              USING ENTRY-CODE-8017                                     CG070702
              ON DB-REC-NOT-FOUND                                       CG070702
                    STORE TABLE-DETAIL                                  CG070702
                    ON ANY-ERROR-STATUS                                 CG070702
                       MOVE '073'      TO WCR-ERROR-CODE                CG070702
           STRING 'UNABLE TO STORE SHIP-FROM/SHIP-TO/MODE IN THE TABLE' CG070702
                            ENTRY-CODE-8017                             CG070702
                            DELIMITED BY SIZE                           CG070702
                            INTO WCR-ERROR-TEXT                         CG070702
                            PERFORM 9999999-ABORT                       CG070702
                                       THRU 9999999-EXIT                CG070702
                    END-IF                                              CG070702
              END-IF                                                    CG070702
           END-IF.                                                      CG070702
                                                                        CG070702
       1136300-EXIT.                                                    CG070702
           EXIT.                                                        CG070702
      ******************************************************************CG070201
      * CALL NDR ROUTINE TO CALCULATE THE DATE USING KNOWN DATE        *CG070201
      ******************************************************************CG070201
       1137000-CALL-NDR-ROUTINE.                                        CG070201
                                                                        CG070201
           MOVE ZEROES                 TO WS-DATE-UNKNOWN.              CG070201
           MOVE SPACES                 TO WS-CHECK-BYTE.                CG070201
           CALL 'NDR1175'              USING WS-DATE-KNOWN              CG070201
                                             WS-DATE-UNKNOWN            CG070201
                                             WS-DAY-COUNT               CG070201
                                             WS-CHECK-BYTE.             CG070201
           IF WS-CHECK-BYTE NOT = SPACES                                CG070201
              MOVE 100                 TO WS-RETURN-CODE                CG070201
              CALL 'ILBOABN0'          USING WS-RETURN-CODE             CG070201
           END-IF.                                                      CG070201
           MOVE ZEROES                 TO WS-DAY-COUNT.                 CG070201
                                                                        CG070201
       1137000-EXIT.                                                    CG070201
           EXIT.                                                        CG070201
                                                                        CG070201
234782 EJECT                                                                    
241502****************************************************************          
234246****************************************************              CG200506
       1133800-STORE-LOAD-ID.                                           CG200506
234246****************************************************              CG200506
234246* FOR PUSH SHIPMENTS STORE THE LOAD ID SHORT AND DEL ID SHORT     CG200506
234246* IN THE TABLE - TRWDELLOD TABLE FOR FREIGHT PAYMENT TO USE.      CG200506
234246****************************************************              CG200506
      *                                                                 CG200506
              MOVE 'TRWDELLOD'            TO TABLE-KEY-8016             CG200506
      *                                                                 CG200506
              OBTAIN CALC TABLE-HDR                                     CG200506
              ON DB-REC-NOT-FOUND                                       CG200506
                 MOVE '121' TO WCR-ERROR-CODE                           CG200506
                 STRING 'TRWDELLOD TABLE NOT FOUND:'                    CG200506
                        WSC-GOVT-CTRCT-NBR(3:7) DELIMITED BY SPACES     CG200506
                        INTO WCR-ERROR-TEXT                             CG200506
                 END-STRING                                             CG200506
                 PERFORM 9999999-ABORT THRU 9999999-EXIT                CG200506
              END-IF                                                    CG200506
      *                                                                 CG200506
              IF DB-STATUS-OK                                           CG200506
                 MOVE WSC-BOL       TO ENTRY-CODE-8017                  CG200506
                 OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                  CG200506
                        USING ENTRY-CODE-8017                           CG200506
                 ON DB-REC-NOT-FOUND                                    CG200506
                    MOVE WSC-GOVT-CTRCT-NBR(3:7) TO                     CG200506
                                       TABLE-DETAIL-DATA-8017           CG200506
                    STORE TABLE-DETAIL                                  CG200506
                    IF DB-STATUS-OK                                     CG200506
                       GO TO 1133800-EXIT                               CG200506
                    END-IF                                              CG200506
                 END-IF                                                 CG200506
                 IF DB-STATUS-OK                                        CG200506
                    IF TABLE-DETAIL-DATA-8017(1:7) =                    CG200506
                                     WSC-GOVT-CTRCT-NBR(3:7)            CG200506
                       CONTINUE                                         CG200506
                    ELSE                                                CG200506
                       MOVE '122' TO WCR-ERROR-CODE                     CG200506
                       STRING 'DELID ALREADY PRESENT:'                  CG200506
                           WSC-GOVT-CTRCT-NBR(3:7) DELIMITED BY SPACES  CG200506
                           INTO WCR-ERROR-TEXT                          CG200506
                       END-STRING                                       CG200506
                       PERFORM 9999999-ABORT THRU 9999999-EXIT          CG200506
                    END-IF                                              CG200506
                 END-IF                                                 CG200506
              END-IF.                                                   CG200506
234300                                                                  CG200506
241647 1133800-EXIT. EXIT.                                              CG200506
241648 EJECT                                                            CG200506
       1133900-LOAD-NBR-GEODE.                                          CG240716
      ****************************************************              CG240716
      * FOR PUSH SHIPMENTS STORE THE LOAD RECEIVED FROM GEODE           CG240716
      * IN THE TABLE - GTMLOADNBR FOR GTC COMPLIANCE.            .      CG240716
      ****************************************************              CG240716
      *                                                                 CG240716
           INITIALIZE TABLE-HDR.                                        CG240716
           MOVE 'GTMLOADNBR'           TO TABLE-KEY-8016.               CG240716
           OBTAIN CALC TABLE-HDR                                        CG240716
           ON DB-REC-NOT-FOUND                                          CG240716
              STORE TABLE-HDR                                           CG240716
           END-IF.                                                      CG240716
                                                                        CG240716
           MOVE SPACES                 TO TABLE-DETAIL-DATA-8017.       CG240716
           MOVE WSC-BOL                TO ENTRY-CODE-8017.              CG240716
           OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                        CG240716
                                       USING ENTRY-CODE-8017            CG240716
           ON DB-REC-NOT-FOUND                                          CG240716
              MOVE WSC-BOL             TO ENTRY-CODE-8017               CG240716
              MOVE WS-C-LOAD-NBR       TO TABLE-DETAIL-DATA-8017        CG240716
              STORE TABLE-DETAIL                                        CG240716
           END-IF.                                                      CG240716
           IF DB-STATUS-OK                                              CG240716
              MOVE WS-C-LOAD-NBR       TO TABLE-DETAIL-DATA-8017        CG240716
              MODIFY TABLE-DETAIL                                       CG240716
           END-IF.                                                      CG240716
                                                                        CG240716
                                                                        CG240716
       1133900-EXIT. EXIT.                                              CG240716
241502****************************************************************  CG200506
241503*        *********************************************         *          
241504*        *  - SHIPMENT CONFIRMATION TRAN TYPE 04 -   *         *          
241505*        *********************************************         *          
241506****************************************************************          
241507 1140000-PROCESS-LINE.                                                    
241508                                                                          
           IF NOT END-OF-PARTS                                          CG160826
              IF LS-CUSTOMER-ORDER                                      CG160826
                 IF WSC-SHIP-QTY = 0                                    CG160826
                    GO TO 1140000-EXIT                                  CG160826
                 END-IF                                                 CG160826
              END-IF                                                    CG160826
           END-IF.                                                      CG160826
                                                                                
241509*        *********************************************                    
241510*        * INVOICING CANNOT BE CALLED UNTIL ALL      *                    
241511*        * SHIPMENT-LINES FOR THAT INVOICE ARE       *                    
241512*        * STORED.  FOR THIS REASON,                 *                    
241513*        * WICS WILL PASS A DUMMY SHIPMENT-LINE WHEN *                    
241514*        * NO MORE LINES EXIST FOR A SHIPMENT-HEADER *                    
241515*        * RECORD SO THAT THIS PROGRAM KNOWS THAT IT *                    
241516*        * CAN NOW CALL INVOICING FOR THE SHIPMENT   *                    
241517*        * HEADER.  AFTER CALLING INVOICING, EXIT    *                    
241518*        * AS NOT TO PROCESS DUMMY LINE THRU MODULE. *                    
241519*        *                                           *                    
241520*        *********************************************                    
241521     IF END-OF-PARTS                                                      
241522        IF ZERO-SHIP-HDR                                                  
241523*        *********************************************                    
241524*        *  BACK OUT SHIPMENT-HDR AND POSSIBLY       *                    
241525*        *  INVOICE IF A FULLY 0 SHIPPED SHIPMENT-HDR*                    
241526*        *********************************************                    
241527           PERFORM 1146000-BACK-OUT-HDR THRU 1146000-EXIT                 
241528           GO TO 1140000-EXIT                                             
241529        ELSE                                                              
241530           PERFORM 1141000-CALL-INVOICING THRU 1141000-EXIT               
241531           GO TO 1140000-EXIT.                                            
241532                                                                          
241533*        *********************************************                    
241534*        * NOTE: THIS MODULE WILL NOT STORE 0        *                    
241535*        * SHIPMENT LINES BECAUSE THEY CAUSE A       *                    
241536*        * PROBLEM FOR INVOICING AND SIS; HOWEVER,   *                    
241537*        * OE IS UPDATED WITH AND PFO NOTIFIED WITH  *                    
241538*        * THE CANCELLED QTY OF A 0 SHIPMENT-LINE.   *                    
241539*        *                                           *                    
241540*        * WICS DOES NOT USE SHIPMENT LINE NUMBERS,  *                    
241541*        * BUT INVOICING DOES;THUS WMS MUST GENERATE *                    
241542*        * SHIPMENT LINE NUMBERS.                    *                    
241543*        *********************************************                    
3LO030     IF WSC-SHIP-QTY   NOT = 0 OR                                         
3LO030        WSC-CANCEL-QTY NOT = 0                                            
3LO030        IF WSC-TMS-FLAG = 'Y'                                             
3LO030           INITIALIZE TMS-REC-04                                          
3LO030           MOVE WSC-NAPN TO TMS-NAPN                                      
3LO030           MOVE WSC-MSPN TO TMS-MSPN                                      
3LO030           MOVE WSC-SHIP-QTY TO TMS-SHIP-QTY                              
3LO030           MOVE WSC-CANCEL-QTY TO TMS-CANCEL-QTY                          
3LO030           MOVE WSC-CANCEL-RESN-CODE TO TMS-CANCEL-RESN-CODE              
3LO030           MOVE WSC-SO-LINE-NBR TO TMS-SO-LINE-NBR                        
3LO030           MOVE WSC-SO-LINE-SCHED TO TMS-SO-LINE-SCHED                    
3LO030           MOVE WSC-TMS-FLAG TO TMS-FLAG                                  
3LO030           MOVE WSC-TMS-REBILL-FLAG TO TMS-REBILL-FLAG                    
3LO030                                                                          
3LO030           IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER                  
3LO030              MOVE WSC-ORDER-NUMBER TO TMS-ORDER-NUMBER                   
3LO030           ELSE                                                           
3LO030              MOVE WSC-SDS-ORDER TO TMS-ORDER-NUMBER                      
3LO030           END-IF                                                         
3LO030        END-IF                                                            
3LO030     END-IF.                                                              
                                                                                
241544     IF WSC-SHIP-QTY NOT = 0                                              
241545        INITIALIZE SHIPMENT-LINE                                          
241546        MOVE 'N' TO SW-ZERO-SHIP-HDR                                      
241547        ADD 1 TO WORK-SHIP-LINE                                           
241548        MOVE WORK-SHIP-LINE TO SHIPMENT-LINE-3516                         
241549        MOVE WSC-NAPN TO PART-NUMBER-3516                                 
241550        MOVE WSC-MSPN TO MARKETING-PART-ID-3516                           
241560        MOVE WSC-SHIP-QTY TO QTY-SHIPPED-3516                             
241561        MOVE WSC-BOL-COMMODITY-TYPE TO BOL-COMMODITY-TYPE-3516            
241562        MOVE WSC-MKT-TYPE TO MARKETING-TYPE-3516                          
241563        PERFORM 1140500-EXPAND-DOTWEEK THRU 1140500-EXIT          IM991029
241563        MOVE WK-DOT-WWYY TO DOTWEEK-3516                          IM991029
241564        INSPECT DOTWEEK-3516 REPLACING ALL ' ' BY '0'                     
              IF PKMS-FLAG-005 = 'Y'                                    CG030211
                 MOVE WSC-FOUR-CHAR-DOT TO DOTWEEK-3516                 CG030211
              END-IF                                                    CG030211
241565        MOVE WSC-BATCH TO BATCH-KEY-3516                                  
241566        STRING                                                            
241567          WSC-LPC ' ' WSC-QUALITY ' ' WSC-LOCALIZATION ' '                
241568            DELIMITED BY SIZE                                             
241569              INTO NUMERICAL-CODE-BLANC-3516                              
241570        MOVE WSC-QTY-UOM TO ORDER-QTY-UOM-3516                            
241571        IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER                     
241572            MOVE WSC-ORDER-NUMBER TO ORDER-NUMBER-3516                    
241573        ELSE                                                              
241574            MOVE WSC-SDS-ORDER TO ORDER-NUMBER-3516                       
241575        END-IF                                                            
241576        MOVE WSC-ISSUE-UOM TO ISSUE-UNIT-MEASURE-3516                     
241577        MOVE WSC-COO TO COUNTRY-OF-ORIGIN-3516                            
241578        MOVE WSC-PRICE-LIST TO PRICE-LIST-3516                            
241579        MOVE WSC-PRICE-LIST-DATE TO PRICE-DATE-3516                       
              MOVE WSC-ORIGINAL-PSD    TO PLAND-SHIP-DATE-3516          CG070201
              MOVE WSC-AL-FLAG         TO AL-FLAG-3516                  CG070201
              IF PKMS-FLAG-005 = 'Y' AND                                CG070201
                 (WSC-TRW-FLAG = 'N' OR WSC-TRW-FLAG = SPACES)          CG151007
                 MOVE WS-PSD           TO PLAND-SHIP-DATE-3516          CG070201
              END-IF                                                    CG070201
241580        MOVE PRICE-PARM-1 TO PRICE-PARAMETER-3516(1)                      
241581        MOVE PRICE-PARM-2 TO PRICE-PARAMETER-3516(2)                      
241582        MOVE PRICE-PARM-3 TO PRICE-PARAMETER-3516(3)                      
241583        MOVE WSC-PRIORITY TO PRIO-CODE-3516                       000035DB
3LO030                             TMS-PRIORITY                                 
241584        SET WS-PUSH-LOAD-NO           TO TRUE                     CG200506
241584           IF WSC-ORDER-NUMBER(1:3) = 'TOP'                       CG200506
                 AND WSC-LS-ORDER-TYPE = 'A'                            CG240516
241584              SET WS-PUSH-LOAD-YES    TO TRUE                     CG200506
241584              PERFORM 1140010-GET-UNIT-PRICE                      CG200506
241584                 THRU 1140010-EXIT                                CG200506
241584              MOVE WS-FINL-UNIT-PRICE TO UNIT-PRICE-3516          CG200506
241584           ELSE                                                   CG200506
241584              MOVE WSC-UNIT-PRICE TO UNIT-PRICE-3516              CG200506
241584           END-IF                                                 CG200506
241585        IF WSC-CONICITY-IND = '+'                                 000016LJ
241586            MOVE WSC-SHIP-QTY TO QTY-SHIP-W-POS-CONICITY-3516     000016LJ
241587        ELSE                                                      000016LJ
241588          IF WSC-CONICITY-IND = '-'                               000016LJ
241589              MOVE WSC-SHIP-QTY TO QTY-SHIP-W-NEG-CONICITY-3516   000017LD
241590          END-IF                                                  000017LD
241591        END-IF                                                    000017LD
3LO030        IF WSC-TMS-FLAG = 'Y'                                             
3LO030           IF WSC-TMS-REBILL-FLAG = 'Y'                                   
3LO030              MOVE 'R'       TO TRANS-CONS-IND-3516                       
3LO030           ELSE                                                           
3LO030              MOVE 'Y'       TO TRANS-CONS-IND-3516                       
3LO030           END-IF                                                         
3LO030        ELSE                                                              
3LO030           MOVE 'N'          TO TRANS-CONS-IND-3516                       
3LO030        END-IF                                                            
241589        MOVE +0 TO QTY-2XPOS-CONICITY-3516                         030897 
241589        MOVE +0 TO QTY-2XNEG-CONICITY-3516                         030897 
              IF WSC-SHIP-WEIGHT IS NUMERIC                             CG020514
                 MOVE WSC-SHIP-WEIGHT TO ITEM-WGT-LBS-3516              CG020514
              ELSE                                                      CG020514
                 MOVE ZEROES          TO ITEM-WGT-LBS-3516              CG020514
              END-IF                                                    CG020514
241592        STORE SHIPMENT-LINE                                               
241593          ON ANY-ERROR-STATUS                                             
241594             MOVE '030' TO WCR-ERROR-CODE                                 
241595             STRING  ERROR-STATUS                                         
241596               '-STORING SHIPMENT LINE: '                                 
241597                 WSC-NAPN                                                 
241598                  DELIMITED BY SIZE INTO                                  
241599                    WCR-ERROR-TEXT                                        
241600             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
241601                                                                          
241603*        *********************************************                    
241604*        * STORE PART-SERIAL-NUM FOR EVERY SHIPMENT  *                    
241605*        * LINE.                                     *                    
241606*        *********************************************                    
241607                                                                          
241608     IF WSC-SERIAL-NUMBER NOT = SPACES                                    
241609        PERFORM 1148000-STORE-SERIAL-NUM THRU 1148000-EXIT.               
241602                                                                          
241603*        *********************************************                    
241604*        * PERFORM PFO AND SALES ORDER UPDATES THAT  *                    
241605*        * MUST OCCUR FOR EVERY LINE.                *                    
241606*        *********************************************                    
241607                                                                          
241608     IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER                        
              IF (WSC-TRW-FLAG = SPACE) OR                              CG160325
                 (WSC-TRW-FLAG = 'N')                                   CG160325
241609           PERFORM 1142000-PFO-NOTIFICATION THRU 1142000-EXIT     CG160325
              ELSE                                                      CG160325
                 CONTINUE                                               CG160325
              END-IF                                                    CG160325
241610     ELSE                                                                 
241611        PERFORM 1143000-SALES-ORDER-UPD THRU 1143000-EXIT.                
241612                                                                          
                                                                                
3LO030     IF WSC-SHIP-QTY   NOT = 0 OR                                         
3LO030        WSC-CANCEL-QTY NOT = 0                                            
3LO030        IF WSC-TMS-FLAG = 'Y'                                             
3LO030           PERFORM 4000-STORE-SHPCAN-HDR THRU 4000-EXIT                   
3LO030           PERFORM 4500-STORE-SHPCAN-LNE THRU 4500-EXIT                   
3LO030        END-IF                                                            
3LO030     END-IF.                                                              
                                                                                
241614*        *********************************************            CG151007
241615*        * STORE AND LS-INV-TRANS FOR EVERY PART     *            CG151007
241616*        * WHERE QTY WAS ACTUALLY SHIPPED.           *            CG151007
241617*        *********************************************            CG151007
241621*                                                                 CG151007
241614******************************************************************CG151007
241615* STORE LS-INV-TRANS EVEN IF QTY SHIPPED IS ZERO IN CASE OF TRW  *CG151007
241616* SITES. EXISTING LOGIC TO UPDATE LS-INV-TRANS FOR NON-ZERO SHIP-*CG151007
241616* MENT FOR NON-TRW/TRW SITES ARE INTACT.                         *CG151007
241617******************************************************************CG151007
241618                                                                  CG151007
241620     PERFORM 1144000-LOGICAL-STOCK                                CG151007
241620                                 THRU 1144000-EXIT.               CG151007
241621                                                                  CG151007
241622*        *********************************************                    
241623*        * IF A CUSTOMER CONSIGNMENT, THE SHIPMENT   *                    
241624*        * AMOUNT MUST BE CALCULATED AND UPDATED IN  *                    
241625*        * THE APPROPRIATE BILL-TO RECORD.           *                    
241626*        *********************************************                    
241627                                                                          
241628     IF LS-CONSIGNMENT AND WSC-SHIP-QTY NOT = 0                           
241629        PERFORM 1145000-CONSIGNMENT THRU 1145000-EXIT.                    
241630                                                                          
241631*        *********************************************            000030LM
241632*        * IF A CARRIER TRACK ID WAS SENT UP FOR THIS*            000030LM
241633*        * SHIPMENT LINE, STORE THE VALUE IN SHIP-   *            000030LM
241634*        * TRACK-ID RECORD (WILL BE AUTOMATICALLY    *            000030LM
241635*        * CONNECTED TO THE CURRENT AR-INVOICE-HDR). *            000030LM
241636*        *********************************************                    
241637                                                                          
241638     IF WSC-CARR-TRACK-ID NOT = SPACES                            000030LM
241639         IF DOMESTIC-TRANSFER OR LS-CONSIGNMENT OR                000030LM
241640            WSC-INV-NUMBER = SPACES                               000030LM
241641             NEXT SENTENCE                                        000030LM
241642         ELSE                                                     000030LM
241643             PERFORM 1147000-TRACK-ID THRU 1147000-EXIT           000030LM
241644         END-IF                                                   000030LM
241645     END-IF.                                                      000030LM
241646                                                                          
241647 1140000-EXIT. EXIT.                                                      
241648 EJECT                                                                    
                                                                        CG200506
234246****************************************************              CG200506
       1140010-GET-UNIT-PRICE.                                          CG200506
234246****************************************************              CG200506
234246* THE TABLE WITH UNIT PRICE STORED DURING XBRDINFO GETS CALLED    CG200506
234246* TO OBTAIN THE UNIT PRICE FOR THE PARTS AT THE TIME OF           CG200506
234246* CONTAINER EXIT FROM GEODE.                                      CG200506
234246****************************************************              CG200506
              STRING 'BOL' DELIMITED BY SPACES                          CG200506
                     WSC-GOVT-CTRCT-NBR(3:7) DELIMITED BY SPACES        CG200506
                     INTO TABLE-KEY-8016                                CG200506
              END-STRING                                                CG200506
      *                                                                 CG200506
              OBTAIN CALC TABLE-HDR                                     CG200506
              ON DB-REC-NOT-FOUND                                       CG200506
                 MOVE '116' TO WCR-ERROR-CODE                           CG200506
                 STRING 'UNIT-PRICE-TABLE-NOT-FOUND: '                  CG200506
                        WSC-GOVT-CTRCT-NBR(3:7) DELIMITED BY SPACES     CG200506
                        INTO WCR-ERROR-TEXT                             CG200506
                 END-STRING                                             CG200506
                 PERFORM 9999999-ABORT THRU 9999999-EXIT                CG200506
              END-IF                                                    CG200506
      *                                                                 CG200506
              IF DB-STATUS-OK                                           CG200506
                 IF WS-GET-FP-YES                                       CG200506
                    MOVE 'FREIGHT'     TO ENTRY-CODE-8017               CG200506
                 ELSE                                                   CG200506
                   STRING WSC-MSPN DELIMITED BY SPACES                  CG200506
                          WSC-SO-LINE-NBR DELIMITED BY SPACES           CG200506
                          INTO ENTRY-CODE-8017                          CG200506
                   END-STRING                                           CG200506
                 END-IF                                                 CG200506
      *                                                                 CG200506
                 OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                  CG200506
                        USING ENTRY-CODE-8017                           CG200506
                 ON DB-REC-NOT-FOUND                                    CG200506
                    MOVE '120' TO WCR-ERROR-CODE                        CG200506
                    STRING 'TABLE-ENTRY-NOT-FOUND:' DELIMITED BY SPACES CG200506
                           ENTRY-CODE-8017  DELIMITED BY SPACES         CG200506
                           ' NOT-FOUND'  DELIMITED BY SPACES            CG200506
                         INTO  WCR-ERROR-TEXT                           CG200506
                    END-STRING                                          CG200506
                    PERFORM 9999999-ABORT THRU 9999999-EXIT             CG200506
                 END-IF                                                 CG200506
                 IF DB-STATUS-OK                                        CG200506
                    IF WS-GET-FP-YES                                    CG200506
                       MOVE TABLE-DETAIL-DATA-8017(1:13)                CG200506
                                                 TO WS-TEMP-FREIGHT-CHG CG200506
                       IF WS-TEMP-FREIGHT-CHG NUMERIC                   CG200506
                          MOVE WS-TEMP-FREIGHT-CHG(1:11) TO             CG200506
                                             WS-FINL-FREIGHT-CHG(1:11)  CG200506
                          MOVE WS-TEMP-FREIGHT-CHG(12:2) TO             CG200506
                                             WS-FINL-FREIGHT-CHG(12:2)  CG200506
                       ELSE                                             CG200506
                          MOVE ZEROES            TO WS-FINL-FREIGHT-CHG CG200506
                       END-IF                                           CG200506
                    ELSE                                                CG200506
                       MOVE TABLE-DETAIL-DATA-8017(1:11)                CG200506
                                                 TO WS-TEMP-UNIT-PRICE  CG200506
                       IF WS-TEMP-UNIT-PRICE NUMERIC                    CG200506
                          MOVE WS-TEMP-UNIT-PRICE(1:9) TO               CG200506
                                              WS-FINL-UNIT-PRICE(1:9)   CG200506
                          MOVE WS-TEMP-UNIT-PRICE(10:2) TO              CG200506
                                              WS-FINL-UNIT-PRICE(10:2)  CG200506
                       ELSE                                             CG200506
                          MOVE ZEROES             TO WS-FINL-UNIT-PRICE CG200506
                       END-IF                                           CG200506
                    END-IF                                              CG200506
                 END-IF                                                 CG200506
              END-IF.                                                   CG200506
234300                                                                  CG200506
241647 1140010-EXIT. EXIT.                                              CG200506
241648 EJECT                                                            CG200506
                                                                                
       1133300-SUBMIT-JCL.                                              CG031027
234246*        *******************************************              CG031027
234247*        *  GET THE JCL TO SUBMIT TO THE INTERNAL  *              CG031027
234248*        *  READER:                                *              CG031027
234249*        *    'DNWM FILEXTWI'- TO EXECUTE THE PROG *              CG031027
234250*        *                     TO CREATE EXT FILE. *              CG031027
234257*        *******************************************              CG031027
234258     INITIALIZE TEXT-HEADER.                                      CG031027
234261     MOVE 'DNWM' TO TEXT-TYPE-CODE-951                            CG031027
234262     MOVE 'FILEXTWI' TO TEXT-KEY-951                              CG031027
                                                                        CG031027
234282     OBTAIN CALC TEXT-HEADER                                      CG031027
234283       ON ANY-ERROR-STATUS                                        CG031027
234284          MOVE '049' TO WCR-ERROR-CODE                            CG031027
234285          STRING ERROR-STATUS '-OBTAIN TEXT HEADER: '             CG031027
234286             TEXT-KEY-951 DELIMITED BY SIZE INTO                  CG031027
234287                WCR-ERROR-TEXT                                    CG031027
234288          PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG031027
234289                                                                          
234290     IF TEXT-DETAIL NOT EMPTY                                     CG031027
234291        MOVE 'N' TO SW-TEXT-DETAIL                                CG031027
234292        PERFORM 1133400-PROCESS-TEXT THRU 1133400-EXIT            CG031027
234293            UNTIL END-TEXT-DETAIL                                 CG031027
234294     ELSE                                                         CG031027
234295          MOVE '050' TO WCR-ERROR-CODE                            CG031027
234296          STRING 'NO TEXT DETAILS EXIST FOR: '                    CG031027
234297             TEXT-KEY-951 DELIMITED BY SIZE INTO                  CG031027
234298                WCR-ERROR-TEXT                                    CG031027
234299          PERFORM 9999999-ABORT THRU 9999999-EXIT.                CG031027
234300                                                                          
241647 1133300-EXIT. EXIT.                                              CG031027
241648 EJECT                                                            CG031027
       1133400-PROCESS-TEXT.                                            CG031027
234310     OBTAIN NEXT TEXT-LINE WITHIN TEXT-DETAIL                     CG031027
234311       ON DB-END-OF-SET                                           CG031027
234312          MOVE 'Y' TO SW-TEXT-DETAIL                              CG031027
234313          GO TO 1133400-EXIT.                                     CG031027
234314                                                                          
234315     INITIALIZE SAVE-JCL-LINE.                                    CG031027
234316     MOVE TEXT-LINE TO SAVE-JCL-LINE.                             CG031027
234318                                                                          
234319     INSPECT SAVE-JCL-LINE REPLACING ALL                          CG031027
234320       '%%%%%%' BY LOAD-NUMBER-8009.                              CG031027
234326                                                                          
                                                                                
234331     IF CAN-SHIP-FROM                                             CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '@@@@@@@' BY 'CANDATA'                                  CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'CN'.                                      CG031027
234334                                                                          
234335     IF US-SHIP-FROM                                              CG031027
234336        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234337          '@@@@@@@'  BY 'USADATA'                                 CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'WM'.                                      CG031027
234338                                                                          
234335     IF XLA-SHIP-FROM                                             CG031027
234336        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234337          '@@@@@@@'  BY 'XLADATA'                                 CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'XL'.                                      CG031027
234338                                                                          
234342     IF NEW-XBRD-SHIPMENT                                         CG031027
234343       IF SAVE-SHIP-FROM-ONE = SAVE-SHIP-TO-ONE                   CG031027
234343        IF US-BILL-TO                                             CG031027
234351           INSPECT SAVE-JCL-LINE REPLACING ALL                    CG031027
234352             '@@@@@@@'  BY 'USADATA'                              CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'WM'                                       CG031027
234343        END-IF                                                    CG031027
234343                                                                          
234343        IF CAN-BILL-TO                                            CG031027
234351           INSPECT SAVE-JCL-LINE REPLACING ALL                    CG031027
234352             '@@@@@@@'  BY 'CANDATA'                              CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'CN'                                       CG031027
234343        END-IF                                                    CG031027
234343     END-IF                                                       CG031027
234343     END-IF.                                                      CG031027
234343                                                                          
234344     IF CAN-SHIP-TO                                               CG031027
234347        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234348          '@@@@@@@' BY 'CANDATA'                                  CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'CN'.                                      CG031027
234349                                                                          
234350     IF US-SHIP-TO                                                CG031027
234353        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234354          '@@@@@@@' BY 'USADATA'                                  CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'WM'.                                      CG031027
234355                                                                          
234356     IF XLA-SHIP-TO                                               CG031027
234359        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234360          '@@@@@@@' BY 'XLADATA'                                  CG031027
234332        INSPECT SAVE-JCL-LINE REPLACING ALL                       CG031027
234333          '!!'      BY 'XL'.                                      CG031027
234361                                                                          
234362     IF JOB-CARD                                                  CG031027
234363         MOVE ' BEFORE WRITING JCL TO INTRDR' TO                  CG031027
234364             WS-MESSAGE                                           CG031027
234365         WRITE LOG MESSAGE ID 9060030                             CG031027
234366             PARMS FROM WS-PROGRAM-ID LENGTH 9                    CG031027
234370                   FROM WS-LOAD       LENGTH 7                    CG031027
234380                   FROM WS-MESSAGE    LENGTH 30                   CG031027
234390             ON ANY-ERROR-STATUS                                  CG031027
234400                STRING ERROR-STATUS 'ERROR WRITING TO LOG'        CG031027
234500                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT          CG031027
234501                PERFORM 9999999-ABORT THRU 9999999-EXIT.          CG031027
234502                                                                          
234503     WRITE PRINTER FROM SAVE-JCL-LINE                             CG031027
234504        LENGTH 80                                                 CG031027
234505          REPORT ID 1                                             CG031027
234506          CLASS 50                                                CG031027
234507            ON ANY-ERROR-STATUS                                   CG031027
234508               MOVE '051' TO WCR-ERROR-CODE                       CG031027
234509               STRING ERROR-STATUS '-WRITING TO INTERNAL READER'  CG031027
234510                 DELIMITED BY SIZE                                CG031027
234511                   INTO  WCR-ERROR-TEXT                           CG031027
234512               PERFORM 9999999-ABORT THRU 9999999-EXIT.           CG031027
234513                                                                          
234514     IF JOB-CARD                                                  CG031027
234515         MOVE ' AFTER  WRITING JCL TO INTRDR' TO                  CG031027
234516             WS-MESSAGE                                           CG031027
234517         WRITE LOG MESSAGE ID 9060040                             CG031027
234518             PARMS FROM WS-PROGRAM-ID LENGTH 9                    CG031027
234519                   FROM WS-LOAD       LENGTH 7                    CG031027
234520                   FROM WS-MESSAGE    LENGTH 30                   CG031027
234530             ON ANY-ERROR-STATUS                                  CG031027
234540                STRING ERROR-STATUS 'ERROR WRITING TO LOG'        CG031027
234550                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT          CG031027
234551                PERFORM 9999999-ABORT THRU 9999999-EXIT.          CG031027
241647 1133400-EXIT. EXIT.                                              CG031027
241648 EJECT                                                            CG031027
241647 1140500-EXPAND-DOTWEEK.                                          IM991029
           MOVE WSC-DOT           TO WK-DOT.                            IM991029
           MOVE WK-DOT-WEEK       TO WK-DOT-WW.                         IM991029
           MOVE WK-DOT-YEAR       TO WK-DOT-Y.                          IM991029
           MOVE SAVE-DATE-CC      TO WORK-CURR-CC.                      IM991029
           MOVE SAVE-DATE-YY      TO WORK-CURR-YY.                      IM991029
           COMPUTE WORK-LOW-YEAR = WORK-CURR-YEAR - 5.                  IM991029
           COMPUTE WORK-HIGH-YEAR = WORK-LOW-YEAR + 10.                 CG050129
           MOVE WORK-LOW-YEAR(1:3)      TO WORK-BASE-DOT-YEAR(1:3).     CG030211
           MOVE WK-DOT-YEAR             TO WORK-BASE-DOT-YEAR(4:1).     CG030211
                                                                        CG030211
           IF WORK-BASE-DOT-YEAR >= WORK-LOW-YEAR AND                   CG050129
              WORK-BASE-DOT-YEAR <= WORK-HIGH-YEAR                      CG050129
              CONTINUE                                                  CG030211
           ELSE                                                         CG030211
              MOVE WORK-HIGH-YEAR(1:3)  TO WORK-BASE-DOT-YEAR(1:3)      CG050129
              MOVE WK-DOT-YEAR          TO WORK-BASE-DOT-YEAR(4:1)      CG030211
           END-IF.                                                      CG030211
                                                                        CG030211
           MOVE WK-DOT(1:2)             TO WK-DOT-WW.                   CG030211
           MOVE WORK-BASE-DOT-YEAR(3:1) TO WK-DOT-DECADE.               CG030211
           MOVE WK-DOT-YEAR             TO WK-DOT-Y.                    CG030211
                                                                        CG030211
241647 1140500-EXIT. EXIT.                                              IM991029
241648 EJECT                                                                    
241649*        *********************************************                    
241650*        * ONCE THE COMPLETE STRUCTURE FOR AN INVOICE*                    
241651*        * IS ON THE CORE, CALL INVOICING (SABGP380) *                    
241652*        * WITH AN ***** EXTENDED RUN UNIT ****.     *                    
241653*        *                                           *                    
241654*        * ALL RECORDS INVOICING NEEDS HAVE BEEN     *                    
241655*        * BOUND AND AREAS READIED IN THIS PROGRAM.  *                    
241656*        *                                           *                    
241657*        * DOMESTIC TRANSFERS AND CONSIGNMENT SALES  *                    
241658*        * ORDERS DO NOT HAVE AN INVOICE; THEREFORE, *                    
241659*        * SKIP THE CALL TO INVOICING FOR THESE.     *                    
241660*        *                                           *                    
241661*        * EVEN THOUGH CROSS-BORDER TRANSFER ORDERS  *                    
241662*        * HAVE AN AR-INVOICE-HDR STORED, DO NOT CALL*                    
241663*        * INVOICING.  BATCH OE WILL CALL INVOICING  *                    
241664*        * IN A BATCH RUN AT NIGHT AFTER THEY HAVE   *                    
241665*        * BUILT A DEBIT (SALES ORDER) TO WHICH THE  *                    
241666*        * INVOICE MAY BE ASSOCIATED WITH.           *                    
241667*        *********************************************                    
241668*                                                                         
241669                                                                          
241670 1141000-CALL-INVOICING.                                                  
241671                                                                          
241672     IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER OR                     
241673        LS-CONSIGNMENT                                                    
241674          GO TO 1141000-EXIT.                                             
241675                                                                          
           IF LOGMSG                                                    CG221205
              MOVE SPACES               TO WS-MESSAGE-DATA              CG221205
              STRING                                                    CG221205
                     '"PGM":',                                          CG221205
                     '"DNWMX830",',                                     CG221205
                     '"REC-TYPE":',                                     CG221205
                     '"ACTIVITY",',                                     CG221205
                     '"BOL":',                                          CG221205
                     '"',                                               CG221205
                     WSC-BOL,                                           CG221205
                     '",',                                              CG221205
                     '"BOLFLAG":'                                       CG221205
                     '"',                                               CG221205
                     BOL-RAMPUP-FLAG-3555                               CG221205
                     '",',                                              CG221205
                     '"MSG":',                                          CG221205
                     '"PROCESSING INVOICE '                             CG221205
                     WS-SAVE-INVOICE-NBR                                CG221205
                     ' "'                                               CG221205
                 DELIMITED BY SIZE INTO WS-MESSAGE-DATA                 CG221205
              END-STRING                                                CG221205
              PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                   CG221205
           END-IF                                                       CG221205
130605     MOVE 'N'                TO BOL-RAMPUP-FLAG-3555              CG221205
241672     IF INVOICE-TARGET-IS-FOP                                     CG221205
241672     OR SIMULATE-FOP                                              CG221205
130605        FIND CURRENT BILL-OF-LADING                               CG221205
241672        IF INVOICE-TARGET-IS-FOP                                  CG221205
130605           MOVE 'Y'          TO BOL-RAMPUP-FLAG-3555              CG221205
241672        ELSE                                                      CG221205
130605           MOVE 'S'          TO BOL-RAMPUP-FLAG-3555              CG221205
241672        END-IF                                                    CG221205
230605        MODIFY BILL-OF-LADING                                     CG221205
2SP160        IF BATCH-ORDER-IND-3510 NOT = 'K'                         CG221205
126000           PERFORM 1123500-STORE-FOP-TEXT  THRU 1123500-EXIT      CG221205
2SP160        END-IF                                                    CG221205
              IF LOGMSG                                                 CG221205
                 MOVE SPACES            TO WS-MESSAGE-DATA              CG221205
                 STRING                                                 CG221205
                        '"PGM":',                                       CG221205
                        '"DNWMX830",',                                  CG221205
                        '"REC-TYPE":',                                  CG221205
                        '"SOSHIP",',                                    CG221205
                        '"BOL":',                                       CG221205
                        '"',                                            CG221205
                        WSC-BOL,                                        CG221205
                        '",',                                           CG221205
                        '"BOLFLAG":'                                    CG221205
                        '"',                                            CG221205
                        BOL-RAMPUP-FLAG-3555                            CG221205
                        '",',                                           CG221205
                        '"MSG":',                                       CG221205
                        '"BOL MARKED FOR TRANSMISSION"'                 CG221205
                    DELIMITED BY SIZE INTO WS-MESSAGE-DATA              CG221205
                 END-STRING                                             CG221205
                 PERFORM 4600-CALL-LOGGER THRU 4600-EXIT                CG221205
              END-IF                                                    CG221205
241672     END-IF.                                                      CG221205
241672     IF INVOICE-TARGET-IS-FOP                                     CG221205
              IF LOGMSG                                                 CG221205
                   MOVE SPACES          TO WS-MESSAGE-DATA              CG221205
                   STRING                                               CG221205
                          '"PGM":',                                     CG221205
                          '"DNWMX830",',                                CG221205
                          '"REC-TYPE":',                                CG221205
                          '"ACTIVITY",',                                CG221205
                          '"BOL":',                                     CG221205
                          '"',                                          CG221205
                          WSC-BOL,                                      CG221205
                          '",',                                         CG221205
                          '"BOLFLAG":'                                  CG221205
                          '"',                                          CG221205
                          BOL-RAMPUP-FLAG-3555                          CG221205
                          '",',                                         CG221205
                          '"FOPSRC":'                                   CG221205
                          '"Y",',                                       CG221205
                          '"MSG":',                                     CG221205
                          '"STOPPED INVOICE CREATION"'                  CG221205
                      DELIMITED BY SIZE INTO WS-MESSAGE-DATA            CG221205
                   END-STRING                                           CG221205
                   PERFORM 4600-CALL-LOGGER THRU 4600-EXIT              CG221205
                END-IF                                                  CG221205
241674          GO TO 1141000-EXIT                                      CG221205
241672     END-IF.                                                      CG221205
241672                                                                  CG221205
           IF NOT INVOICE-TARGET-IS-FOP                                 CG221205
              IF LOGMSG                                                 CG221205
                   MOVE SPACES          TO WS-MESSAGE-DATA              CG221205
                   STRING                                               CG221205
                          '"PGM":',                                     CG221205
                          '"DNWMX830",',                                CG221205
                          '"REC-TYPE":',                                CG221205
                          '"ACTIVITY",',                                CG221205
                          '"BOL":',                                     CG221205
                          '"',                                          CG221205
                          WSC-BOL,                                      CG221205
                          '",',                                         CG221205
                          '"BOLFLAG":'                                  CG221205
                          '"',                                          CG221205
                          BOL-RAMPUP-FLAG-3555                          CG221205
                          '",',                                         CG221205
                          '"FOPSRC":'                                   CG221205
                          '"N",',                                       CG221205
                          '"MSG":',                                     CG221205
                          '"INVOICE CREATED IN SDS"'                    CG221205
                      DELIMITED BY SIZE INTO WS-MESSAGE-DATA            CG221205
                   END-STRING                                           CG221205
                   PERFORM 4600-CALL-LOGGER THRU 4600-EXIT              CG221205
                END-IF                                                  CG221205
241672     END-IF.                                                      CG221205
241676     MOVE '00' TO STATUS-CODE-W380.                               000032LM
241677     ACCEPT WK3-DB-KEY(2) FROM SHIPMENT-HEADER CURRENCY.                  
241678     ACCEPT WK3-DB-KEY(1) FROM SHIPMENT-HEADER CURRENCY.                  
241679     MOVE RECEIVABLE-ITEM-NUMBER-2712 TO WK3-INVOICE-NUMBER.              
241680     TRANSFER CONTROL TO 'SABGP380' LINK                                  
241681       USING                                                              
241682           SUBSCHEMA-CTRL                                                 
241683           AOBGW380                                               000032LM
241684           ADDRSS                                                         
241685           ADDRSS-ID                                                      
241686           AR-INVOICE-HDR                                                 
241687           BUSINESS                                                       
241688           CAS-DEFINITION                                                 
241689           COE-DEFINITION                                                 
241690           COE-PLT-CONTROL                                                
241691           CUSTOMER                                                       
241692           CUSTOMER-TERMS                                                 
241693           DISC-BY-REMISE                                                 
241694           LOAD                                                           
241695           MESSAGE-DATA                                                   
241696           MESSAGE-TYPE                                                   
241697           MKT-PART                                                       
241698           MKT-PLANT                                                      
241699           NUMBER-MASK                                                    
241700           ORDER-HEADER                                                   
241701           PREFIX-MASK                                                    
241702           SALES-ORDER                                                    
241703           SALES-ORDER-LINE                                               
241704           SHIPMENT-HEADER                                                
241705           SHIPMENT-LINE                                                  
241706           SOHEXT                                                         
241707           SOLEXT                                                 000024LD
241708           SO-LINE-SCHEDULE                                               
241709           STBDNAR                                                000035DB
241710           TEXT-HEADER                                                    
241711           TEXT-LINE                                                      
241712           UOM-FACTOR                                                     
241713           UOM-OOAK                                                       
241714           VALID-UOM                                                      
                 TABLE-HDR                                              CG031217
                 TABLE-DETAIL                                           CG031217
                 MKT-PART-PRICE                                         CG050119
                 MKT-PART-JOINT                                         CG050119
                 MKT-PLANT-PRICE                                        CG050119
                 MKT-PLANT-JOINT                                        CG050119
                 PRICE-TABLE                                            CG050119
                 PRICE-EFFECTIVE                                        CG050119
                 PRICE-FACTOR                                           CG050119
                 PRICE-DEFINITION                                       CG050119
                 PLANT-MASTER                                           CG050119
                 BASE-PRICE-HSTRY                                       CG050119
                 CURRENCY-CONV                                          CG050119
                 CURRENCY-FACTOR                                        CG050119
                 CUSTOMER-OPTION                                        CG050119
241715           COEDUIV0-WORK3-RECORD.                                         
241716                                                                          
241717     IF STATUS-CODE-W380 = '01'                                   000032LM
241718        MOVE '093' TO WCR-ERROR-CODE                              000032LM
241719        STRING 'AVP STATE CODE NOT FOUND '                        000032LM
241720               WSC-SDS-ORDER   DELIMITED BY SIZE                  000032LM
241721            INTO WCR-ERROR-TEXT                                   000032LM
241722        PERFORM 9999999-ABORT THRU 9999999-EXIT.                  000032LM
241723                                                                          
241724     IF STATUS-CODE-W380 = '02'                                   000032LM
241725        MOVE '094' TO WCR-ERROR-CODE                              000032LM
241726        STRING 'NEGATIVE INVOICE AMOUNT '                         000032LM
241727               WSC-SDS-ORDER   DELIMITED BY SIZE                  000032LM
241728            INTO WCR-ERROR-TEXT                                   000032LM
241729        PERFORM 9999999-ABORT THRU 9999999-EXIT.                  000032LM
241730                                                                          
241731 1141000-EXIT. EXIT.                                                      
241732 EJECT                                                                    
241733 1142000-PFO-NOTIFICATION.                                                
241734     MOVE 'PFOSHP' TO OOAK-CALC-KEY-9037.                                 
241735     FIND KEEP EXCLUSIVE CALC PFO-SHIP-OOAK                               
241736         ON ANY-ERROR-STATUS                                              
241737          NEXT SENTENCE.                                                  
241738                                                                          
241739     IF DB-REC-NOT-FOUND                                                  
241740        STORE PFO-SHIP-OOAK                                               
241741          ON ANY-ERROR-STATUS                                             
241742             MOVE '059' TO WCR-ERROR-CODE                                 
241743             STRING ERROR-STATUS '-STORE PFO OOAK RECORD '                
241744               DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                     
241745             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
241746     IF NOT DB-STATUS-OK                                                  
241747        MOVE '060' TO WCR-ERROR-CODE                                      
241748        STRING ERROR-STATUS  '-OBTAIN PFO OOAK RECORD'                    
241749          DELIMITED BY SIZE INTO WCR-ERROR-TEXT                           
241750        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
241751                                                                          
241752     INITIALIZE PFO-SHIP-TRAN.                                            
241753     MOVE WSC-ORDER-NUMBER TO ORDER-NUMBER-9038.                          
241754     MOVE SAVE-SHIP-FROM TO SHIP-PLANT-CODE-9038.                         
241755     MOVE WSC-NAPN TO PART-NUMBER-9038.                                   
241756     MOVE ACTUAL-SHIP-8009 TO ACTUAL-SHIP-9038.                           
241757     MOVE WSC-SHIP-QTY TO QTY-SHIPPED-9038.                               
241758     MOVE WSC-CANCEL-QTY TO CNCL-SHIP-QTY-9038.                           
241759     MOVE WSC-BOL TO BILL-LADING-NUMBER-9038.                             
241760     MOVE WSC-PRIMARY-CARRIER TO SCAC-CODE-9038.                          
241761     MOVE WSC-CONTAINER TO CONTAINER-ID-9038.                             
241762                                                                          
241763     STORE PFO-SHIP-TRAN                                                  
241764       ON ANY-ERROR-STATUS                                                
241765          MOVE '061' TO WCR-ERROR-CODE                                    
241766          STRING ERROR-STATUS '-STORE PFO SHIP TRAN   '                   
241767            DELIMITED BY SIZE INTO  WCR-ERROR-TEXT                        
241768          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
241769                                                                          
241770 1142000-EXIT. EXIT.                                                      
241771 EJECT                                                                    
241772 1143000-SALES-ORDER-UPD.                                                 
241773*        *********************************************                    
241774*        * CONNECT SHIPMENT-LINE UP WITH CORRECT     *                    
241775*        * SALES-ORDER-LINES / SCHEDULES AND UPDATE  *                    
241776*        * THE SCHEDULE(S) ACCORDINGLY WITH SHIP QTY.*                    
241800*        * IF A DOMESTIC-TRANSFER OR CROSS-BORDER-   *                    
241900*        * TRANSFER, DO NOT TRY TO MAKE SALES-ORDER  *                    
242000*        * CONNECTIONS. THESE ORDERS DO NOT          *                    
242100*        * ORIGINATE IN OE BUT RATHER COME FROM PFO. *                    
242200*        *********************************************                    
242300                                                                          
242400*        *********************************************                    
242500*        *  CONNECT SHIPMENT-LINE TO CORRECT         *                    
242600*        *  SALES-ORDER-LINE                         *                    
242700*        *********************************************                    
242800     OBTAIN KEEP EXCLUSIVE SALES-ORDER-LINE WITHIN ORDER-LINES            
242900       USING WSC-SO-LINE-NBR                                              
243000         ON ANY-ERROR-STATUS                                              
243100             MOVE '031' TO WCR-ERROR-CODE                                 
243200             STRING ERROR-STATUS                                          
243300              '-SALES ORDER LINE: ' WSC-SO-LINE-NBR ' '                   
243400                  WSC-SDS-ORDER                                           
243500                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
243600             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
           IF DB-STATUS-OK                                              IM010212
              IF CROSS-BORDER-FLAG-3503 IS ALPHABETIC AND               IM010212
                 CROSS-BORDER-FLAG-3503 NOT EQUAL TO SPACES             IM010212
                 SET NEW-XBRD-SHIPMENT TO TRUE                          IM010212
              END-IF                                                    IM010212
           END-IF                                                       IM010212
243700                                                                          
           PERFORM 1143100-STORE-DIS-CODE THRU 1143100-EXIT.            IM000331
243800                                                                          
243900     IF WSC-SHIP-QTY NOT = 0                                              
244000        CONNECT SHIPMENT-LINE TO LINE-SHIPMENTS                           
244100          ON ANY-ERROR-STATUS                                             
244200             MOVE '032' TO WCR-ERROR-CODE                                 
244300             STRING ERROR-STATUS                                          
244400              '-SALES ORDER LINE: ' WSC-SO-LINE-NBR ' '                   
244500                 ORDER-NUMBER-3510 ' ' WSC-SDS-ORDER                      
244600                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
244700             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
244800                                                                          
244900*        *********************************************                    
245000*        *  OBTAIN FIRST SO-LINE-SCHEDULE BELONGING  *                    
245100*        *  TO SALES-ORDER-LINE WHICH SHOULD BE THE  *                    
245200*        *  '00' SCHEDULE RECORD AND UPDATE THE      *                    
245300*        *  RECORD WITH SHIPMENT DATA.               *                    
245400*        *********************************************                    
245500     OBTAIN KEEP EXCLUSIVE FIRST SO-LINE-SCHEDULE                         
245600       WITHIN LINE-SCHEDULE                                               
245700         ON ANY-ERROR-STATUS                                              
245800            MOVE '033' TO WCR-ERROR-CODE                                  
245900            STRING ERROR-STATUS                                           
246000              '-1ST SO-LINE-SCHED:'                                       
246100                 ORDER-NUMBER-3510 ' ' WSC-SO-LINE-NBR                    
246200                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
246300            PERFORM 9999999-ABORT THRU 9999999-EXIT.                      
246400                                                                          
246500     ADD WSC-SHIP-QTY TO QTY-SHIPPED-3504                                 
246600                          ASN-ACCUM-UPDT-QTY-3504.                        
246700     MOVE 'DNWMX830'            TO ANALYST-3504.                          
246800     MOVE SAVE-DATE             TO DATE-LAST-ACTIVITY-3504.               
246900     MOVE ACTUAL-SHIP-DATE-8009 TO RELEASE-DATE-3504.                     
247000     ADD WSC-CANCEL-QTY         TO CNCL-SHIP-QTY-3504.                    
247100     MODIFY SO-LINE-SCHEDULE                                              
247200         ON ANY-ERROR-STATUS                                              
247300            MOVE '034' TO WCR-ERROR-CODE                                  
247400            STRING ERROR-STATUS                                           
247500              '-1ST SO-LINE-SCHED:'                                       
247600                 ORDER-NUMBER-3510 ' ' WSC-SO-LINE-NBR                    
247700                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
247800            PERFORM 9999999-ABORT THRU 9999999-EXIT.                      
247900                                                                          
248000*        *********************************************                    
248100*        *  OBTAIN SPECIFIC SO-LINE-SCHEDULE THAT    *                    
248200*        *  MATCHES UP WITH SHIPMENT-LINE.  THE      *                    
248300*        *  SCHEDULE NUMBER USED TO FIND THIS RECORD *                    
248400*        *  WAS OBTAINED FROM WMS-ORDER-LINE ON PCV4.*                    
248500*        *  ONCE FOUND, UPDATE WITH SHIPMENT DATA.   *                    
248600*        *                                           *                    
248700*        *  IN ADDITION, THE SHIPMENT-LINE MUST BE   *                    
248800*        *  CONNECTED TO THIS SCHEDULE.              *                    
248900*        *********************************************                    
249000     OBTAIN KEEP EXCLUSIVE SO-LINE-SCHEDULE WITHIN LINE-SCHEDULE          
249100       USING WSC-SO-LINE-SCHED                                            
249200         ON ANY-ERROR-STATUS                                              
249300            MOVE '035' TO WCR-ERROR-CODE                                  
249400            STRING ERROR-STATUS                                           
249500              '-SO-LINE-SCHED:'                                           
249600                 ORDER-NUMBER-3510 ' ' WSC-SO-LINE-NBR                    
249700                 ' ' WSC-SO-LINE-SCHED                                    
249800                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
249900            PERFORM 9999999-ABORT THRU 9999999-EXIT.                      
250000                                                                          
250000     MOVE QTY-SHIPPED-3504 TO WS-QTY-SHIPPED.                     CG031013
246400     PERFORM 1143200-SOLINE-VAS-UPD THRU 1143200-EXIT.            CG031013
250100     ADD WSC-SHIP-QTY TO QTY-SHIPPED-3504                                 
250200                         ASN-ACCUM-UPDT-QTY-3504.                         
250300     MOVE 'DNWMX830' TO ANALYST-3504.                                     
250400     MOVE SAVE-DATE TO DATE-LAST-ACTIVITY-3504.                           
250500     MOVE ACTUAL-SHIP-DATE-8009 TO RELEASE-DATE-3504.                     
250600     ADD WSC-CANCEL-QTY TO CNCL-SHIP-QTY-3504.                            
           MOVE WSC-CANCEL-RESN-CODE  TO CANCEL-REASON-3504.            C03012  
           MOVE WSC-SHIP-FAC-RECV-DATE TO SHIP-FAC-RECV-DATE-3504.      IM001205
           MOVE WSC-SHIP-FAC-RECV-TIME TO SHIP-FAC-RECV-TIME-3504.      IM001205
           MOVE '00'                   TO SHIP-FAC-RECV-TIME-3504(7:2). IM001211
3LO030     IF WSC-TMS-FLAG = 'Y'                                                
3LO030        IF WSC-TMS-REBILL-FLAG = 'Y'                                      
3LO030           MOVE 'R'              TO TRANS-CONS-IND-3504                   
3LO030        END-IF                                                            
3LO030     END-IF.                                                              
                                                                                
           FIND CURRENT SO-LINE-SCHEDULE.                               CG031013
250700     MODIFY SO-LINE-SCHEDULE                                              
250800         ON ANY-ERROR-STATUS                                              
250900            MOVE '036' TO WCR-ERROR-CODE                                  
251000            STRING ERROR-STATUS                                           
251100              '-SO-LINE-SCHED:'                                           
251200                 ORDER-NUMBER-3510 ' ' WSC-SO-LINE-NBR                    
251300                 ' ' WSC-SO-LINE-SCHED                                    
251400                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
251500            PERFORM 9999999-ABORT THRU 9999999-EXIT.                      
251600                                                                          
251700     IF WSC-SHIP-QTY NOT = 0                                              
251800        CONNECT SHIPMENT-LINE TO LINE-SCHED-SHIPS                         
251900            ON ANY-ERROR-STATUS                                           
252000               MOVE '037' TO WCR-ERROR-CODE                               
252100               STRING ERROR-STATUS                                        
252200                 '-SO-LINE-SCHED:'                                        
252300                    ORDER-NUMBER-3510 ' ' WSC-SO-LINE-NBR                 
252400                    ' ' WSC-SO-LINE-SCHED                                 
252500                      DELIMITED BY SIZE INTO WCR-ERROR-TEXT               
252600               PERFORM 9999999-ABORT THRU 9999999-EXIT.                   
252700 1143000-EXIT.                                                            
252800 EJECT                                                                    
       1143200-SOLINE-VAS-UPD.                                          CG031013
           COMPUTE WS-VAS-INDEX = 1.                                    CG031013
           OBTAIN FIRST VAS-LINE-ITEM WITHIN SOLNSCHD-VASLINE           CG031013
           ON DB-END-OF-SET                                             CG031013
            CONTINUE                                                    CG031013
           END-IF.                                                      CG031013
           IF DB-STATUS-OK                                              CG031013
           PERFORM 1143300-VAS-MAIN THRU 1143300-EXIT                   CG031013
           UNTIL WS-VAS-INDEX > 5                                       CG031013
           END-IF.                                                      CG031013
       1143200-EXIT.                                                    CG031013
       EJECT                                                            CG031013
                                                                                
       1143300-VAS-MAIN.                                                CG031013
           IF WS-VAS-INDEX NOT EQUAL 1                                  CG031013
              FIND CURRENT SO-LINE-SCHEDULE                             CG031013
              OBTAIN NEXT VAS-LINE-ITEM WITHIN SOLNSCHD-VASLINE         CG031013
              ON DB-END-OF-SET                                          CG031013
                CONTINUE                                                CG031013
              END-IF                                                    CG031013
           END-IF.                                                      CG031013
           PERFORM 1143400-VAS-PROCESS THRU 1143400-EXIT                CG031013
           UNTIL DB-END-OF-SET.                                         CG031013
           COMPUTE WS-VAS-INDEX = WS-VAS-INDEX + 1.                     CG031013
       1143300-EXIT.                                                    CG031013
       EJECT                                                            CG031013
       1143400-VAS-PROCESS.                                             CG031013
           IF WS-QTY-SHIPPED = 0                                        CG031013
            IF (WSC-VAS-CODE(WS-VAS-INDEX) NOT EQUAL SPACES) AND        CG031013
              (WSC-VAS-FLAG(WS-VAS-INDEX) = 'A' OR                      CG031013
                 WSC-VAS-FLAG(WS-VAS-INDEX) = 'S') AND                  CG031013
             (WSC-VAS-CODE(WS-VAS-INDEX) = VAS-KEY-8571)                CG031013
                 MOVE WSC-VAS-FLAG(WS-VAS-INDEX)                        CG031013
                                           TO VAS-APPLY-IND-8571        CG031013
                 MOVE 'DNWMX830'        TO UPDATE-USER-8571             CG031013
                 MOVE SAVE-DATE-W-CC    TO UPDATE-DATE-CCYYMMDD-8571    CG031013
                 MOVE SAVE-TIME(1:6)    TO UPDATE-TIME-X6-8571          CG031013
                 MODIFY VAS-LINE-ITEM                                   CG031013
                 ON ANY-ERROR-STATUS                                    CG031013
                 MOVE '036' TO WCR-ERROR-CODE                           CG031013
                  STRING ERROR-STATUS                                   CG031013
                    '-VAS-CODE:'                                        CG031013
                     WSC-VAS-CODE(WS-VAS-INDEX) ' ' WSC-SO-LINE-NBR     CG031013
                     ' ' WSC-SO-LINE-SCHED                              CG031013
                         DELIMITED BY SIZE INTO WCR-ERROR-TEXT          CG031013
                  PERFORM 9999999-ABORT THRU 9999999-EXIT               CG031013
                 END-IF                                                 CG031013
            END-IF                                                      CG031013
           ELSE                                                         CG031013
              IF (WSC-VAS-CODE(WS-VAS-INDEX) NOT EQUAL SPACES) AND      CG031013
                 (WSC-VAS-CODE(WS-VAS-INDEX) = VAS-KEY-8571)            CG031013
                 IF VAS-APPLY-IND-8571 = 'A'                            CG031013
                    CONTINUE                                            CG031013
                 ELSE                                                   CG031013
                  MOVE WSC-VAS-FLAG(WS-VAS-INDEX)                       CG031013
                                               TO VAS-APPLY-IND-8571    CG031013
                 MOVE 'DNWMX830'        TO UPDATE-USER-8571             CG031013
                 MOVE SAVE-DATE-W-CC    TO UPDATE-DATE-CCYYMMDD-8571    CG031013
                 MOVE SAVE-TIME(1:6)    TO UPDATE-TIME-X6-8571          CG031013
                   MODIFY VAS-LINE-ITEM                                 CG031013
                   ON ANY-ERROR-STATUS                                  CG031013
                   MOVE '036' TO WCR-ERROR-CODE                         CG031013
                   STRING ERROR-STATUS                                  CG031013
                     '-VAS-CODE:'                                       CG031013
                     WSC-VAS-CODE(WS-VAS-INDEX) ' ' WSC-SO-LINE-NBR     CG031013
                     ' ' WSC-SO-LINE-SCHED                              CG031013
                         DELIMITED BY SIZE INTO WCR-ERROR-TEXT          CG031013
                   PERFORM 9999999-ABORT THRU 9999999-EXIT              CG031013
                   END-IF                                                       
                 END-IF                                                 CG031013
              END-IF                                                    CG031013
           END-IF.                                                      CG031013
                OBTAIN NEXT VAS-LINE-ITEM WITHIN SOLNSCHD-VASLINE       CG031013
                ON DB-END-OF-SET                                        CG031013
                 CONTINUE                                               CG031013
                END-IF.                                                 CG031013
       1143400-EXIT.                                                    CG031013
               EXIT.                                                    CG031013
       1143100-STORE-DIS-CODE.                                                  
                                                                                
      *      ********************************************************   IM000331
      *      *  STORE DISCOUNT CODE INTO DISCOUNT-CODE-3503 IF      *   IM000331
      *      *  'CL92' TEXT HEADER RECORD EXISTS. THIS CODE WILL    *   IM000331
      *      *  BE USED TO CALCULATE THE DISCOUNT AMOUNT IN         *   IM000331
      *      *  INVOICING. DO NOT STORE DISCOUNT CODE IF IT ALREADY *   IM000331
      *      *  EXISTS IN DISCOUNT-CODE-3503                        *   IM000331
      *      ********************************************************   IM000331
                                                                                
           INITIALIZE TEXT-HEADER                                       IM000331
           MOVE 'CL92'        TO TEXT-TYPE-CODE-951                     IM000331
           STRING SHIP-TO-BUSINESS-3510 MARKETING-PART-ID-3503          IM000331
                  DELIMITED BY SIZE INTO TEXT-KEY-951                   IM000331
           FIND CALC TEXT-HEADER                                        IM000331
           ON ANY-ERROR-STATUS                                          IM000331
              CONTINUE                                                  IM000331
           END-IF                                                       IM000331
                                                                                
           IF DB-REC-NOT-FOUND                                          IM000331
              GO TO 1143100-EXIT                                        IM000331
           ELSE                                                         IM000331
              IF NOT DB-STATUS-OK                                       IM000331
                  MOVE '097' TO WCR-ERROR-CODE                          IM000331
                  STRING ERROR-STATUS '- OBTAIN TEXT-HEADER '           IM000331
                  TEXT-CALC-KEY-951                                     IM000331
                  DELIMITED BY SIZE INTO WCR-ERROR-TEXT                 IM000331
                  PERFORM 9999999-ABORT THRU 9999999-EXIT               IM000331
              END-IF                                                    IM000331
           END-IF                                                       IM000331
                                                                                
           OBTAIN FIRST TEXT-LINE WITHIN TEXT-DETAIL                    IM000331
           ON ANY-ERROR-STATUS                                          IM000331
              CONTINUE                                                  IM000331
           END-IF                                                       IM000331
                                                                                
           IF DB-END-OF-SET                                             IM000331
              GO TO 1143100-EXIT                                        IM000331
           ELSE                                                         IM000331
              IF NOT DB-STATUS-OK                                       IM000331
                  MOVE '098' TO WCR-ERROR-CODE                          IM000331
                  STRING ERROR-STATUS '- OBTAIN TEXT-LINE '             IM000331
                  TEXT-CALC-KEY-951                                     IM000331
                  DELIMITED BY SIZE INTO WCR-ERROR-TEXT                 IM000331
                  PERFORM 9999999-ABORT THRU 9999999-EXIT               IM000331
              END-IF                                                    IM000331
           END-IF                                                       IM000331
                                                                                
           MOVE TEXT-DETAIL-LINE-952 TO WS-WORK-CL92-TEXT               IM000331
           MOVE 'N'                  TO WS-DIS-CODE-FND                 IM000331
                                                                                
           PERFORM VARYING WS-SUB FROM 1 BY 1 UNTIL WS-SUB > 3          IM000331
              IF DISCOUNT-CODE-3503 (WS-SUB) = WS-CL92-DIS-CODE         IM000331
                 MOVE 'Y' TO WS-DIS-CODE-FND                            IM000331
              END-IF                                                    IM000331
           END-PERFORM                                                  IM000331
                                                                                
           IF WS-DIS-CODE-FND = 'Y'                                     IM000331
              GO TO 1143100-EXIT                                        IM000331
           END-IF                                                       IM000331
                                                                                
           EVALUATE TRUE                                                IM000331
           WHEN DISCOUNT-CODE-3503 (1) EQUAL SPACES                     IM000331
                MOVE WS-CL92-DIS-CODE  TO DISCOUNT-CODE-3503 (1)        IM000331
           WHEN DISCOUNT-CODE-3503 (2) EQUAL SPACES                     IM000331
                MOVE WS-CL92-DIS-CODE  TO DISCOUNT-CODE-3503 (2)        IM000331
           WHEN DISCOUNT-CODE-3503 (3) EQUAL SPACES                     IM000331
                MOVE WS-CL92-DIS-CODE  TO DISCOUNT-CODE-3503 (3)        IM000331
           END-EVALUATE                                                 IM000331
                                                                                
           MOVE SAVE-DATE     TO DATE-LAST-ACTIVITY-3503                CG030717
           MOVE SAVE-TIME-HMS TO TIME-LAST-ACTIVITY-3503                CG030717
           FIND CURRENT SALES-ORDER-LINE                                        
           MODIFY SALES-ORDER-LINE                                      IM000331
           ON ANY-ERROR-STATUS                                          IM000331
              CONTINUE                                                  IM000331
           END-IF                                                       IM000331
                                                                                
           IF NOT DB-STATUS-OK                                          IM000331
                  MOVE '099' TO WCR-ERROR-CODE                          IM000331
                  STRING ERROR-STATUS '- MODIY SALES-ORDER-LINE '       IM000331
                  WSC-SO-LINE-NBR ' ' WSC-SDS-ORDER                     IM000331
                  DELIMITED BY SIZE INTO WCR-ERROR-TEXT                 IM000331
                  PERFORM 9999999-ABORT THRU 9999999-EXIT               IM000331
           END-IF.                                                      IM000331
                                                                                
       1143100-EXIT.                                                            
       EJECT                                                                    
252900********************************************************                  
253000*  STORE ONE PER WSC-PART-DATA RECORD                  *                  
253100********************************************************                  
253200 1144000-LOGICAL-STOCK.                                                   
           IF WSC-SHIP-QTY = 0 AND                                      CG151007
              WSC-REASON-CODE = SPACES                                  CG151007
              IF WSC-TRW-FLAG = 'Y'                                     CG151007
                 CONTINUE                                               CG151007
              ELSE                                                      CG151007
                 GO TO 1144000-EXIT                                     CG151007
           END-IF.                                                      CG151007
                                                                        CG151007
253300     INITIALIZE LS-INV-TRANS.                                             
253400     MOVE WSC-NAPN TO PART-NUMBER-8376.                                   
           MOVE WSC-REASON-CODE        TO REASON-CDE-8376.              CG151007
           MOVE WSC-TM-CUST-DUE        TO ETA-TIME-HHMM-8376.           CG151007
           MOVE 'N'                    TO WS-BLUESKY-DATA.              CG220715
           MOVE  SPACES                TO WS-BLUESKY-DC.                CG220715
           IF WSC-BATCH                NOT = SPACES                     CG220715
              MOVE SAVE-SHIP-FROM      TO WS-SRC-DC                     CG220715
              MOVE WSC-BATCH(1:3)      TO WS-DEST-DC                    CG220715
              PERFORM 1147200-BLUESKY-DATA                              CG220715
                                        THRU 1147200-EXIT               CG220715
              IF WS-BLUESKY-DATA = 'Y'                                  CG220715
                 MOVE WSC-BATCH        TO SPECIFIC-ID-8376(1)           CG220715
              ELSE                                                      CG220715
                 MOVE WSC-BATCH        TO BATCH-NBR-8376                CG220715
              END-IF                                                    CG220715
           ELSE                                                         CG220715
                 MOVE WSC-BATCH        TO BATCH-NBR-8376                CG220715
           END-IF.                                                      CG220715
253600     MOVE SAVE-SHIP-FROM TO SOURCE-PLANT-CODE-8376.                       
253700     MOVE WSC-SHIP-DATE          TO TRNS-DATE-8376.                       
           MOVE WSC-SHIP-TIME          TO TRANS-TIME-8376.                      
253900     MOVE 'PRINTBOL' TO TRANS-NAME-8376.                                  
254000     MOVE 'DNWMX830' TO UPDATE-USER-8376.                                 
254100     MOVE WSC-SHIP-QTY TO ACTUAL-QTY-8376.                                
254200     MOVE WSC-CUSTOMER TO CUSTOMER-NUMBER-8376.                           
254300     MOVE WSC-ORDER-NUMBER TO ORDER-NUMBER-8376.                          
254400     MOVE WSC-LS-ORDER-TYPE TO ORDER-TYPE-8376.                           
254500     MOVE WSC-PRIMARY-CARRIER TO VESSEL-ID-8376.                          
254600     MOVE WSC-SHIP-MODE TO MODE-OF-SHIPMENT-8376.                         
254700     MOVE WSC-CONTAINER TO CONTAINER-ID-8376.                             
254800     MOVE WSC-BOL TO PLANNED-ENROUTE-ID-8376.                             
255000     MOVE WSC-SHIP-DATE TO SHIPPING-DATE-8376.                            
           IF WSC-TRW-FLAG = 'Y'                                        CG151007
              MOVE WSC-DT-CUST-DUE TO DATE-OF-ETA-8376                  CG151007
              MOVE WSC-TM-CUST-DUE TO ETA-TIME-HHMM-8376                CG151007
           ELSE                                                         CG151007
              MOVE WS-IRD          TO DATE-OF-ETA-8376                  CG070201
              MOVE SPACES          TO ETA-TIME-HHMM-8376                CG151007
           END-IF                                                       CG151007
255100     MOVE WSC-SO-LINE-NBR TO ORDER-LINE-8376.                             
255100     MOVE 'S'             TO MANDATORY-RELIEVE-8376.              CG031027
255200     MOVE WSC-SERIAL-NUMBER TO SERIAL-NUMBER-8376.                        
255300     MOVE LOAD-NUMBER-8009 TO LOAD-NBR-8376.                              
                                                                                
           MOVE WSC-WHSE-SEQ-NBR  TO WHSE-SEQ-NBR-8376 .                CG030211
           IF WSC-END-BAL-POSITIVE                                      CG030211
              MOVE WSC-WHSE-END-BAL TO WHSE-END-BAL-8376                CG030211
           ELSE                                                         CG030211
              MOVE ZEROES          TO WS-WHSE-END-BAL                   CG030211
              COMPUTE WS-WHSE-END-BAL = (WSC-WHSE-END-BAL * -1)         CG030211
              MOVE WS-WHSE-END-BAL TO WHSE-END-BAL-8376                 CG030211
           END-IF                                                       CG030211
255400                                                                          
255500     IF  DOMESTIC-TRANSFER                                        000033DB
255510         IF WSC-GOVT-CTRCT-NBR(1:2) = 'TP'                        CG181030
255510            MOVE WSC-GOVT-CTRCT-NBR(3:7)  TO INVOICE-NUMBER-8376  CG181030
255510         ELSE                                                     CG181030
255510            MOVE SPACES TO INVOICE-NUMBER-8376                    000033DB
255510         END-IF                                                   CG181030
255600     ELSE                                                         000033DB
255700         MOVE WSC-INV-NUMBER TO INVOICE-NUMBER-8376.              000033DB
255701                                                                          
255702*        *****************************                                    
255703*        * PASS RECEIVING FACILITY   *                                    
255704*        * IF A TRANSFER ORDER       *                                    
255800*        * SERVICING DC IF A CONSIGN-*                                    
255900*        * MENT ORDER IN PLANT-CODE. *                                    
256000*        *****************************                                    
256100                                                                          
256200     IF DOMESTIC-TRANSFER OR CROSS-BORDER-TRANSFER                        
256300        MOVE SAVE-SHIP-TO TO PLANT-CODE-8376                              
256400     ELSE                                                                 
256500        IF LS-CONSIGNMENT                                                 
256600           MOVE SAVE-SERVICING-DC  TO PLANT-CODE-8376.                    
256700                                                                          
256800*        **********************************                               
256900*        * ORDER TYPE OF "C" PASSED FROM  *                               
257000*        * WICS IS OVERLAYED WITH A "3" IF*                               
257100*        * AN EXPORT-SALES W/O PAPER WHSE *                               
257200*        * OR "P" IF EXPORT-SALES WITH    *                               
257300*        * PAPER WHSE REQD OR SHIP TO     *                               
257400*        * '1032671'.                                                     
257500*        *                                *                               
257600*        * IF US --> CA CUSTOMER NOT PLANT*                               
257700*        * OR CA --> US CUSTOMER NOT PLANT*                               
257800*        * AN ENROUTE TO A PAPER WAREHOUSE*                               
257900*        * MUST BE CREATED.               *                               
258000*        *                                *                               
258001*        *  IF CUSTOMER IF UG EXPORT,     *                       000021LJ
258002*        *  CUST CLASS = '3016004', ORDER *                       000021LJ
258003*        *  TYPE SHOULD BE 'C' PER LS I.S.*                       000021LJ
258100*        **********************************                               
258200                                                                          
258300     IF EXPORT-SALES                                                      
258502        MOVE '3' TO ORDER-TYPE-8376                                       
258503        IF PAPER-WHSE-REQD                                                
258600           MOVE 'P' TO ORDER-TYPE-8376                                    
258700           MOVE SAVE-SHIP-TO TO PLANT-CODE-8376.                          
258800                                                                          
258900     IF WSC-CUSTOMER = '1032671'                                          
259000        MOVE 'P' TO ORDER-TYPE-8376                                       
259100        MOVE SAVE-SHIP-TO TO PLANT-CODE-8376.                             
259200                                                                          
259300     STORE LS-INV-TRANS                                                   
259400       ON ANY-ERROR-STATUS                                                
259500          MOVE '044' TO WCR-ERROR-CODE                                    
259600          STRING ERROR-STATUS                                             
259700            'STORING LS TRANS: '                                          
259800               ORDER-NUMBER-3510 ' ' WSC-SO-LINE-NBR                      
259900               ' ' WSC-NAPN                                               
260000                 DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    
260100          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
260200 1144000-EXIT. EXIT.                                                      
260300 EJECT                                                                    
260400*****************************************************************         
260500*  > CUSTOMER                                                   *         
260600*    - WHEN A CONSIGNMENT SHIPMENT OCCURS, THE AMOUNT OF EACH   *         
260700*      LINE (UNIT * PRICE) MUST BE ADDED TO THE BILL-TO'S       *         
260800*      CUSTOMER RECORD.                                         *         
260900*****************************************************************         
261000 1145000-CONSIGNMENT.                                                     
261100     MOVE BILL-TO-BUSINESS-3501 TO BUSINESS-NUMBER-5050.                  
261200     OBTAIN CALC BUSINESS                                                 
261300       ON ANY-ERROR-STATUS                                                
261400          MOVE '082' TO WCR-ERROR-CODE                                    
261500          STRING ERROR-STATUS                                             
261600            'BILL TO BUS NOT FOUND:'                                      
261700            BUSINESS-NUMBER-5050                                          
261800                 DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    
261900          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
262000                                                                          
262100     OBTAIN NEXT CUSTOMER WITHIN BUS-ROLE                                 
262200       ON ANY-ERROR-STATUS                                                
262300          MOVE '083' TO WCR-ERROR-CODE                                    
262400          STRING ERROR-STATUS                                             
262500            'BILL TO CUST NOT FOUND:'                                     
262600            BUSINESS-NUMBER-5050                                          
262700                 DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    
262800          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
262900                                                                          
263000     COMPUTE CONSIGNMENT-AMT ROUNDED =                                    
263100       UNIT-PRICE-3516 * QTY-SHIPPED-3516.                                
263200     ADD CONSIGNMENT-AMT TO CONSGMNT-AMT-3501.                            
263300     MODIFY CUSTOMER                                                      
263400       ON ANY-ERROR-STATUS                                                
263500          MOVE '084' TO WCR-ERROR-CODE                                    
263600          STRING ERROR-STATUS                                             
263700            'CONSIGN AMT ERROR: '                                         
263800            CUSTOMER-NUMBER-3501                                          
263900                 DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    
264000          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
264100 1145000-EXIT. EXIT.                                                      
264200 EJECT                                                                    
264300*****************************************************************         
264400*  > BACK OUT SHIPMENT-HEADER AND POSSIBLY INVOICE DUE TO A     *         
264500*    FULLY 0 SHIPPED SHIPMENT-HEADER.                           *         
264600*                                                               *         
264700*        * UNLIKE WMS, WICS SENDS UP SHIPMENT-LINES             *         
264800*        * WITH 0 SHIPPED QTY BECAUSE THEY PIGGYBACK            *         
264900*        * CANCEL QUANTITIES ON THESE LINES FOR OE              *         
265000*        * AND PFO.  OE AND PFO ARE UPDATED BUT THE             *         
265100*        * LINES ARE NOT STORED.  IF AN ENTIRE                  *         
265200*        * SHIPMENT-HEADER IS 0 SHIPPED, THE                    *         
265300*        * FOLLOWING OCCURS:                                    *         
265400*        * 1-SHIPMENT-HEADER PREVIOUSLY STORED MUST             *         
265500*        *   HAVE ITS STATUS SET TO AN 'X' TO SIGNAL            *         
265600*        *   TOTAL 0 SHIPPED.  IT IS MODIFIED INSTEAD           *         
265700*        *   OF ERASED FOR AUDIT PURPOSES.                      *         
265800*        *                                                      *         
265810*        * NOTE: THE FOLLOWING PROCESSING OF THE AR-INVOICE-    *         
265820*        *       HDR IS NOT REQUIRED FOR DOMESTIC TRANSFERS,    *         
265821*        *       WHICH HAVE NO ASSOCIATED AR-INVOICE-HDR.       *         
265830*        *                                                      *         
265900*        * 2-THE SHIPMENT HEADER MUST BE DISCONNECTED           *         
266000*        *   FROM THE INVOICE; OTHERWISE, INVOICING             *         
266100*        *    WILL BLOW UP.                                     *         
266200*        *                                                      *         
266300*        * 3-THE INVOICE MUST BE ERASED IF IT HAS NO            *         
266400*        *   SHIPMENT-HEADER MEMBERS.  THE CHECK FOR            *         
266500*        *   MEMBERS IS NOT NECESSARY FOR SALES ORDER           *         
266600*        *   SHIPMENTS SINCE 1 INVOICE/SHIP HDR;                *         
266700*        *   HOWEVER, IT IS FOR XBRD TRANSFERS SINCE            *         
266800*        *   WICS CAN PASS THE SAME INVOICE ON MULT-            *         
266900*        *   IPLE SHIPMENT HEADERS.  ONE SHIP-HDR               *         
267000*        *   COULD BE QTY SHIPPED AND THE NEXT 0                *         
267100*        *   SHIPPED, AND YOU WOULD GET AN ERROR                *         
267200*        *   TRYING TO ERASE THE INVOICE THAT OWNS              *         
267300*        *   THE SHIPMENT HEADER WITH QTY.                      *         
267400*****************************************************************         
267500 1146000-BACK-OUT-HDR.                                                    
267600     OBTAIN CURRENT SHIPMENT-HEADER.                                      
267700     MOVE 'X' TO SHIPMENT-STATUS-3515.                                    
267800     MODIFY SHIPMENT-HEADER                                               
267900       ON ANY-ERROR-STATUS                                                
268000          MOVE '085' TO WCR-ERROR-CODE                                    
268100          STRING ERROR-STATUS                                             
268200            'CANCEL SHIP HDR:'                                            
268300              WSC-SDS-ORDER                                               
268400                 DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    
268500          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
268600                                                                          
268610     IF NOT INVHDR-SHIP MEMBER                                    000008LD
268620         GO TO 1146000-EXIT.                                      000008LD
268630                                                                          
268700     DISCONNECT SHIPMENT-HEADER FROM INVHDR-SHIP                          
268800       ON ANY-ERROR-STATUS                                                
268900          MOVE '086' TO WCR-ERROR-CODE                                    
269000          STRING ERROR-STATUS                                             
269100            'DISC SHIP HDR FROM INV:'                                     
269200              RECEIVABLE-ITEM-NUMBER-2712                                 
269300                 DELIMITED BY SIZE INTO WCR-ERROR-TEXT                    
269400          PERFORM 9999999-ABORT THRU 9999999-EXIT.                        
269500                                                                          
269600     FIND CURRENT AR-INVOICE-HDR.                                         
269700     IF INVHDR-SHIP NOT EMPTY                                             
269800        GO TO 1146000-EXIT                                                
269900     ELSE                                                                 
270000        ERASE AR-INVOICE-HDR                                              
270100          ON ANY-ERROR-STATUS                                             
270200             MOVE '087' TO WCR-ERROR-CODE                                 
270300             STRING ERROR-STATUS                                          
270400               'ERASE INVOICE:'                                           
270500                 RECEIVABLE-ITEM-NUMBER-2712                              
270600                   DELIMITED BY SIZE INTO WCR-ERROR-TEXT                  
270700             PERFORM 9999999-ABORT THRU 9999999-EXIT.                     
                 STRING 'ALL LN SHIPPED 0 QTY, INV & SHP HDR ROLLBACK: 'CG220405
                        WSC-INV-NUMBER DELIMITED BY SIZE INTO DEBUG-SNAPCG220405
                 SNAP TITLE IS DEBUG-SNAP FROM WSC-DATA-RECORD          CG220405
                                          LENGTH 80.                    CG220405
                                                                                
270800 1146000-EXIT. EXIT.                                                      
270810 EJECT                                                                    
270820***************************************************************** 000030LM
270830*  > STORE CARRIER TRACK ID                                     * 000030LM
270840*    - CARRIER TRACK IDS ARE PASSED FROM WICS ON THE LINE LEVEL.* 000030LM
270850*      THEY ARE STORED ON RECORDS ASSOCIATED WITH THE INVOICE.  * 000030LM
270860*      THE SAME TRACK ID MAY BE ON MORE THAN ONE SHIPMENT-LINE. * 000030LM
270861*      IN THIS CASE, STORE ONLY ONE SHIP-TRACK-ID RECORD FOR THE* 000030LM
270862*      TRACK ID.  THE PURPOSE OF THESE RECORDS IS TO LIST ALL OF* 000030LM
270863*      THE TRACK ID'S FOR A PARTICULAR INVOICE.                 * 000030LM
270870*****************************************************************         
270880 1147000-TRACK-ID.                                                000030LM
270890                                                                  000030LM
270900     MOVE 'N' TO SW-TRACK-ID-FOUND.                               000030LM
270901     MOVE 'N' TO SW-END-INV-TRACK-ID.                             000030LM
270910     OBTAIN FIRST SHIP-TRACK-ID WITHIN INV-TRACK-ID               000030LM
270911       ON ANY-ERROR-STATUS                                        000030LM
270912         NEXT SENTENCE.                                           000030LM
270913     IF DB-END-OF-SET                                             000030LM
270914         MOVE 'Y' TO SW-END-INV-TRACK-ID                          000030LM
270915     ELSE                                                         000030LM
270916         IF NOT DB-STATUS-OK                                      000030LM
270917             MOVE '088' TO WCR-ERROR-CODE                         000030LM
270918             STRING ERROR-STATUS                                  000030LM
270919               'OBT FIR SHIP-TRACK-ID: '                          000030LM
270920                 RECEIVABLE-ITEM-NUMBER-2712                      000030LM
270921                    DELIMITED BY SIZE INTO WCR-ERROR-TEXT         000030LM
270922             PERFORM 9999999-ABORT THRU 9999999-EXIT.             000030LM
270923                                                                          
270924     PERFORM 1147100-READ-INV-TRACK THRU 1147100-EXIT             000030LM
270925         UNTIL END-INV-TRACK-ID OR                                000030LM
270926               TRACK-ID-FOUND.                                    000030LM
270927                                                                  000030LM
270928     IF NOT TRACK-ID-FOUND                                        000030LM
270929         MOVE WSC-CARR-TRACK-ID TO CARR-TRACK-ID-2713             000030LM
270929         MOVE WSC-PICKUP-REC-NBR TO PICKUP-REC-NBR-2713           IM99052M
270930         FIND CURRENT AR-INVOICE-HDR                              000030LM
270931         STORE SHIP-TRACK-ID                                      000030LM
270932           ON ANY-ERROR-STATUS                                    000030LM
270933             MOVE '089' TO WCR-ERROR-CODE                         000030LM
270934             STRING ERROR-STATUS                                  000030LM
270935               'STORE SHIP-TRACK-ID/INVC:'                        000030LM
270936                 RECEIVABLE-ITEM-NUMBER-2712                      000030LM
270937                    DELIMITED BY SIZE INTO WCR-ERROR-TEXT         000030LM
270938             PERFORM 9999999-ABORT THRU 9999999-EXIT.             000030LM
270939                                                                          
270940 1147000-EXIT. EXIT.                                                      
270950 EJECT                                                                    
270960 1147100-READ-INV-TRACK.                                          000030LM
270970                                                                  000030LM
270980     IF CARR-TRACK-ID-2713 = WSC-CARR-TRACK-ID                    000030LM
270990         MOVE 'Y' TO SW-TRACK-ID-FOUND                            000030LM
270991         GO TO 1147100-EXIT.                                      000030LM
270992                                                                  000030LM
270993     OBTAIN NEXT SHIP-TRACK-ID WITHIN INV-TRACK-ID                000030LM
270994       ON ANY-ERROR-STATUS                                        000030LM
270995         NEXT SENTENCE.                                           000030LM
270996     IF DB-END-OF-SET                                             000030LM
270997         MOVE 'Y' TO SW-END-INV-TRACK-ID                          000030LM
270998     ELSE                                                         000030LM
270999         IF NOT DB-STATUS-OK                                      000030LM
271000             MOVE '090' TO WCR-ERROR-CODE                         000030LM
271001             STRING ERROR-STATUS                                  000030LM
271002               'OBT NEX SHIP-TRACK-ID: '                          000030LM
271003                 RECEIVABLE-ITEM-NUMBER-2712                      000030LM
271004                    DELIMITED BY SIZE INTO WCR-ERROR-TEXT         000030LM
271005             PERFORM 9999999-ABORT THRU 9999999-EXIT.             000030LM
271006                                                                          
271023 1147100-EXIT. EXIT.                                                      
271024 EJECT                                                                    
      ***************************************************************   CG220715
      *  CHECK FOR BLUESKY DETAILS AND SITE                         *   CG220715
      **************************************************************    CG220715
       1147200-BLUESKY-DATA.                                            CG220715
                                                                        CG220715
           MOVE 'BLUSKYSITE'           TO TABLE-KEY-8016.               CG220715
           OBTAIN CALC TABLE-HDR                                        CG220715
           ON DB-REC-NOT-FOUND                                          CG220715
              GO TO 1147200-EXIT                                        CG220715
           END-IF.                                                      CG220715
                                                                        CG220715
           MOVE  SPACES                TO ENTRY-CODE-8017               CG220715
           MOVE  WS-BLUESKY-DC         TO ENTRY-CODE-8017               CG220715
                                                                        CG220715
           OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                        CG220715
                                       USING ENTRY-CODE-8017            CG220715
           ON DB-REC-NOT-FOUND                                          CG220715
              GO TO 1147200-EXIT                                        CG220715
           END-IF.                                                      CG220715
                                                                        CG220715
           MOVE  'B'                   TO MANDATORY-RELIEVE-8376.       CG220715
           MOVE  'Y'                   TO WS-BLUESKY-DATA.              CG220715
                                                                        CG220715
       1147200-EXIT.                                                    CG220715
           EXIT.                                                        CG220715
                                                                        CG220715
241601                                                                          
241603*        *********************************************                    
241604*        * STORE PART-SERIAL-NUM FOR EVERY SHIPMENT  *                    
241605*        * LINE.                                     *                    
241606*        *********************************************                    
241607                                                                          
271900 1148000-STORE-SERIAL-NUM.                                                
241607                                                                          
241608        MOVE WSC-SERIAL-NUMBER TO SERIAL-NUMBER-3518.                     
241609        STORE PART-SERIAL-NUM                                             
270932           ON ANY-ERROR-STATUS                                    000030LM
270933             MOVE '030' TO WCR-ERROR-CODE                         000030LM
270934             STRING ERROR-STATUS                                  000030LM
270935               '-STORING PART SERIAL NUM: '                       000030LM
270936                 WSC-SERIAL-NUMBER                                000030LM
270937                    DELIMITED BY SIZE INTO WCR-ERROR-TEXT         000030LM
270938             PERFORM 9999999-ABORT THRU 9999999-EXIT.             000030LM
241602                                                                          
241607                                                                          
271900 1148000-EXIT. EXIT.                                                      
271024 EJECT                                                                    
241607                                                                          
271030******************************************************************        
271100* GENERAL ROUTINE TO PERFORM TABLE LOOKUPS                       *        
271200*   > THIS ROUTINE CAN BE USED TO GET A TABLE HEADER RECORD      *        
271300*     AND A ITS TABLE-DETAIL RECORD USING A SORT KEY.  HOWEVER,  *        
271400*     BY SETTING THE SW-TABLE-DET-LOOKUP SWITCH TO NO BEFORE     *        
271500*     CALLING THIS MODULE, THEN ONLY THE TABLE HEADER WILL BE    *        
271600*     FOUND ALLOWING THE TABLE-DETAIL TO BE FOUND USING OTHER    *        
271700*     METHODS.                                                   *        
271800******************************************************************        
271900 9000000-TBL-HDR-LOOKUP.                                                  
272000     MOVE 'N' TO SW-TABLE-LOOKUP.                                         
272100     OBTAIN CALC TABLE-HDR                                                
272200       ON ANY-ERROR-STATUS                                                
272300          NEXT SENTENCE.                                                  
272400                                                                          
272500*------------------------*                                                
272600     IF ANY-ERROR-STATUS                                                  
272700        MOVE '009' TO WCR-ERROR-CODE                                      
272800        STRING ERROR-STATUS '-TABLE HEADER ERROR: '                       
272900           SAVE-CURRENT-TABLE                                             
273000            DELIMITED BY SIZE INTO                                        
273100             WCR-ERROR-TEXT                                               
273200        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
273300*------------------------*                                                
273400                                                                          
273500     IF HDR-DETAIL EMPTY                                                  
273600        MOVE 'E' TO SW-TABLE-LOOKUP                                       
273700     ELSE                                                                 
273800        IF ERROR-STATUS NOT = '1601'                                      
273900           MOVE '010' TO WCR-ERROR-CODE                                   
274000           STRING ERROR-STATUS '-HDR-DETAIL SET ERROR: '                  
274100              SAVE-CURRENT-TABLE                                          
274200               DELIMITED BY SIZE INTO                                     
274300                WCR-ERROR-TEXT                                            
274400           PERFORM 9999999-ABORT THRU 9999999-EXIT                        
274500        ELSE                                                              
274600           IF GET-TABLE-DETAIL                                            
274700              PERFORM 9000000-TBL-DET-LOOKUP                              
274800                 THRU 9000000-DET-EXIT.                                   
274900 9000000-HDR-EXIT. EXIT.                                                  
275300                                                                          
275400******************************************************************        
275500* GENERAL ROUTINE TO PERFORM TABLE LOOKUPS                       *        
275600*   > THIS IS THE REMAINING MODULE THAT ACCOMPLISHES TABLE       *        
275700*     LOOKUPS BY OBTAINING THE DETAIL RECORD.                    *        
275800*   > THIS CODE IS IN A MODULE BY ITSELF BECAUSE SOMETIMES IT    *        
275900*     IS NECESSARY TO OBTAIN MANY DETAIL RECORDS FOR ONE TABLE   *        
276000*     HEADER RECORD.  FOR EXAMPLE, SEE 24D8110 AND 2440000.      *        
276100******************************************************************        
276200 9000000-TBL-DET-LOOKUP.                                                  
276300     MOVE 'N' TO SW-TABLE-LOOKUP.                                         
276400     OBTAIN TABLE-DETAIL WITHIN HDR-DETAIL                                
276500       USING ENTRY-CODE-8017                                              
276600         ON ANY-ERROR-STATUS                                              
276700            NEXT SENTENCE.                                                
276800                                                                          
276900*------------------------*                                                
277000     IF DB-REC-NOT-FOUND                                                  
277100        MOVE 'N' TO SW-TABLE-LOOKUP                                       
277200        GO TO 9000000-DET-EXIT.                                           
277300     IF NOT DB-STATUS-OK                                                  
277400        MOVE '011' TO WCR-ERROR-CODE                                      
277500        STRING ERROR-STATUS '-TABLE DETAIL LOOKUP: '                      
277600           SAVE-CURRENT-TABLE                                             
277700            DELIMITED BY SIZE INTO                                        
277800             WCR-ERROR-TEXT                                               
277900        PERFORM 9999999-ABORT THRU 9999999-EXIT.                          
278000*------------------------*                                                
278100                                                                          
278200     MOVE 'Y' TO SW-TABLE-LOOKUP.                                         
278300 9000000-DET-EXIT. EXIT.                                                  
278400 EJECT                                                                    
      *******************************************************                   
      **  THIS ROUTINE IS CALLED TO STORE NEW TMS RECORDS. **                   
      **  TMS-SHPCAN-HDR/LINE IS CREATED BY SAORP198 ,     **                   
      **  DNPOP323 & DNWMX830. THESE DETAILS ARE EXTRACTED **                   
      **  TO EDI AND PASSED TO TMSP.                       **                   
      **  TRANSFER-JOB-FLAG-8566 INDICATES IF THE ORDER IS **                   
      **  EXTRACTED BY EDI. RESET THIS FLAG TO 'N' WHEN NEW**                   
      **  ORDER LINES ARE STORED.                          **                   
      *******************************************************                   
3LO030 4000-STORE-SHPCAN-HDR.                                                   
3LO030     INITIALIZE TMS-SHPCAN-HDR WS-LOOP-1205                               
3LO030                               WS-REC-COUNTER.                            
3LO030     MOVE TMS-ORDER-NUMBER        TO ORDER-NUMBER-8566.                   
3LO030     OBTAIN CALC TMS-SHPCAN-HDR                                           
3LO030     ON ANY-ERROR-STATUS                                          IM000331
3LO030        NEXT SENTENCE.                                            IM000331
3LO030                                                                          
3LO030     IF DB-REC-NOT-FOUND                                                  
3LO030        MOVE TMS-ORDER-NUMBER     TO ORDER-NUMBER-8566                    
3LO030        MOVE 'DNWMX830'           TO CREATION-USER-8566                   
3LO030        MOVE 'N'                  TO TRANSFER-JOB-FLAG-8566               
3LO030        MOVE TMS-CUSTOMER         TO SHIP-TO-BUSINESS-8566                
3LO030        MOVE ZEROES               TO EFF-TIME-8566                        
3LO030        MOVE FUNCTION CURRENT-DATE(1:8)                                   
3LO030                                  TO DATE-CREATED-8566                    
3LO030        ACCEPT CREATION-TIME-8566 FROM TIME                               
3LO030        STORE TMS-SHPCAN-HDR                                              
3LO030        PERFORM IDMS-STATUS                                               
3LO030     ELSE                                                                 
3LO030        IF NOT DB-STATUS-OK                                               
3LO030           MOVE '111' TO WCR-ERROR-CODE                                   
3LO030           STRING  ERROR-STATUS                                           
3LO030           '-READING TMS SHPCAN HDR: '                                    
3LO030           TMS-ORDER-NUMBER                                               
3LO030           DELIMITED BY SIZE INTO WCR-ERROR-TEXT                          
3LO030           PERFORM 9999999-ABORT THRU 9999999-EXIT                        
3LO030        ELSE                                                              
3LO030           MOVE 'N'               TO TRANSFER-JOB-FLAG-8566               
3LO030           MOVE EFF-TIME-8566     TO WS-REC-COUNTER                       
3LO030           MODIFY TMS-SHPCAN-HDR                                          
3LO030           PERFORM IDMS-STATUS                                            
3LO030        END-IF                                                            
3LO030     END-IF.                                                              
3LO030 4000-EXIT.                                                               
3LO030     EXIT.                                                                
                                                                                
3LO030 4500-STORE-SHPCAN-LNE.                                                   
3LO030     FIND CURRENT TMS-SHPCAN-HDR                                          
3LO030     ON ANY-ERROR-STATUS                                          IM000331
3LO030        NEXT SENTENCE.                                            IM000331
3LO030                                                                          
3LO030     ADD 1                        TO WS-REC-COUNTER.                      
3LO030     INITIALIZE TMS-SHPCAN-LINE.                                          
3LO030     MOVE TMS-SO-LINE-NBR         TO LINE-NUMBER-8567.                    
3LO030     IF TMS-ORDER-NUMBER(1:1) = 'S'                                       
3LO030        MOVE TMS-SO-LINE-SCHED    TO SCHEDULE-NUMBER-8567                 
3LO030     ELSE                                                                 
3LO030        MOVE '00'                 TO SCHEDULE-NUMBER-8567                 
3LO030     END-IF.                                                              
3LO030     IF TMS-ORDER-NUMBER(1:1) = 'S'                                       
3LO030        MOVE 'SOSHIP  '           TO WS-TRANS-TYPE                        
3LO030        STRING 'S' WS-REC-COUNTER                                         
3LO030        DELIMITED BY SIZE INTO KEY-TRANS-8567                             
3LO030     ELSE                                                                 
3LO030        MOVE 'TOSHIP  '           TO WS-TRANS-TYPE                        
3LO030        STRING 'T' WS-REC-COUNTER                                         
3LO030        DELIMITED BY SIZE INTO KEY-TRANS-8567                             
3LO030     END-IF.                                                              
3LO030     MOVE 'DNWMX830'              TO CREATION-USER-8567.                  
3LO030     MOVE FUNCTION CURRENT-DATE(1:8)                                      
3LO030                                  TO DATE-CREATED-8567                    
3LO030     ACCEPT CREATION-TIME-8567    FROM TIME.                              
3LO030     ACCEPT TRANS-CONS-TCS-TME-8567 FROM TIME.                            
3LO030     MOVE 'N'                     TO TRANSFER-JOB-FLAG-8567.              
3LO030     MOVE TMS-SOURCE-DC           TO SHIP-PLANT-CODE-8567.                
3LO030     STRING WS-TRANS-TYPE                                                 
3LO030            TMS-MBOL                                                      
3LO030            TMS-SCAC                                                      
3LO030            TMS-SHIP-DATE                                                 
3LO030            TMS-EQUIPMENT-TYPE                                            
3LO030            TMS-BOL                                                       
3LO030            TMS-BOL-WEIGHT                                                
3LO030            TMS-MSPN                                                      
3LO030            TMS-NAPN                                                      
3LO030            TMS-SHIP-QTY                                                  
3LO030            TMS-CANCEL-QTY                                                
3LO030            TMS-CANCEL-RESN-CODE                                          
3LO030            TMS-PRIORITY                                                  
3LO030            TMS-FLAG                                                      
3LO030            TMS-REBILL-FLAG                                               
3LO030     DELIMITED BY SIZE INTO TRANSACTION-DETAILS-8567.                     
3LO030     STORE TMS-SHPCAN-LINE                                                
3LO030     ON ANY-ERROR-STATUS                                                  
3LO030        NEXT SENTENCE.                                            IM000331
3LO030                                                                          
3LO030     IF NOT DB-STATUS-OK                                                  
3LO030        IF ERROR-STATUS NOT = '1205'                                      
3LO030           MOVE '112' TO WCR-ERROR-CODE                                   
3LO030           STRING  ERROR-STATUS                                           
3LO030           '-STORING TMS SHPCAN LINE: '                                   
3LO030           TMS-ORDER-NUMBER ', '                                          
3LO030           TMS-SO-LINE-NBR  ', '                                          
3LO030           TMS-SO-LINE-SCHED                                              
3LO030           DELIMITED BY SIZE INTO WCR-ERROR-TEXT                          
3LO030           PERFORM 9999999-ABORT THRU 9999999-EXIT                        
3LO030        ELSE                                                              
3LO030           IF WS-LOOP-1205 < 10                                           
3LO030              ADD 1                  TO WS-LOOP-1205                      
3LO030              INITIALIZE DEBUG-SNAP                                       
3LO030              STRING 'ENCOUNTERED DUPLICATE IN TMS :'                     
3LO030              WS-LOOP-1205 ',' KEY-TRANS-8567                             
3LO030              TMS-ORDER-NUMBER ', ' TMS-SO-LINE-NBR  ', '                 
3LO030              TMS-SO-LINE-SCHED                                           
3LO030              DELIMITED BY SIZE INTO DEBUG-SNAP                           
3LO030              WRITE LOG MESSAGE ID 9050100                                
3LO030              PARMS FROM DEBUG-SNAP LENGTH 90                             
3LO030              GO TO 4500-STORE-SHPCAN-LNE                                 
3LO030           ELSE                                                           
3LO030              MOVE '113' TO WCR-ERROR-CODE                                
3LO030              STRING  ERROR-STATUS                                        
3LO030              '-STORING TMS SHPCAN LINE: '                                
3LO030              TMS-ORDER-NUMBER ', '                                       
3LO030              TMS-SO-LINE-NBR  ', '                                       
3LO030              TMS-SO-LINE-SCHED                                           
3LO030              DELIMITED BY SIZE INTO WCR-ERROR-TEXT                       
3LO030              PERFORM 9999999-ABORT THRU 9999999-EXIT                     
3LO030           END-IF                                                         
3LO030        END-IF                                                            
3LO030     ELSE                                                                 
3LO030        PERFORM 4550-MODIFY-HEADER THRU 4550-EXIT                         
3LO030     END-IF.                                                              
3LO030 4500-EXIT.                                                               
3LO030      EXIT.                                                               
                                                                                
3LO030 4550-MODIFY-HEADER.                                                      
3LO030     OBTAIN CURRENT TMS-SHPCAN-HDR                                        
3LO030     ON ANY-ERROR-STATUS                                          IM000331
3LO030        NEXT SENTENCE.                                            IM000331
3LO030                                                                          
3LO030     MOVE WS-REC-COUNTER    TO EFF-TIME-8566.                             
3LO030     MODIFY TMS-SHPCAN-HDR.                                               
3LO030     PERFORM IDMS-STATUS.                                                 
3LO030 4550-EXIT.                                                               
3LO030      EXIT.                                                               
                                                                                
3LO030 4600-CALL-LOGGER.                                                CG221205
                 TRANSFER 'LOGMSG' RETURN USING WS-MESSAGE-RECORD.      CG221205
                 IF LOGMSG-STATUS                                       CG221205
                    DISPLAY 'DNWMX830 LOG STATUS: ' WS-MESSAGE-STATUS   CG221205
                 END-IF.                                                CG221205
3LO030 4600-EXIT.                                                       CG221205
3LO030      EXIT.                                                       CG221205
278500**************************************************************            
278600*  WHEN AN ABORT OCCURS, THE DATABASE UPDATES ARE ROLLED OUT *            
278700*  AND AN ERROR MESSAGE SENT BACK TO DNWXP261 ALONG WITH THE *            
278800*  FINISH FUNCTION SO THAT THE RUN UNIT CAN BE ENDED.        *            
278900**************************************************************            
279000 9999999-ABORT.                                                           
279100     ROLLBACK.                                                            
279200     MOVE 'WM' TO WCR-GROUP-ID.                                           
279300     MOVE WFV-FINISHED TO WRB-FUNCTION.                                   
279400     TRANSFER 'DNWXP261' RETURN USING WICSTRAN-REQUEST-BLOCK      000028LM
279500                                      WSC-DATA-RECORD.                    
279600     GOBACK.                                                              
279700 9999999-EXIT. EXIT.                                                      
940200 EJECT                                                                    
940300     COPY IDMS WICSTRAN-STATUS.                                           
940400 WICSTRAN-ABORT SECTION.                                                  
940500 WICSTRAN-ABORT-EXIT. EXIT.                                               
940700 EJECT                                                                    
940800     COPY IDMS IDMS-STATUS.                                               
940900 IDMS-ABORT SECTION.                                                      
